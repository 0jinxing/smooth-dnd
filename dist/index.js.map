{"version":3,"file":"index.js","sources":["../src/polyfills.ts","../src/utils.ts","../src/constants.ts","../src/styles.ts","../src/dragscroller.ts","../src/mediator.ts","../src/layoutManager.ts","../src/dropHandlers.ts","../src/container.ts","../index.ts"],"sourcesContent":["declare var global: any;\r\n\r\n(function (constructor) {\r\n  if (constructor && constructor.prototype && !constructor.prototype.matches) {\r\n    constructor.prototype.matches =\r\n      constructor.prototype.matchesSelector ||\r\n      constructor.prototype.mozMatchesSelector ||\r\n      constructor.prototype.msMatchesSelector ||\r\n      constructor.prototype.oMatchesSelector ||\r\n      constructor.prototype.webkitMatchesSelector ||\r\n      function(s: string) {\r\n        var matches = (this.document || this.ownerDocument).querySelectorAll(s),\r\n          i = matches.length;\r\n        while (--i >= 0 && matches.item(i) !== this) {}\r\n        return i > -1;\r\n      };\r\n  }\r\n})(global.Node || global.Element);\r\n\r\n// Overwrites native 'firstElementChild' prototype.\r\n// Adds Document & DocumentFragment support for IE9 & Safari.\r\n// Returns array instead of HTMLCollection.\r\n(function(constructor) {\r\n  if (\r\n    constructor &&\r\n    constructor.prototype &&\r\n    constructor.prototype.firstElementChild == null\r\n  ) {\r\n    Object.defineProperty(constructor.prototype, \"firstElementChild\", {\r\n      get: function() {\r\n        var node,\r\n          nodes = this.childNodes,\r\n          i = 0;\r\n        while ((node = nodes[i++])) {\r\n          if (node.nodeType === 1) {\r\n            return node;\r\n          }\r\n        }\r\n        return null;\r\n      }\r\n    });\r\n  }\r\n})(global.Node || global.Element);\r\n\r\n// Production steps of ECMA-262, Edition 5, 15.4.4.17\r\n// Reference: http://es5.github.io/#x15.4.4.17\r\nif (!Array.prototype.some) {\r\n  Array.prototype.some = function(fun /*, thisArg*/) {\r\n    \"use strict\";\r\n\r\n    if (this == null) {\r\n      throw new TypeError(\"Array.prototype.some called on null or undefined\");\r\n    }\r\n\r\n    if (typeof fun !== \"function\") {\r\n      throw new TypeError();\r\n    }\r\n\r\n    var t = Object(this);\r\n    var len = t.length >>> 0;\r\n\r\n    var thisArg = arguments.length >= 2 ? arguments[1] : void 0;\r\n    for (var i = 0; i < len; i++) {\r\n      if (i in t && fun.call(thisArg, t[i], i, t)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n}\r\n","import { Rect, Axis } from './interfaces';\r\n\r\ndeclare const global: any;\r\n\r\nexport const getIntersection = (rect1: Rect, rect2: Rect) => {\r\n  return {\r\n    left: Math.max(rect1.left, rect2.left),\r\n    top: Math.max(rect1.top, rect2.top),\r\n    right: Math.min(rect1.right, rect2.right),\r\n    bottom: Math.min(rect1.bottom, rect2.bottom),\r\n  };\r\n};\r\n\r\nexport const getIntersectionOnAxis = (rect1: Rect, rect2: Rect, axis: Axis) => {\r\n  if (axis === 'x') {\r\n    return {\r\n      left: Math.max(rect1.left, rect2.left),\r\n      top: rect1.top,\r\n      right: Math.min(rect1.right, rect2.right),\r\n      bottom: rect1.bottom,\r\n    };\r\n  } else {\r\n    return {\r\n      left: rect1.left,\r\n      top: Math.max(rect1.top, rect2.top),\r\n      right: rect1.right,\r\n      bottom: Math.min(rect1.bottom, rect2.bottom),\r\n    };\r\n  }\r\n};\r\n\r\nexport const getContainerRect = (element: HTMLElement): Rect => {\r\n  const _rect = element.getBoundingClientRect();\r\n  const rect = {\r\n    left: _rect.left,\r\n    right: _rect.right + 10,\r\n    top: _rect.top,\r\n    bottom: _rect.bottom,\r\n  };\r\n\r\n  if (hasBiggerChild(element, 'x') && !isScrollingOrHidden(element, 'x')) {\r\n    const width = rect.right - rect.left;\r\n    rect.right = rect.right + element.scrollWidth - width;\r\n  }\r\n\r\n  if (hasBiggerChild(element, 'y') && !isScrollingOrHidden(element, 'y')) {\r\n    const height = rect.bottom - rect.top;\r\n    rect.bottom = rect.bottom + element.scrollHeight - height;\r\n  }\r\n\r\n  return rect;\r\n};\r\n\r\nexport const getScrollingAxis = (element: HTMLElement) => {\r\n  const style = global.getComputedStyle(element);\r\n  const overflow = style['overflow'];\r\n  const general = overflow === 'auto' || overflow === 'scroll';\r\n  if (general) return 'xy';\r\n  const overFlowX = style[`overflow-x`];\r\n  const xScroll = overFlowX === 'auto' || overFlowX === 'scroll';\r\n  const overFlowY = style[`overflow-y`];\r\n  const yScroll = overFlowY === 'auto' || overFlowY === 'scroll';\r\n\r\n  return `${xScroll ? 'x' : ''}${yScroll ? 'y' : ''}` || null;\r\n};\r\n\r\nexport const isScrolling = (element: HTMLElement, axis: Axis) => {\r\n  const style = global.getComputedStyle(element);\r\n  const overflow = style['overflow'];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general = overflow === 'auto' || overflow === 'scroll';\r\n  const dimensionScroll = overFlowAxis === 'auto' || overFlowAxis === 'scroll';\r\n  return general || dimensionScroll;\r\n};\r\n\r\nexport const isScrollingOrHidden = (element: HTMLElement, axis: Axis) => {\r\n  const style = global.getComputedStyle(element);\r\n  const overflow = style['overflow'];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general = overflow === 'auto' || overflow === 'scroll' || overflow === 'hidden';\r\n  const dimensionScroll = overFlowAxis === 'auto' || overFlowAxis === 'scroll' || overFlowAxis === 'hidden';\r\n  return general || dimensionScroll;\r\n};\r\n\r\nexport const hasBiggerChild = (element: HTMLElement, axis: Axis) => {\r\n  if (axis === 'x') {\r\n    return element.scrollWidth > element.clientWidth;\r\n  } else {\r\n    return element.scrollHeight > element.clientHeight;\r\n  }\r\n};\r\n\r\nexport const hasScrollBar = (element: HTMLElement, axis: Axis) => {\r\n  return hasBiggerChild(element, axis) && isScrolling(element, axis);\r\n};\r\n\r\nexport const getVisibleRect = (element: HTMLElement, elementRect: Rect) => {\r\n  let currentElement = element;\r\n  let rect = elementRect || getContainerRect(element);\r\n  currentElement = element.parentElement!;\r\n  while (currentElement) {\r\n    if (hasBiggerChild(currentElement, 'x') && isScrollingOrHidden(currentElement, 'x')) {\r\n      rect = getIntersectionOnAxis(rect, currentElement.getBoundingClientRect(), 'x');\r\n    }\r\n\r\n    if (hasBiggerChild(currentElement, 'y') && isScrollingOrHidden(currentElement, 'y')) {\r\n      rect = getIntersectionOnAxis(rect, currentElement.getBoundingClientRect(), 'y');\r\n    }\r\n\r\n    currentElement = currentElement.parentElement!;\r\n  }\r\n\r\n  return rect;\r\n};\r\n\r\nexport const listenScrollParent = (element: HTMLElement, clb: () => void) => {\r\n  let scrollers: HTMLElement[] = [];\r\n  const dispose = () => {\r\n    scrollers.forEach(p => {\r\n      p.removeEventListener('scroll', clb);\r\n    });\r\n    global.removeEventListener('scroll', clb);\r\n  };\r\n\r\n  setTimeout(function() {\r\n    let currentElement = element;\r\n    while (currentElement) {\r\n      if (isScrolling(currentElement, 'x') || isScrolling(currentElement, 'y')) {\r\n        currentElement.addEventListener('scroll', clb);\r\n        scrollers.push(currentElement);\r\n      }\r\n      currentElement = currentElement.parentElement!;\r\n    }\r\n\r\n    global.addEventListener('scroll', clb);\r\n  }, 10);\r\n\r\n  return {\r\n    dispose,\r\n  };\r\n};\r\n\r\nexport const hasParent = (element: HTMLElement, parent: HTMLElement) => {\r\n  let current: HTMLElement | null = element;\r\n  while (current) {\r\n    if (current === parent) {\r\n      return true;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getParent = (element: Element | null, selector: string) => {\r\n  let current: Element | null = element;\r\n  while (current) {\r\n    if (current.matches(selector)) {\r\n      return current;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport const hasClass = (element: HTMLElement, cls: string) => {\r\n  return (\r\n    element.className\r\n      .split(' ')\r\n      .map(p => p)\r\n      .indexOf(cls) > -1\r\n  );\r\n};\r\n\r\nexport const addClass = (element: Element | null | undefined, cls: string) => {\r\n  if (element) {\r\n    const classes = element.className.split(' ').filter(p => p);\r\n    if (classes.indexOf(cls) === -1) {\r\n      classes.unshift(cls);\r\n      element.className = classes.join(' ');\r\n    }\r\n  }\r\n};\r\n\r\nexport const removeClass = (element: HTMLElement, cls: string) => {\r\n  if (element) {\r\n    const classes = element.className.split(' ').filter(p => p && p !== cls);\r\n    element.className = classes.join(' ');\r\n  }\r\n};\r\n\r\nexport const debounce = (fn: Function, delay: number, immediate: boolean) => {\r\n  let timer: any = null;\r\n  return (...params: any[]) => {\r\n    if (timer) {\r\n      clearTimeout(timer);\r\n    }\r\n    if (immediate && !timer) {\r\n      fn.call(null, ...params);\r\n    } else {\r\n      timer = setTimeout(() => {\r\n        timer = null;\r\n        fn.call(null, ...params);\r\n      }, delay);\r\n    }\r\n  };\r\n};\r\n\r\nexport const removeChildAt = (parent: HTMLElement, index: number) => {\r\n  return parent.removeChild(parent.children[index]);\r\n};\r\n\r\nexport const addChildAt = (parent: HTMLElement, child: HTMLElement, index: number) => {\r\n  if (index >= parent.children.length) {\r\n    parent.appendChild(child);\r\n  } else {\r\n    parent.insertBefore(child, parent.children[index]);\r\n  }\r\n};\r\n\r\nexport const isMobile = () => {\r\n  if (typeof window !== 'undefined') {\r\n    if (\r\n      global.navigator.userAgent.match(/Android/i) ||\r\n      global.navigator.userAgent.match(/webOS/i) ||\r\n      global.navigator.userAgent.match(/iPhone/i) ||\r\n      global.navigator.userAgent.match(/iPad/i) ||\r\n      global.navigator.userAgent.match(/iPod/i) ||\r\n      global.navigator.userAgent.match(/BlackBerry/i) ||\r\n      global.navigator.userAgent.match(/Windows Phone/i)\r\n    ) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const clearSelection = () => {\r\n  if (global.getSelection) {\r\n    if (global.getSelection().empty) {\r\n      // Chrome\r\n      global.getSelection().empty();\r\n    } else if (global.getSelection().removeAllRanges) {\r\n      // Firefox\r\n      global.getSelection().removeAllRanges();\r\n    }\r\n  } else if (global.document.selection) {\r\n    // IE?\r\n    global.document.selection.empty();\r\n  }\r\n};\r\n\r\nexport const getElementCursor = (element: Element | null) => {\r\n  if (element) {\r\n    const style = global.getComputedStyle(element);\r\n    if (style) {\r\n      return style.cursor;\r\n    }\r\n  }\r\n\r\n  return null;\r\n};\r\n","export const containerInstance = 'smooth-dnd-container-instance';\r\nexport const containersInDraggable = 'smooth-dnd-containers-in-draggable';\r\n\r\nexport const defaultGroupName = '@@smooth-dnd-default-group@@';\r\nexport const wrapperClass = 'smooth-dnd-draggable-wrapper';\r\nexport const defaultGrabHandleClass = 'smooth-dnd-default-grap-handle';\r\nexport const animationClass = 'animated';\r\nexport const translationValue = '__smooth_dnd_draggable_translation_value';\r\nexport const visibilityValue = '__smooth_dnd_draggable_visibility_value';\r\nexport const ghostClass = 'smooth-dnd-ghost';\r\n\r\nexport const containerClass = 'smooth-dnd-container';\r\n\r\nexport const extraSizeForInsertion = 'smooth-dnd-extra-size-for-insertion';\r\nexport const stretcherElementClass = 'smooth-dnd-stretcher-element';\r\nexport const stretcherElementInstance = 'smooth-dnd-stretcher-instance';\r\n\r\nexport const isDraggableDetached = 'smoth-dnd-is-draggable-detached';\r\n\r\nexport const disbaleTouchActions = 'smooth-dnd-disable-touch-action';\r\nexport const noUserSelectClass = 'smooth-dnd-no-user-select';\r\n","import * as constants from './constants';\r\nimport { Dictionary } from './interfaces';\r\ndeclare const global: any;\r\n\r\nconst verticalWrapperClass = {\r\n\t'overflow': 'hidden',\r\n\t'display': 'block'\r\n}\r\n\r\nconst horizontalWrapperClass = {\r\n\t'height': '100%',\r\n\t'display': 'inline-block',\r\n\t'vertical-align': 'top',\r\n\t'white-space': 'normal'\r\n}\r\n\r\nconst stretcherElementHorizontalClass = {\r\n\t'display': 'inline-block'\r\n}\r\n\r\nconst css = {\r\n\t[`.${constants.containerClass}`]: {\r\n\t\t'position': 'relative',\r\n\t},\r\n\t[`.${constants.containerClass} *`]: {\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal`]: {\r\n\t\t'white-space': 'nowrap',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal > .${constants.stretcherElementClass}`]: stretcherElementHorizontalClass,\r\n\t[`.${constants.containerClass}.horizontal > .${constants.wrapperClass}`]: horizontalWrapperClass,\r\n\t[`.${constants.containerClass}.vertical > .${constants.wrapperClass}`]: verticalWrapperClass,\r\n\t[`.${constants.wrapperClass}`]: {\r\n\t\t// 'overflow': 'hidden'\r\n\t},\r\n\t[`.${constants.wrapperClass}.horizontal`]: horizontalWrapperClass, \r\n\t[`.${constants.wrapperClass}.vertical`]: verticalWrapperClass, \r\n\t[`.${constants.wrapperClass}.animated`]: {\r\n\t\t'transition': 'transform ease'\r\n\t},\r\n\t[`.${constants.ghostClass} *`]: {\r\n\t\t//'perspective': '800px',\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.ghostClass}.animated`]: {\r\n\t\t'transition': 'all ease-in-out'\r\n\t},\r\n\t[`.${constants.disbaleTouchActions} *`]: {\r\n\t\t'touch-actions': 'none',\r\n\t\t'-ms-touch-actions': 'none'\r\n\t},\r\n\t[`.${constants.noUserSelectClass} *`]: {\r\n\t\t'-webkit-touch-callout': 'none',\r\n\t\t'-webkit-user-select': 'none',\r\n\t\t'-khtml-user-select': 'none',\r\n\t\t'-moz-user-select': 'none',\r\n\t\t'-ms-user-select': 'none',\r\n\t\t'user-select': 'none'\r\n\t}\r\n};\r\n\r\nfunction convertToCssString(css: Dictionary): string {\r\n\treturn Object.keys(css).reduce((styleString, propName) => {\r\n\t\tconst propValue = css[propName];\r\n\t\tif (typeof (propValue) === 'object') {\r\n\t\t\treturn `${styleString}${propName}{${convertToCssString(propValue)}}`;\r\n\t\t}\r\n\t\treturn `${styleString}${propName}:${propValue};`;\r\n\t}, '');\r\n}\r\n\r\nfunction addStyleToHead() {\r\n\tif (typeof (window) !== 'undefined') {\r\n\t\tconst head = global.document.head || global.document.getElementsByTagName(\"head\")[0];\r\n\t\tconst style = global.document.createElement(\"style\");\r\n\t\tconst cssString = convertToCssString(css);\r\n\t\tstyle.type = 'text/css';\r\n\t\tif (style.styleSheet) {\r\n\t\t\tstyle.styleSheet.cssText = cssString;\r\n\t\t} else {\r\n\t\t\tstyle.appendChild(global.document.createTextNode(cssString));\r\n\t\t}\r\n\r\n\t\thead.appendChild(style);\r\n\t}\r\n}\r\n\r\nfunction addCursorStyleToBody(cursor: string) {\r\n\tif (cursor && typeof (window) !== 'undefined') {\r\n\t\tconst head = global.document.head || global.document.getElementsByTagName(\"head\")[0];\r\n\t\tconst style = global.document.createElement(\"style\");\r\n\t\tconst cssString = convertToCssString({\r\n\t\t\t'body *': {\r\n\t\t\t\tcursor: `${cursor} !important`\r\n\t\t\t}\r\n\t\t});\r\n\t\tstyle.type = 'text/css';\r\n\t\tif (style.styleSheet) {\r\n\t\t\tstyle.styleSheet.cssText = cssString;\r\n\t\t} else {\r\n\t\t\tstyle.appendChild(global.document.createTextNode(cssString));\r\n\t\t}\r\n\r\n\t\thead.appendChild(style);\r\n\r\n\t\treturn style;\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\nfunction removeStyle(styleElement: HTMLStyleElement) {\r\n\tif (styleElement && typeof (window) !== 'undefined') {\r\n\t\tconst head = global.document.head || global.document.getElementsByTagName(\"head\")[0];\r\n\t\thead.removeChild(styleElement);\r\n\t}\r\n}\r\n\r\nexport {\r\n\taddStyleToHead,\r\n\taddCursorStyleToBody,\r\n\tremoveStyle\r\n};","import { getScrollingAxis, getVisibleRect } from './utils';\r\nimport { Axis, ScrolableInfo, Position, IContainer, DraggableInfo } from './interfaces';\r\n\r\nconst maxSpeed = 1500; // px/s\r\nconst minSpeed = 20; // px/s\r\n\r\nfunction addScrollValue(element: HTMLElement | Window, axis: Axis, value: number) {\r\n\tif (element) {\r\n\t\tif (element !== window) {\r\n\t\t\tif (axis === 'x') {\r\n\t\t\t\t(element as HTMLElement).scrollLeft += value;\r\n\t\t\t} else {\r\n\t\t\t\t(element as HTMLElement).scrollTop += value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (axis === 'x') {\r\n\t\t\t\telement.scrollBy(value, 0);\r\n\t\t\t} else {\r\n\t\t\t\telement.scrollBy(0, value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst createAnimator = (element: HTMLElement, axis: Axis = 'y') => {\r\n\tlet isAnimating = false;\r\n\tlet request: number | null = null;\r\n\tlet startTime: number | null = null;\r\n\tlet direction: 'begin' | 'end' | null = null;\r\n\tlet speed: number | null = null;\r\n\r\n\tfunction animate(_direction: 'begin' | 'end', _speed: number) {\r\n    direction = _direction;\r\n    speed = _speed;\r\n    isAnimating = true;\r\n    if (isAnimating) {\r\n      start();\r\n    }\r\n  }\r\n\r\n\tfunction start() {\r\n\t\tif (request === null) {\r\n\t\t\trequest = requestAnimationFrame((timestamp) => {\r\n\t\t\t\tif (startTime === null) { startTime = timestamp; }\r\n\t\t\t\tconst timeDiff = timestamp - startTime;\r\n\t\t\t\tstartTime = timestamp;\r\n\t\t\t\tlet distanceDiff = (timeDiff / 1000) * speed!;\r\n\t\t\t\tdistanceDiff = direction === 'begin' ? (0 - distanceDiff) : distanceDiff;\r\n\t\t\t\taddScrollValue(element, axis, distanceDiff);\r\n\t\t\t\trequest = null;\r\n\t\t\t\tstart();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction stop() {\r\n\t\tif (isAnimating) {\r\n\t\t\tcancelAnimationFrame(request!);\r\n\t\t\tisAnimating = false;\r\n\t\t\tstartTime = null;\r\n\t\t\trequest = null;\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tanimate,\r\n\t\tstop\r\n\t};\r\n}\r\n\r\nfunction getAutoScrollInfo(position: Position, scrollableInfo: ScrolableInfo): {\r\n\tdirection: 'begin' | 'end',\r\n\tspeedFactor: number;\r\n} | null {\r\n\tconst { left, right, top, bottom } = scrollableInfo.rect;\r\n\tconst { x, y } = position;\r\n\tif (x < left || x > right || y < top || y > bottom) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tlet begin;\r\n\tlet end;\r\n\tlet pos;\r\n\tif (scrollableInfo.axis === 'x') {\r\n\t\tbegin = left;\r\n\t\tend = right;\r\n\t\tpos = x;\r\n\t} else {\r\n\t\tbegin = top;\r\n\t\tend = bottom;\r\n\t\tpos = y;\r\n\t}\r\n\r\n\tconst moveDistance = 100;\r\n\tif (end - pos < moveDistance) {\r\n\t\treturn {\r\n\t\t\tdirection: 'end',\r\n\t\t\tspeedFactor: (moveDistance - (end - pos)) / moveDistance\r\n\t\t};\r\n\t} else if (pos - begin < moveDistance) {\r\n\t\t// console.log(pos - begin);\r\n\t\treturn {\r\n\t\t\tdirection: 'begin',\r\n\t\t\tspeedFactor: (moveDistance - (pos - begin)) / moveDistance\r\n\t\t};\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\nfunction scrollableInfo(element: HTMLElement): ScrolableInfo {\r\n  var result: ScrolableInfo = {\r\n    element,\r\n    rect: getVisibleRect(element, element.getBoundingClientRect()),\r\n    descendants: [],\r\n    invalidate,\r\n    axis: 'y',\r\n    dispose,\r\n  };\r\n\r\n  function dispose() {\r\n    element.removeEventListener('scroll', invalidate);\r\n  }\r\n\r\n  function invalidate() {\r\n    result.rect = getVisibleRect(element, element.getBoundingClientRect());\r\n    result.descendants.forEach(p => p.invalidate());\r\n  }\r\n\r\n  element.addEventListener('scroll', invalidate);\r\n\r\n  return result;\r\n}\r\n\r\nfunction getScrollableElements(containerElements: HTMLElement[]) {\r\n\tconst scrollables: ScrolableInfo[] = [];\r\n\tlet firstDescendentScrollable = null;\r\n\tcontainerElements.forEach(el => {\r\n\t\tlet current: HTMLElement | null = el;\r\n\t\tfirstDescendentScrollable = null;\r\n\t\twhile (current) {\r\n\t\t\tconst scrollingAxis = getScrollingAxis(current);\r\n\t\t\tif (scrollingAxis) {\r\n\t\t\t\tif (!scrollables.some(p => p.element === current)) {\r\n\t\t\t\t\tconst info = scrollableInfo(current);\r\n\t\t\t\t\tif (firstDescendentScrollable) {\r\n\t\t\t\t\t\tinfo.descendants.push(firstDescendentScrollable);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfirstDescendentScrollable = info;\r\n\t\t\t\t\tif (scrollingAxis === 'xy') {\r\n\t\t\t\t\t\tscrollables.push(Object.assign({}, info, { axis: 'x' }));\r\n\t\t\t\t\t\tscrollables.push(Object.assign({}, info, { axis: 'y' }, { descendants: [] }));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tscrollables.push(Object.assign({}, info, { axis: scrollingAxis }));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcurrent = current.parentElement;\r\n\t\t}\r\n\t});\r\n\treturn scrollables;\r\n}\r\n\r\nfunction getScrollableAnimator(scrollableInfo: ScrolableInfo) {\r\n\treturn Object.assign(scrollableInfo, createAnimator(scrollableInfo.element, scrollableInfo.axis));\r\n}\r\n\r\nfunction getWindowAnimators() {\r\n\tfunction getWindowRect() {\r\n\t\treturn {\r\n\t\t\tleft: 0, right: global.innerWidth, top: 0, bottom: global.innerHeight\r\n\t\t}\r\n\t}\r\n\r\n\treturn [\r\n\t\tObject.assign({ rect: getWindowRect(), axis: 'y' }, createAnimator(global)),\r\n\t\tObject.assign({ rect: getWindowRect(), axis: 'x' }, createAnimator(global, 'x'))\r\n\t]\r\n}\r\n\r\nexport default (containers: IContainer[]) => {\r\n\tconst scrollablesInfo = getScrollableElements(containers.map(p => p.element));\r\n\tconst animators = [...scrollablesInfo.map(getScrollableAnimator), ...getWindowAnimators()];\r\n\treturn ({ draggableInfo, reset }: { draggableInfo?: DraggableInfo; reset?: boolean}) => {\r\n\t\tif (animators.length) {\r\n\t\t\tif (reset) {\r\n\t\t\t\tanimators.forEach(p => p.stop());\r\n\t\t\t\tscrollablesInfo.forEach(p => p.dispose());\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tanimators.forEach(animator => {\r\n\t\t\t\tconst scrollParams = getAutoScrollInfo(draggableInfo!.mousePosition, animator as any as ScrolableInfo);\r\n\t\t\t\tif (scrollParams) {\r\n\t\t\t\t\tanimator.animate(scrollParams.direction, scrollParams.speedFactor * maxSpeed);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tanimator.stop();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}","import './polyfills';\r\nimport * as Utils from './utils';\r\nimport * as constants from './constants';\r\nimport { addStyleToHead, addCursorStyleToBody, removeStyle } from './styles';\r\nimport dragScroller from './dragscroller';\r\nimport { DraggableInfo, IContainer, ElementX, Position, GhostInfo, TopLeft, ContainerOptions, MousePosition, Axis } from './interfaces';\r\n\r\nconst grabEvents = ['mousedown', 'touchstart'];\r\nconst moveEvents = ['mousemove', 'touchmove'];\r\nconst releaseEvents = ['mouseup', 'touchend'];\r\n\r\nlet dragListeningContainers: IContainer[] = null!;\r\nlet grabbedElement: ElementX | null = null;\r\nlet ghostInfo: GhostInfo = null!;\r\nlet draggableInfo: DraggableInfo = null!;\r\nlet containers: IContainer[] = [];\r\nlet isDragging = false;\r\n\r\nlet handleDrag: (info: DraggableInfo) => void = null!;\r\nlet handleScroll: (props: { draggableInfo?: DraggableInfo; reset?: boolean }) => void = null!;\r\nlet sourceContainer = null;\r\nlet sourceContainerLockAxis: Axis | null = null;\r\nlet cursorStyleElement: HTMLStyleElement | null = null;\r\n\r\n// Utils.addClass(document.body, 'clearfix');\r\n\r\nconst isMobile = Utils.isMobile();\r\n\r\nfunction listenEvents() {\r\n  if (typeof window !== 'undefined') {\r\n    addGrabListeners();\r\n  }\r\n}\r\n\r\nfunction addGrabListeners() {\r\n  grabEvents.forEach(e => {\r\n    global.document.addEventListener(e, onMouseDown, { passive: false });\r\n  });\r\n}\r\n\r\nfunction addMoveListeners() {\r\n  moveEvents.forEach(e => {\r\n    global.document.addEventListener(e, onMouseMove, { passive: false });\r\n  });\r\n}\r\n\r\nfunction removeMoveListeners() {\r\n  moveEvents.forEach(e => {\r\n    global.document.removeEventListener(e, onMouseMove, { passive: false });\r\n  });\r\n}\r\n\r\nfunction addReleaseListeners() {\r\n  releaseEvents.forEach(e => {\r\n    global.document.addEventListener(e, onMouseUp, { passive: false });\r\n  });\r\n}\r\n\r\nfunction removeReleaseListeners() {\r\n  releaseEvents.forEach(e => {\r\n    global.document.removeEventListener(e, onMouseUp, { passive: false });\r\n  });\r\n}\r\n\r\nfunction getGhostParent() {\r\n  if (draggableInfo && draggableInfo.ghostParent) {\r\n    return draggableInfo.ghostParent;\r\n  }\r\n\r\n  if (grabbedElement) {\r\n    return grabbedElement.parentElement || global.document.body;\r\n  } else {\r\n    return global.document.body;\r\n  }\r\n}\r\n\r\nfunction getGhostElement(wrapperElement: HTMLElement, { x, y }: Position, container: IContainer, cursor: string): GhostInfo {\r\n  // const { scaleX = 1, scaleY = 1 } = container.getScale();\r\n  const { left, top, right, bottom } = wrapperElement.getBoundingClientRect();\r\n  const midX = left + (right - left) / 2;\r\n  const midY = top + (bottom - top) / 2;\r\n  const ghost: HTMLElement = wrapperElement.cloneNode(true) as HTMLElement;\r\n  ghost.style.zIndex = '1000';\r\n  ghost.style.boxSizing = 'border-box';\r\n  ghost.style.position = 'fixed';\r\n  ghost.style.left = left + 'px';\r\n  ghost.style.top = top + 'px';\r\n  ghost.style.width = right - left + 'px';\r\n  ghost.style.height = bottom - top + 'px';\r\n  ghost.style.overflow = 'visible';\r\n  ghost.style.transition = null!;\r\n  ghost.style.removeProperty('transition');\r\n  ghost.style.pointerEvents = 'none';\r\n\r\n  if (container.getOptions().dragClass) {\r\n    setTimeout(() => {\r\n      Utils.addClass(ghost.firstElementChild as HTMLElement, container.getOptions().dragClass!);\r\n      const dragCursor = global.getComputedStyle(ghost.firstElementChild).cursor;\r\n      cursorStyleElement = addCursorStyleToBody(dragCursor);\r\n    });\r\n  } else {\r\n    cursorStyleElement = addCursorStyleToBody(cursor);\r\n  }\r\n  Utils.addClass(ghost, container.getOptions().orientation || 'vertical');\r\n  Utils.addClass(ghost, constants.ghostClass);\r\n\r\n  return {\r\n    ghost: ghost,\r\n    centerDelta: { x: midX - x, y: midY - y },\r\n    positionDelta: { left: left - x, top: top - y },\r\n  };\r\n}\r\n\r\nfunction getDraggableInfo(draggableElement: HTMLElement): DraggableInfo {\r\n  const container = containers.filter(p => draggableElement.parentElement === p.element)[0];\r\n  const draggableIndex = container.draggables.indexOf(draggableElement);\r\n  const getGhostParent = container.getOptions().getGhostParent;\r\n  return {\r\n    container,\r\n    element: draggableElement,\r\n    elementIndex: draggableIndex,\r\n    payload: container.getOptions().getChildPayload ? container.getOptions().getChildPayload!(draggableIndex) : undefined,\r\n    targetElement: null,\r\n    position: { x: 0, y: 0 },\r\n    groupName: container.getOptions().groupName,\r\n    ghostParent: getGhostParent ? getGhostParent() : null,\r\n    invalidateShadow: null,\r\n    mousePosition: null!,\r\n  };\r\n}\r\n\r\nfunction handleDropAnimation(callback: Function) {\r\n  function endDrop() {\r\n    Utils.removeClass(ghostInfo.ghost, 'animated');\r\n    ghostInfo!.ghost.style.transitionDuration = null!;\r\n    getGhostParent().removeChild(ghostInfo.ghost);\r\n    callback();\r\n  }\r\n\r\n  function animateGhostToPosition({ top, left }: TopLeft, duration: number, dropClass: string | undefined) {\r\n    Utils.addClass(ghostInfo.ghost, 'animated');\r\n    if (dropClass) {\r\n      Utils.addClass(ghostInfo.ghost.firstElementChild, dropClass);\r\n    }\r\n    ghostInfo.ghost.style.transitionDuration = duration + 'ms';\r\n    ghostInfo.ghost.style.left = left + 'px';\r\n    ghostInfo.ghost.style.top = top + 'px';\r\n    setTimeout(function() {\r\n      endDrop();\r\n    }, duration + 20);\r\n  }\r\n\r\n  function shouldAnimateDrop(options: ContainerOptions) {\r\n    return options.shouldAnimateDrop\r\n      ? options.shouldAnimateDrop(draggableInfo.container.getOptions(), draggableInfo.payload)\r\n      : true;\r\n  }\r\n\r\n  if (draggableInfo.targetElement) {\r\n    const container = containers.filter(p => p.element === draggableInfo.targetElement)[0];\r\n    if (shouldAnimateDrop(container.getOptions())) {\r\n      const dragResult = container.getDragResult()!;\r\n      animateGhostToPosition(\r\n        dragResult.shadowBeginEnd.rect!,\r\n        Math.max(150, container.getOptions().animationDuration! / 2),\r\n        container.getOptions().dropClass\r\n      );\r\n    } else {\r\n      endDrop();\r\n    }\r\n  } else {\r\n    const container = containers.filter(p => p === draggableInfo.container)[0];\r\n    const { behaviour, removeOnDropOut } = container.getOptions();\r\n    if (behaviour === 'move' && !removeOnDropOut && container.getDragResult()) {\r\n      const { removedIndex, elementSize } = container.getDragResult()!;\r\n      const layout = container.layout;\r\n      // drag ghost to back\r\n      container.getTranslateCalculator({\r\n        dragResult: {\r\n          removedIndex,\r\n          addedIndex: removedIndex,\r\n          elementSize,\r\n          pos: undefined!,\r\n          shadowBeginEnd: undefined!,\r\n        },\r\n      });\r\n      const prevDraggableEnd =\r\n        removedIndex! > 0\r\n          ? layout.getBeginEnd(container.draggables[removedIndex! - 1]).end\r\n          : layout.getBeginEndOfContainer().begin;\r\n      animateGhostToPosition(\r\n        layout.getTopLeftOfElementBegin(prevDraggableEnd),\r\n        container.getOptions().animationDuration!,\r\n        container.getOptions().dropClass\r\n      );\r\n    } else {\r\n      Utils.addClass(ghostInfo.ghost, 'animated');\r\n      ghostInfo.ghost.style.transitionDuration = container.getOptions().animationDuration + 'ms';\r\n      ghostInfo.ghost.style.opacity = '0';\r\n      ghostInfo.ghost.style.transform = 'scale(0.90)';\r\n      setTimeout(function() {\r\n        endDrop();\r\n      }, container.getOptions().animationDuration);\r\n    }\r\n  }\r\n}\r\n\r\nconst handleDragStartConditions = (function handleDragStartConditions() {\r\n  let startEvent: { clientX: number; clientY: number };\r\n  let delay: number;\r\n  let clb: Function;\r\n  let timer: any = null!;\r\n  const moveThreshold = 1;\r\n  const maxMoveInDelay = 5;\r\n\r\n  function onMove(event: MouseEvent & TouchEvent) {\r\n    const { clientX: currentX, clientY: currentY } = getPointerEvent(event);\r\n    if (!delay) {\r\n      if (Math.abs(startEvent.clientX - currentX) > moveThreshold || Math.abs(startEvent.clientY - currentY) > moveThreshold) {\r\n        return callCallback();\r\n      }\r\n    } else {\r\n      if (Math.abs(startEvent.clientX - currentX) > maxMoveInDelay || Math.abs(startEvent.clientY - currentY) > maxMoveInDelay) {\r\n        deregisterEvent();\r\n      }\r\n    }\r\n  }\r\n\r\n  function onUp() {\r\n    deregisterEvent();\r\n  }\r\n  function onHTMLDrag() {\r\n    deregisterEvent();\r\n  }\r\n\r\n  function registerEvents() {\r\n    if (delay) {\r\n      timer = setTimeout(callCallback, delay);\r\n    }\r\n\r\n    moveEvents.forEach(e => global.document.addEventListener(e, onMove), {\r\n      passive: false,\r\n    });\r\n    releaseEvents.forEach(e => global.document.addEventListener(e, onUp), {\r\n      passive: false,\r\n    });\r\n    global.document.addEventListener('drag', onHTMLDrag, {\r\n      passive: false,\r\n    });\r\n  }\r\n\r\n  function deregisterEvent() {\r\n    clearTimeout(timer);\r\n    moveEvents.forEach(e => global.document.removeEventListener(e, onMove), {\r\n      passive: false,\r\n    });\r\n    releaseEvents.forEach(e => global.document.removeEventListener(e, onUp), {\r\n      passive: false,\r\n    });\r\n    global.document.removeEventListener('drag', onHTMLDrag, {\r\n      passive: false,\r\n    });\r\n  }\r\n\r\n  function callCallback() {\r\n    clearTimeout(timer);\r\n    deregisterEvent();\r\n    clb();\r\n  }\r\n\r\n  return function(_startEvent: MouseEvent & TouchEvent, _delay: number, _clb: Function) {\r\n    startEvent = getPointerEvent(_startEvent);\r\n    delay = typeof _delay === 'number' ? _delay : isMobile ? 200 : 0;\r\n    clb = _clb;\r\n\r\n    registerEvents();\r\n  };\r\n})();\r\n\r\nfunction onMouseDown(event: MouseEvent & TouchEvent) {\r\n  const e = getPointerEvent(event);\r\n  if (!isDragging && (e.button === undefined || e.button === 0)) {\r\n    grabbedElement = Utils.getParent(e.target as Element, '.' + constants.wrapperClass) as ElementX;\r\n    if (grabbedElement) {\r\n      const containerElement = Utils.getParent(grabbedElement, '.' + constants.containerClass);\r\n      const container = containers.filter(p => p.element === containerElement)[0];\r\n      const dragHandleSelector = container.getOptions().dragHandleSelector;\r\n      const nonDragAreaSelector = container.getOptions().nonDragAreaSelector;\r\n\r\n      let startDrag = true;\r\n      if (dragHandleSelector && !Utils.getParent(e.target as Element, dragHandleSelector)) {\r\n        startDrag = false;\r\n      }\r\n\r\n      if (nonDragAreaSelector && Utils.getParent(e.target as Element, nonDragAreaSelector)) {\r\n        startDrag = false;\r\n      }\r\n\r\n      if (startDrag) {\r\n        handleDragStartConditions(e, container.getOptions().dragBeginDelay!, () => {\r\n          Utils.clearSelection();\r\n          initiateDrag(e, Utils.getElementCursor(event.target as Element));\r\n          addMoveListeners();\r\n          addReleaseListeners();\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction onMouseUp() {\r\n  removeMoveListeners();\r\n  removeReleaseListeners();\r\n  handleScroll({ reset: true });\r\n  if (cursorStyleElement) {\r\n    removeStyle(cursorStyleElement);\r\n    cursorStyleElement = null;\r\n  }\r\n  if (draggableInfo) {\r\n    handleDropAnimation(() => {\r\n      Utils.removeClass(global.document.body, constants.disbaleTouchActions);\r\n      Utils.removeClass(global.document.body, constants.noUserSelectClass);\r\n      fireOnDragStartEnd(false);\r\n      (dragListeningContainers || []).forEach(p => {\r\n        p.handleDrop(draggableInfo);\r\n      });\r\n\r\n      dragListeningContainers = null!;\r\n      grabbedElement = null;\r\n      ghostInfo = null!;\r\n      draggableInfo = null!;\r\n      isDragging = false;\r\n      sourceContainer = null;\r\n      sourceContainerLockAxis = null;\r\n      handleDrag = null!;\r\n    });\r\n  }\r\n}\r\n\r\nfunction getPointerEvent(e: TouchEvent & MouseEvent): MouseEvent & TouchEvent {\r\n  return e.touches ? e.touches[0] : e as any;\r\n}\r\n\r\nfunction dragHandler(dragListeningContainers: IContainer[]) {\r\n  let targetContainers = dragListeningContainers;\r\n  return function(draggableInfo: DraggableInfo) {\r\n    let containerBoxChanged = false;\r\n    targetContainers.forEach((p: IContainer) => {\r\n      const dragResult = p.handleDrag(draggableInfo)!;\r\n      containerBoxChanged = !!dragResult.containerBoxChanged || false;\r\n      dragResult.containerBoxChanged = false;\r\n    });\r\n    handleScroll({ draggableInfo });\r\n\r\n    if (containerBoxChanged) {\r\n      containerBoxChanged = false;\r\n      setTimeout(() => {\r\n        containers.forEach(p => {\r\n          p.layout.invalidateRects();\r\n          p.onTranslated();\r\n        });\r\n      }, 10);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getScrollHandler(container: IContainer, dragListeningContainers: IContainer[]) {\r\n  if (container.getOptions().autoScrollEnabled) {\r\n    return dragScroller(dragListeningContainers);\r\n  } else {\r\n    return (props: { draggableInfo?: DraggableInfo; reset?: boolean }) => null;\r\n  }\r\n}\r\n\r\nfunction fireOnDragStartEnd(isStart: boolean) {\r\n  containers.forEach(p => {\r\n    const fn = isStart ? p.getOptions().onDragStart : p.getOptions().onDragEnd;\r\n    if (fn) {\r\n      const options: any = {\r\n        isSource: p === draggableInfo.container,\r\n        payload: draggableInfo.payload,\r\n      };\r\n      if (p.isDragRelevant(draggableInfo.container, draggableInfo.payload)) {\r\n        options.willAcceptDrop = true;\r\n      } else {\r\n        options.willAcceptDrop = false;\r\n      }\r\n      fn(options);\r\n    }\r\n  });\r\n}\r\n\r\nfunction initiateDrag(position: MousePosition, cursor: string) {\r\n  if (grabbedElement !== null) {\r\n    isDragging = true;\r\n    const container = (containers.filter(p => grabbedElement!.parentElement === p.element)[0]) as IContainer;\r\n    container.setDraggables();\r\n    sourceContainer = container;\r\n    sourceContainerLockAxis = container.getOptions().lockAxis ? container.getOptions().lockAxis!.toLowerCase() as Axis : null;\r\n\r\n    draggableInfo = getDraggableInfo(grabbedElement);\r\n    ghostInfo = getGhostElement(\r\n      grabbedElement,\r\n      { x: position.clientX, y: position.clientY },\r\n      draggableInfo.container,\r\n      cursor\r\n    );\r\n    draggableInfo.position = {\r\n      x: position.clientX + ghostInfo.centerDelta.x,\r\n      y: position.clientY + ghostInfo.centerDelta.y,\r\n    };\r\n    draggableInfo.mousePosition = {\r\n      x: position.clientX,\r\n      y: position.clientY,\r\n    };\r\n\r\n    Utils.addClass(global.document.body, constants.disbaleTouchActions);\r\n    Utils.addClass(global.document.body, constants.noUserSelectClass);\r\n\r\n    dragListeningContainers = containers.filter(p => p.isDragRelevant(container, draggableInfo.payload));\r\n    handleDrag = dragHandler(dragListeningContainers);\r\n    if (handleScroll) {\r\n      handleScroll({ reset: true, draggableInfo: undefined! });\r\n    }\r\n    handleScroll = getScrollHandler(container, dragListeningContainers);\r\n    dragListeningContainers.forEach(p => p.prepareDrag(p, dragListeningContainers));\r\n    fireOnDragStartEnd(true);\r\n    handleDrag(draggableInfo);\r\n    getGhostParent().appendChild(ghostInfo.ghost);\r\n  }\r\n}\r\n\r\nfunction onMouseMove(event: MouseEvent & TouchEvent) {\r\n  event.preventDefault();\r\n  const e = getPointerEvent(event);\r\n  if (!draggableInfo) {\r\n    initiateDrag(e, Utils.getElementCursor(event.target as Element));\r\n  } else {\r\n    // just update ghost position && draggableInfo position\r\n    if (sourceContainerLockAxis) {\r\n      if (sourceContainerLockAxis === 'y') {\r\n        ghostInfo.ghost.style.top = `${e.clientY + ghostInfo.positionDelta.top}px`;\r\n        draggableInfo.position.y = e.clientY + ghostInfo.centerDelta.y;\r\n        draggableInfo.mousePosition.y = e.clientY;\r\n      } else if (sourceContainerLockAxis === 'x') {\r\n        ghostInfo.ghost.style.left = `${e.clientX + ghostInfo.positionDelta.left}px`;\r\n        draggableInfo.position.x = e.clientX + ghostInfo.centerDelta.x;\r\n        draggableInfo.mousePosition.x = e.clientX;\r\n      }\r\n    } else {\r\n      ghostInfo.ghost.style.left = `${e.clientX + ghostInfo.positionDelta.left}px`;\r\n      ghostInfo.ghost.style.top = `${e.clientY + ghostInfo.positionDelta.top}px`;\r\n      draggableInfo.position.x = e.clientX + ghostInfo.centerDelta.x;\r\n      draggableInfo.position.y = e.clientY + ghostInfo.centerDelta.y;\r\n      draggableInfo.mousePosition.x = e.clientX;\r\n      draggableInfo.mousePosition.y = e.clientY;\r\n    }\r\n\r\n    handleDrag(draggableInfo);\r\n  }\r\n}\r\n\r\nfunction Mediator() {\r\n  listenEvents();\r\n  return {\r\n    register: function(container: IContainer) {\r\n      containers.push(container);\r\n    },\r\n    unregister: function(container: IContainer) {\r\n      containers.splice(containers.indexOf(container), 1);\r\n    },\r\n  };\r\n}\r\n\r\naddStyleToHead();\r\n\r\nexport default Mediator();\r\n","import * as Utils from './utils';\r\nimport { translationValue, visibilityValue, extraSizeForInsertion, containersInDraggable } from './constants';\r\nimport { Orientation, ElementX, Rect, Dictionary, Position, IContainer } from './interfaces';\r\n\r\nexport interface PropMap {\r\n\t[key: string]: any;\r\n}\r\n\r\nconst horizontalMap: PropMap = {\r\n\tsize: 'offsetWidth',\r\n\tdistanceToParent: 'offsetLeft',\r\n\ttranslate: 'transform',\r\n\tbegin: 'left',\r\n\tend: 'right',\r\n\tdragPosition: 'x',\r\n\tscrollSize: 'scrollWidth',\r\n\toffsetSize: 'offsetWidth',\r\n\tscrollValue: 'scrollLeft',\r\n\tscale: 'scaleX',\r\n\tsetSize: 'width',\r\n\tsetters: {\r\n\t\t'translate': (val: number) => `translate3d(${val}px, 0, 0)`\r\n\t}\r\n};\r\n\r\nconst verticalMap: PropMap = {\r\n\tsize: 'offsetHeight',\r\n\tdistanceToParent: 'offsetTop',\r\n\ttranslate: 'transform',\r\n\tbegin: 'top',\r\n\tend: 'bottom',\r\n\tdragPosition: 'y',\r\n\tscrollSize: 'scrollHeight',\r\n\toffsetSize: 'offsetHeight',\r\n\tscrollValue: 'scrollTop',\r\n\tscale: 'scaleY',\r\n\tsetSize: 'height',\r\n\tsetters: {\r\n\t\t'translate': (val: string) => `translate3d(0,${val}px, 0)`\r\n\t}\r\n};\r\n\r\nfunction orientationDependentProps(map: PropMap) {\r\n\tfunction get(obj: Dictionary, prop:string) {\r\n\t\tconst mappedProp = map[prop];\r\n\t\treturn obj[mappedProp || prop];\r\n\t}\r\n\r\n\tfunction set(obj: Dictionary, prop: string, value: any) {\r\n        requestAnimationFrame(() => {\r\n            obj[map[prop]] = map.setters[prop] ? map.setters[prop](value) : value;\r\n        });\r\n    }\r\n\r\n\treturn { get, set };\r\n}\r\n\r\n\r\n\r\nexport default function layoutManager(containerElement: ElementX, orientation: Orientation, _animationDuration: number) {\r\n\tcontainerElement[extraSizeForInsertion] = 0;\r\n\tconst animationDuration = _animationDuration;\r\n\tconst map = orientation === 'horizontal' ? horizontalMap : verticalMap;\r\n\tconst propMapper = orientationDependentProps(map);\r\n\tconst values: Dictionary = {\r\n\t\ttranslation: 0\r\n\t};\r\n\tlet registeredScrollListener: Function | null = null;\r\n\r\n\tglobal.addEventListener('resize', function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\t// invalidateContainerScale(containerElement);\r\n\t});\r\n\r\n\tsetTimeout(() => {\r\n\t\tinvalidate();\r\n\t}, 10);\r\n\t// invalidate();\r\n\r\n\tconst scrollListener = Utils.listenScrollParent(containerElement, function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tregisteredScrollListener && registeredScrollListener();\r\n\t});\r\n\tfunction invalidate() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tinvalidateContainerScale(containerElement);\r\n\t}\r\n\r\n\tlet visibleRect: Rect;\r\n\tfunction invalidateContainerRectangles(containerElement: ElementX) {\r\n\t\tvalues.rect = Utils.getContainerRect(containerElement);\r\n\t\tvalues.visibleRect = Utils.getVisibleRect(containerElement, values.rect);\r\n\t}\r\n\r\n\tfunction invalidateContainerScale(containerElement: ElementX) {\r\n\t\tconst rect = containerElement.getBoundingClientRect();\r\n\t\tvalues.scaleX = containerElement.offsetWidth ? ((rect.right - rect.left) / containerElement.offsetWidth) : 1;\r\n\t\tvalues.scaleY = containerElement.offsetHeight ? ((rect.bottom - rect.top) / containerElement.offsetHeight) : 1;\r\n\t}\r\n\r\n\tfunction getContainerRectangles() {\r\n\t\treturn {\r\n\t\t\trect: values.rect,\r\n\t\t\tvisibleRect: values.visibleRect\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfDOMRect(rect: Rect) {\r\n\t\treturn {\r\n\t\t\tbegin: propMapper.get(rect, 'begin'),\r\n\t\t\tend: propMapper.get(rect, 'end')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainer() {\r\n\t\tconst begin = propMapper.get(values.rect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.rect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainerVisibleRect() {\r\n\t\tconst begin = propMapper.get(values.visibleRect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.visibleRect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getContainerScale() {\r\n\t\treturn { scaleX: values.scaleX, scaleY: values.scaleY };\r\n\t}\r\n\r\n\tfunction getSize(element: HTMLElement) {\r\n\t\treturn propMapper.get(element, 'size') * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getDistanceToOffsetParent(element: ElementX) {\r\n\t\tconst distance = propMapper.get(element, 'distanceToParent') + (element[translationValue] || 0);\r\n\t\treturn distance * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getBeginEnd(element: HTMLElement) {\r\n\t\tconst begin = getDistanceToOffsetParent(element) + (propMapper.get(values.rect, 'begin') + values.translation) - propMapper.get(containerElement, 'scrollValue');\r\n\t\treturn {\r\n\t\t\tbegin,\r\n\t\t\tend: begin + getSize(element) * propMapper.get(values, 'scale')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction setSize(element: HTMLElement | CSSStyleDeclaration, size: string) {\r\n\t\tpropMapper.set(element, 'setSize', size);\r\n\t}\r\n\r\n\tfunction getAxisValue(position: Position) {\r\n\t\treturn propMapper.get(position, 'dragPosition');\r\n\t}\r\n\r\n\tfunction updateDescendantContainerRects(container: IContainer) {\r\n\t\tcontainer.layout.invalidateRects();\r\n\t\tcontainer.onTranslated();\r\n\t\tif (container.getChildContainers()) {\r\n\t\t\tcontainer.getChildContainers().forEach(p => updateDescendantContainerRects(p));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setTranslation(element: ElementX, translation: number) {\r\n\t\tif (!translation) {\r\n\t\t\telement.style.removeProperty('transform');\r\n\t\t} else {\r\n\t\t\tpropMapper.set(element.style, 'translate', translation);\r\n\t\t}\r\n\t\telement[translationValue] = translation;\r\n\r\n\t\tif (element[containersInDraggable]) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\telement[containersInDraggable].forEach((p: IContainer) => {\r\n\t\t\t\t\tupdateDescendantContainerRects(p);\r\n\t\t\t\t});\r\n\t\t\t}, animationDuration + 20);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getTranslation(element: ElementX) {\r\n\t\treturn element[translationValue];\r\n\t}\r\n\r\n\tfunction setVisibility(element: ElementX, isVisible: boolean) {\r\n\t\tif (element[visibilityValue] === undefined || element[visibilityValue] !== isVisible) {\r\n\t\t\tif (isVisible) {\r\n\t\t\t\telement.style.removeProperty('visibility');\r\n\t\t\t} else {\r\n\t\t\t\telement.style.visibility = 'hidden';\r\n\t\t\t}\r\n\t\t\telement[visibilityValue] = isVisible;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isVisible(element: ElementX) {\r\n\t\treturn element[visibilityValue] === undefined || element[visibilityValue];\r\n\t}\r\n\r\n\tfunction isInVisibleRect(x: number, y: number) {\r\n\t\tlet { left, top, right, bottom } = values.visibleRect;\r\n\r\n\t\t// if there is no wrapper in rect size will be 0 and wont accept any drop\r\n\t\t// so make sure at least there is 30px difference\r\n\t\tif (bottom - top < 2) {\r\n\t\t\tbottom = top + 30;\r\n\t\t}\r\n\t\tconst containerRect = values.rect;\r\n\t\tif (orientation === 'vertical') {\r\n\t\t\treturn x > containerRect.left && x < containerRect.right && y > top && y < bottom;\r\n\t\t} else {\r\n\t\t\treturn x > left && x < right && y > containerRect.top && y < containerRect.bottom;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setScrollListener(callback: Function) {\r\n\t\tregisteredScrollListener = callback;\r\n\t}\r\n\r\n\tfunction getTopLeftOfElementBegin(begin: number) {\r\n\t\tlet top = 0;\r\n\t\tlet left = 0;\r\n\t\tif (orientation === 'horizontal') {\r\n\t\t\tleft = begin;\r\n\t\t\ttop = values.rect.top;\r\n\t\t} else {\r\n\t\t\tleft = values.rect.left;\r\n\t\t\ttop = begin;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttop, left\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getScrollSize(element: HTMLElement) {\r\n\t\treturn propMapper.get(element, 'scrollSize');\r\n\t}\r\n\r\n\tfunction getScrollValue(element: HTMLElement) {\r\n\t\treturn propMapper.get(element, 'scrollValue');\r\n\t}\r\n\r\n\tfunction setScrollValue(element:HTMLElement, val: number) {\r\n\t\treturn propMapper.set(element, 'scrollValue', val);\r\n\t}\r\n\r\n\tfunction dispose() {\r\n\t\tif (scrollListener) {\r\n\t\t\tscrollListener.dispose();\r\n\t\t}\r\n\r\n\t\t// if (visibleRect) {\r\n\t\t// \tvisibleRect.parentNode.removeChild(visibleRect);\r\n\t\t// \tvisibleRect = null;\r\n\t\t// }\r\n\t}\r\n\r\n\tfunction getPosition(position: Position) {\r\n\t\treturn isInVisibleRect(position.x, position.y) ? getAxisValue(position) : null;\r\n\t}\r\n\r\n\tfunction invalidateRects() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetSize,\r\n\t\t//getDistanceToContainerBegining,\r\n\t\tgetContainerRectangles,\r\n\t\tgetBeginEndOfDOMRect,\r\n\t\tgetBeginEndOfContainer,\r\n\t\tgetBeginEndOfContainerVisibleRect,\r\n\t\tgetBeginEnd,\r\n\t\tgetAxisValue,\r\n\t\tsetTranslation,\r\n\t\tgetTranslation,\r\n\t\tsetVisibility,\r\n\t\tisVisible,\r\n\t\tisInVisibleRect,\r\n\t\tdispose,\r\n\t\tgetContainerScale,\r\n\t\tsetScrollListener,\r\n\t\tsetSize,\r\n\t\tgetTopLeftOfElementBegin,\r\n\t\tgetScrollSize,\r\n\t\tgetScrollValue,\r\n\t\tsetScrollValue,\r\n\t\tinvalidate,\r\n\t\tinvalidateRects,\r\n\t\tgetPosition,\r\n\t};\r\n}","import { addChildAt, removeChildAt } from './utils';\r\nimport {\r\n\twrapperClass,\r\n\tcontainersInDraggable\r\n} from './constants';\r\nimport { ContainerProps, DropResult, DropCallback } from './interfaces';\r\n\r\n\r\nexport function domDropHandler({ element, draggables }: ContainerProps) {\r\n\treturn (dropResult: DropResult, onDrop: DropCallback) => {\r\n\t\tconst { removedIndex, addedIndex, droppedElement } = dropResult as any;\r\n\t\tlet removedWrapper = null;\r\n\t\tif (removedIndex !== null) {\r\n\t\t\tremovedWrapper = removeChildAt(element, removedIndex);\r\n\t\t\tdraggables.splice(removedIndex, 1);\r\n\t\t}\r\n\r\n\t\tif (addedIndex !== null) {\r\n\t\t\tconst wrapper = global.document.createElement('div');\r\n\t\t\twrapper.className = `${wrapperClass}`;\r\n\t\t\twrapper.appendChild(removedWrapper && removedWrapper.firstElementChild ? removedWrapper.firstElementChild : droppedElement);\r\n\t\t\twrapper[containersInDraggable] = [];\r\n\t\t\taddChildAt(element, wrapper, addedIndex);\r\n\t\t\tif (addedIndex >= draggables.length) {\r\n\t\t\t\tdraggables.push(wrapper);\r\n\t\t\t} else {\r\n\t\t\t\tdraggables.splice(addedIndex, 0, wrapper);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (onDrop) {\r\n\t\t\tonDrop(dropResult);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function reactDropHandler() {\r\n\tconst handler = () => {\r\n\t\treturn (dropResult: DropResult, onDrop: DropCallback) => {\r\n\t\t\tif (onDrop) {\r\n\t\t\t\tonDrop(dropResult);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\treturn {\r\n\t\thandler\r\n\t};\r\n}\r\n","import Mediator from './mediator';\r\nimport layoutManager from './layoutManager';\r\nimport { hasClass, addClass, removeClass, getParent } from './utils';\r\nimport { domDropHandler } from './dropHandlers';\r\nimport {\r\n  wrapperClass,\r\n  animationClass,\r\n  stretcherElementClass,\r\n  stretcherElementInstance,\r\n  translationValue,\r\n  containerClass,\r\n  containerInstance,\r\n  containersInDraggable,\r\n} from './constants';\r\nimport {\r\n  SmoothDnD,\r\n  ContainerOptions,\r\n  ElementX,\r\n  IContainer,\r\n  DragInfo,\r\n  ContainerProps,\r\n  DraggableInfo,\r\n  DragResult,\r\n  SmoothDnDCreator,\r\n} from './interfaces';\r\n\r\nconst defaultOptions: ContainerOptions = {\r\n  groupName: undefined,\r\n  behaviour: 'move', // move | copy\r\n  orientation: 'vertical', // vertical | horizontal\r\n  getChildPayload: undefined,\r\n  animationDuration: 250,\r\n  autoScrollEnabled: true,\r\n  shouldAcceptDrop: undefined,\r\n  shouldAnimateDrop: undefined,\r\n};\r\n\r\nfunction setAnimation(element: HTMLElement, add: boolean, animationDuration = defaultOptions.animationDuration) {\r\n  if (add) {\r\n    addClass(element, animationClass);\r\n    element.style.transitionDuration = animationDuration + 'ms';\r\n  } else {\r\n    removeClass(element, animationClass);\r\n    element.style.removeProperty('transition-duration');\r\n  }\r\n}\r\n\r\nfunction getContainer(element: ElementX) {\r\n  return element ? element[containerInstance] : null;\r\n}\r\n\r\nfunction initOptions(props = defaultOptions): ContainerOptions {\r\n  return Object.assign({}, defaultOptions, props);\r\n}\r\n\r\nfunction isDragRelevant({ element, options }: ContainerProps) {\r\n  return function(sourceContainer: IContainer, payload: any) {\r\n    if (options.shouldAcceptDrop) {\r\n      return options.shouldAcceptDrop(sourceContainer.getOptions(), payload);\r\n    }\r\n    const sourceOptions = sourceContainer.getOptions();\r\n    if (options.behaviour === 'copy') return false;\r\n\r\n    const parentWrapper = getParent(element, '.' + wrapperClass);\r\n    if (parentWrapper === sourceContainer.element) {\r\n      return false;\r\n    }\r\n\r\n    if (sourceContainer.element === element) return true;\r\n    if (sourceOptions.groupName && sourceOptions.groupName === options.groupName) return true;\r\n\r\n    return false;\r\n  };\r\n}\r\n\r\nfunction wrapChild(child: HTMLElement) {\r\n  if (smoothDnD.wrapChild) {\r\n    const div = global.document.createElement('div');\r\n    div.className = `${wrapperClass}`;\r\n    child.parentElement!.insertBefore(div, child);\r\n    div.appendChild(child);\r\n    return div;\r\n  }\r\n\r\n  return child;\r\n}\r\n\r\nfunction wrapChildren(element: HTMLElement) {\r\n  const draggables: ElementX[] = [];\r\n  Array.prototype.forEach.call(element.children, (child: ElementX) => {\r\n    if (child.nodeType === Node.ELEMENT_NODE) {\r\n      let wrapper = child;\r\n      if (!hasClass(child, wrapperClass)) {\r\n        wrapper = wrapChild(child);\r\n      }\r\n      wrapper[containersInDraggable] = [];\r\n      wrapper[translationValue] = 0;\r\n      draggables.push(wrapper);\r\n    } else {\r\n      element.removeChild(child);\r\n    }\r\n  });\r\n  return draggables;\r\n}\r\n\r\nfunction unwrapChildren(element: HTMLElement) {\r\n  if (smoothDnD.wrapChild) {\r\n    Array.prototype.forEach.call(element.children, (child: HTMLElement) => {\r\n      if (child.nodeType === Node.ELEMENT_NODE) {\r\n        if (hasClass(child, wrapperClass)) {\r\n          element.insertBefore(child.firstElementChild as HTMLElement, child);\r\n          element.removeChild(child);\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction findDraggebleAtPos({ layout }: { layout: ReturnType<typeof layoutManager> }) {\r\n  const find = (\r\n    draggables: HTMLElement[],\r\n    pos: number,\r\n    startIndex: number,\r\n    endIndex: number,\r\n    withRespectToMiddlePoints = false\r\n  ): number | null => {\r\n    if (endIndex < startIndex) {\r\n      return startIndex;\r\n    }\r\n    // binary serach draggable\r\n    if (startIndex === endIndex) {\r\n      let { begin, end } = layout.getBeginEnd(draggables[startIndex]);\r\n      // mouse pos is inside draggable\r\n      // now decide which index to return\r\n      if (pos > begin && pos <= end) {\r\n        if (withRespectToMiddlePoints) {\r\n          return pos < (end + begin) / 2 ? startIndex : startIndex + 1;\r\n        } else {\r\n          return startIndex;\r\n        }\r\n      } else {\r\n        return null;\r\n      }\r\n    } else {\r\n      const middleIndex = Math.floor((endIndex + startIndex) / 2);\r\n      const { begin, end } = layout.getBeginEnd(draggables[middleIndex]);\r\n      if (pos < begin) {\r\n        return find(draggables, pos, startIndex, middleIndex - 1, withRespectToMiddlePoints);\r\n      } else if (pos > end) {\r\n        return find(draggables, pos, middleIndex + 1, endIndex, withRespectToMiddlePoints);\r\n      } else {\r\n        if (withRespectToMiddlePoints) {\r\n          return pos < (end + begin) / 2 ? middleIndex : middleIndex + 1;\r\n        } else {\r\n          return middleIndex;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return (draggables: HTMLElement[], pos: number, withRespectToMiddlePoints = false) => {\r\n    return find(draggables, pos, 0, draggables.length - 1, withRespectToMiddlePoints);\r\n  };\r\n}\r\n\r\nfunction resetDraggables({ element, draggables, layout }: ContainerProps) {\r\n  return function() {\r\n    draggables.forEach((p: ElementX) => {\r\n      setAnimation(p, false);\r\n      layout.setTranslation(p, 0);\r\n      layout.setVisibility(p, true);\r\n      p[containersInDraggable] = [];\r\n    });\r\n\r\n    if (element[stretcherElementInstance]) {\r\n      element[stretcherElementInstance].parentNode.removeChild(element[stretcherElementInstance]);\r\n      element[stretcherElementInstance] = null;\r\n    }\r\n  };\r\n}\r\n\r\nfunction setTargetContainer(draggableInfo: DraggableInfo, element: HTMLElement, set = true) {\r\n  if (element && set) {\r\n    draggableInfo.targetElement = element;\r\n  } else {\r\n    if (draggableInfo.targetElement === element) {\r\n      draggableInfo.targetElement = null;\r\n    }\r\n  }\r\n}\r\n\r\nfunction handleDrop({ element, draggables, layout, options }: ContainerProps) {\r\n  const draggablesReset = resetDraggables({ element, draggables, layout, options });\r\n  const dropHandler = (smoothDnD.dropHandler || domDropHandler)({ element, draggables, layout, options });\r\n  return function(draggableInfo: DraggableInfo, { addedIndex, removedIndex }: DragResult) {\r\n    draggablesReset();\r\n    // if drop zone is valid => complete drag else do nothing everything will be reverted by draggablesReset()\r\n    if (draggableInfo.targetElement || options.removeOnDropOut) {\r\n      let actualAddIndex =\r\n        addedIndex !== null ? (removedIndex !== null && removedIndex < addedIndex ? addedIndex - 1 : addedIndex) : null;\r\n      const dropHandlerParams = {\r\n        removedIndex,\r\n        addedIndex: actualAddIndex,\r\n        payload: draggableInfo.payload,\r\n        droppedElement: draggableInfo.element.firstElementChild,\r\n      };\r\n      dropHandler(dropHandlerParams, options.onDrop);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getContainerProps(element: HTMLElement, initialOptions?: ContainerOptions): ContainerProps {\r\n  const options = initOptions(initialOptions);\r\n  const draggables = wrapChildren(element);\r\n  // set flex classes before layout is inited for scroll listener\r\n  addClass(element, `${containerClass} ${options.orientation}`);\r\n  const layout = layoutManager(element, options.orientation!, options.animationDuration!);\r\n  return {\r\n    element,\r\n    draggables,\r\n    options,\r\n    layout,\r\n  };\r\n}\r\n\r\nfunction getRelaventParentContainer(container: IContainer, relevantContainers: IContainer[]) {\r\n  let current: ElementX | null = container.element;\r\n  while (current) {\r\n    const containerOfParentElement = getContainer(current.parentElement as ElementX);\r\n    if (containerOfParentElement && relevantContainers.indexOf(containerOfParentElement) > -1) {\r\n      return {\r\n        container: containerOfParentElement,\r\n        draggable: current,\r\n      };\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nfunction registerToParentContainer(container: IContainer, relevantContainers: IContainer[]) {\r\n  const parentInfo = getRelaventParentContainer(container, relevantContainers);\r\n  if (parentInfo) {\r\n    parentInfo.container.getChildContainers().push(container);\r\n    container.setParentContainer(parentInfo.container);\r\n    //current should be draggable\r\n    parentInfo.draggable[containersInDraggable].push(container);\r\n  }\r\n}\r\n\r\nfunction getRemovedItem({ element, options }: ContainerProps) {\r\n  let prevRemovedIndex: number | null = null;\r\n  return ({ draggableInfo }: DragInfo) => {\r\n    let removedIndex = prevRemovedIndex;\r\n    if (prevRemovedIndex == null && draggableInfo.container.element === element && options.behaviour !== 'copy') {\r\n      removedIndex = prevRemovedIndex = draggableInfo.elementIndex;\r\n    }\r\n\r\n    return { removedIndex };\r\n  };\r\n}\r\n\r\nfunction setRemovedItemVisibilty({ draggables, layout }: ContainerProps) {\r\n  return ({ dragResult }: DragInfo) => {\r\n    if (dragResult.removedIndex !== null) {\r\n      layout.setVisibility(draggables[dragResult.removedIndex], false);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getPosition({ element, layout }: ContainerProps) {\r\n  return ({ draggableInfo }: DragInfo) => {\r\n    return {\r\n      pos: !getContainer(element).isPosInChildContainer() ? layout.getPosition(draggableInfo.position) : null,\r\n    };\r\n  };\r\n}\r\n\r\nfunction notifyParentOnPositionCapture({ element }: ContainerProps) {\r\n  let isCaptured = false;\r\n  return ({ dragResult }: DragInfo) => {\r\n    if (getContainer(element).getParentContainer() && isCaptured !== (dragResult.pos !== null)) {\r\n      isCaptured = dragResult.pos !== null;\r\n      getContainer(element)\r\n        .getParentContainer()\r\n        .onChildPositionCaptured(isCaptured);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getElementSize({ layout }: ContainerProps) {\r\n  let elementSize: number | null = null;\r\n  return ({ draggableInfo, dragResult }: DragInfo) => {\r\n    if (dragResult.pos === null) {\r\n      return (elementSize = null);\r\n    } else {\r\n      elementSize = elementSize || layout.getSize(draggableInfo.element);\r\n    }\r\n    return { elementSize };\r\n  };\r\n}\r\n\r\nfunction handleTargetContainer({ element }: ContainerProps) {\r\n  return ({ draggableInfo, dragResult }: DragInfo) => {\r\n    setTargetContainer(draggableInfo, element, !!dragResult.pos);\r\n  };\r\n}\r\n\r\nfunction getDragInsertionIndex({ draggables, layout }: ContainerProps) {\r\n  const findDraggable = findDraggebleAtPos({ layout });\r\n  return ({ dragResult: { shadowBeginEnd, pos } }: { dragResult: DragResult }) => {\r\n    if (!shadowBeginEnd) {\r\n      const index = findDraggable(draggables, pos, true);\r\n      return index !== null ? index : draggables.length;\r\n    } else {\r\n      if (shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment <= pos && shadowBeginEnd.end >= pos) {\r\n        // position inside ghost\r\n        return null;\r\n      }\r\n    }\r\n\r\n    if (pos < shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment) {\r\n      return findDraggable(draggables, pos);\r\n    } else if (pos > shadowBeginEnd.end) {\r\n      return findDraggable(draggables, pos)! + 1;\r\n    } else {\r\n      return draggables.length;\r\n    }\r\n  };\r\n}\r\n\r\nfunction getDragInsertionIndexForDropZone() {\r\n  return ({ dragResult: { pos } }: DragInfo) => {\r\n    return pos !== null ? { addedIndex: 0 } : { addedIndex: null };\r\n  };\r\n}\r\n\r\nfunction getShadowBeginEndForDropZone({ draggables, layout }: ContainerProps) {\r\n  let prevAddedIndex: number | null = null;\r\n  return ({ dragResult: { addedIndex } }: DragInfo) => {\r\n    if (addedIndex !== prevAddedIndex) {\r\n      prevAddedIndex = addedIndex;\r\n      const { begin, end } = layout.getBeginEndOfContainer();\r\n      return {\r\n        shadowBeginEnd: {\r\n          rect: layout.getTopLeftOfElementBegin(begin),\r\n        },\r\n      };\r\n    }\r\n\r\n    return null;\r\n  };\r\n}\r\n\r\nfunction invalidateShadowBeginEndIfNeeded(params: ContainerProps) {\r\n  const shadowBoundsGetter = getShadowBeginEnd(params);\r\n  return ({ draggableInfo, dragResult }: DragInfo) => {\r\n    if (draggableInfo.invalidateShadow) {\r\n      return shadowBoundsGetter({ draggableInfo, dragResult });\r\n    }\r\n    return null;\r\n  };\r\n}\r\n\r\nfunction getNextAddedIndex(params: ContainerProps) {\r\n  const getIndexForPos = getDragInsertionIndex(params);\r\n  return ({ dragResult }: DragInfo) => {\r\n    let index = null;\r\n    if (dragResult.pos !== null) {\r\n      index = getIndexForPos({ dragResult });\r\n      if (index === null) {\r\n        index = dragResult.addedIndex;\r\n      }\r\n    }\r\n    return {\r\n      addedIndex: index,\r\n    };\r\n  };\r\n}\r\n\r\nfunction resetShadowAdjustment() {\r\n  let lastAddedIndex: number | null = null;\r\n  return ({ dragResult: { addedIndex, shadowBeginEnd } }: DragInfo) => {\r\n    if (addedIndex !== lastAddedIndex && lastAddedIndex !== null && shadowBeginEnd) {\r\n      shadowBeginEnd.beginAdjustment = 0;\r\n    }\r\n    lastAddedIndex = addedIndex;\r\n  };\r\n}\r\n\r\nfunction handleInsertionSizeChange({ element, draggables, layout, options }: ContainerProps) {\r\n  let strectherElement: HTMLElement | null = null;\r\n  return function({ dragResult: { addedIndex, removedIndex, elementSize } }: DragInfo) {\r\n    if (removedIndex === null) {\r\n      if (addedIndex !== null) {\r\n        if (!strectherElement) {\r\n          const containerBeginEnd = layout.getBeginEndOfContainer();\r\n          containerBeginEnd.end = containerBeginEnd.begin + layout.getSize(element);\r\n          const hasScrollBar = layout.getScrollSize(element) > layout.getSize(element);\r\n          const containerEnd = hasScrollBar\r\n            ? containerBeginEnd.begin + layout.getScrollSize(element) - layout.getScrollValue(element)\r\n            : containerBeginEnd.end;\r\n          const lastDraggableEnd =\r\n            draggables.length > 0\r\n              ? layout.getBeginEnd(draggables[draggables.length - 1]).end - draggables[draggables.length - 1][translationValue]\r\n              : containerBeginEnd.begin;\r\n          if (lastDraggableEnd + elementSize > containerEnd) {\r\n            strectherElement = global.document.createElement('div') as HTMLElement;\r\n            strectherElement.className = stretcherElementClass + ' ' + options.orientation;\r\n            const stretcherSize = elementSize + lastDraggableEnd - containerEnd;\r\n            layout.setSize(strectherElement.style, `${stretcherSize}px`);\r\n            element.appendChild(strectherElement);\r\n            element[stretcherElementInstance] = strectherElement;\r\n            return {\r\n              containerBoxChanged: true,\r\n            };\r\n          }\r\n        }\r\n      } else {\r\n        if (strectherElement) {\r\n          layout.setTranslation(strectherElement, 0);\r\n          let toRemove = strectherElement;\r\n          strectherElement = null;\r\n          element.removeChild(toRemove);\r\n          element[stretcherElementInstance] = null;\r\n          return {\r\n            containerBoxChanged: true,\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    return undefined;\r\n  };\r\n}\r\n\r\nfunction calculateTranslations({ draggables, layout }: ContainerProps) {\r\n  let prevAddedIndex: number | null = null;\r\n  let prevRemovedIndex: number | null = null;\r\n  return function({ dragResult: { addedIndex, removedIndex, elementSize } }: { dragResult: DragResult }) {\r\n    if (addedIndex !== prevAddedIndex || removedIndex !== prevRemovedIndex) {\r\n      for (let index = 0; index < draggables.length; index++) {\r\n        if (index !== removedIndex) {\r\n          const draggable = draggables[index];\r\n          let translate = 0;\r\n          if (removedIndex !== null && removedIndex < index) {\r\n            translate -= layout.getSize(draggables[removedIndex]);\r\n          }\r\n          if (addedIndex !== null && addedIndex <= index) {\r\n            translate += elementSize;\r\n          }\r\n          layout.setTranslation(draggable, translate);\r\n        }\r\n      }\r\n\r\n      prevAddedIndex = addedIndex;\r\n      prevRemovedIndex = removedIndex;\r\n\r\n      return { addedIndex, removedIndex };\r\n    }\r\n\r\n    return undefined;\r\n  };\r\n}\r\n\r\nfunction getShadowBeginEnd({ draggables, layout }: ContainerProps) {\r\n  let prevAddedIndex: number | null = null;\r\n  return ({ draggableInfo, dragResult }: DragInfo) => {\r\n    const { addedIndex, removedIndex, elementSize, pos, shadowBeginEnd } = dragResult;\r\n    if (pos !== null) {\r\n      if (addedIndex !== null && (draggableInfo.invalidateShadow || addedIndex !== prevAddedIndex)) {\r\n        if (prevAddedIndex) prevAddedIndex = addedIndex;\r\n        let beforeIndex = addedIndex - 1;\r\n        let begin = 0;\r\n        let afterBounds = null;\r\n        let beforeBounds = null;\r\n        if (beforeIndex === removedIndex) {\r\n          beforeIndex--;\r\n        }\r\n        if (beforeIndex > -1) {\r\n          const beforeSize = layout.getSize(draggables[beforeIndex]);\r\n          beforeBounds = layout.getBeginEnd(draggables[beforeIndex]);\r\n          if (elementSize < beforeSize) {\r\n            const threshold = (beforeSize - elementSize) / 2;\r\n            begin = beforeBounds.end - threshold;\r\n          } else {\r\n            begin = beforeBounds.end;\r\n          }\r\n        } else {\r\n          beforeBounds = { end: layout.getBeginEndOfContainer().begin };\r\n        }\r\n\r\n        let end = 10000;\r\n        let afterIndex = addedIndex;\r\n        if (afterIndex === removedIndex) {\r\n          afterIndex++;\r\n        }\r\n        if (afterIndex < draggables.length) {\r\n          const afterSize = layout.getSize(draggables[afterIndex]);\r\n          afterBounds = layout.getBeginEnd(draggables[afterIndex]);\r\n\r\n          if (elementSize < afterSize) {\r\n            const threshold = (afterSize - elementSize) / 2;\r\n            end = afterBounds.begin + threshold;\r\n          } else {\r\n            end = afterBounds.begin;\r\n          }\r\n        } else {\r\n          afterBounds = { begin: layout.getContainerRectangles().rect.end };\r\n        }\r\n\r\n        const shadowRectTopLeft = beforeBounds && afterBounds ? layout.getTopLeftOfElementBegin(beforeBounds.end) : null;\r\n\r\n        return {\r\n          shadowBeginEnd: {\r\n            begin,\r\n            end,\r\n            rect: shadowRectTopLeft,\r\n            beginAdjustment: shadowBeginEnd ? shadowBeginEnd.beginAdjustment : 0,\r\n          },\r\n        };\r\n      } else {\r\n        return null;\r\n      }\r\n    } else {\r\n      prevAddedIndex = null;\r\n      return {\r\n        shadowBeginEnd: null,\r\n      };\r\n    }\r\n  };\r\n}\r\n\r\nfunction handleFirstInsertShadowAdjustment() {\r\n  let lastAddedIndex: number | null = null;\r\n  return ({ dragResult: { pos, addedIndex, shadowBeginEnd } }: DragInfo) => {\r\n    if (pos !== null) {\r\n      if (addedIndex != null && lastAddedIndex === null) {\r\n        if (pos < shadowBeginEnd.begin) {\r\n          const beginAdjustment = pos - shadowBeginEnd.begin - 5;\r\n          shadowBeginEnd.beginAdjustment = beginAdjustment;\r\n        }\r\n        lastAddedIndex = addedIndex;\r\n      }\r\n    } else {\r\n      lastAddedIndex = null;\r\n    }\r\n  };\r\n}\r\n\r\nfunction fireDragEnterLeaveEvents({ options }: ContainerProps) {\r\n  let wasDragIn = false;\r\n  return ({ dragResult: { pos } }: DragInfo) => {\r\n    const isDragIn = !!pos;\r\n    if (isDragIn !== wasDragIn) {\r\n      wasDragIn = isDragIn;\r\n      if (isDragIn) {\r\n        options.onDragEnter && options.onDragEnter();\r\n      } else {\r\n        options.onDragLeave && options.onDragLeave();\r\n        return {\r\n          dragLeft: true,\r\n        };\r\n      }\r\n    }\r\n\r\n    return undefined;\r\n  };\r\n}\r\n\r\nfunction fireOnDropReady({ options }: ContainerProps) {\r\n  let lastAddedIndex: number | null = null;\r\n  return ({ dragResult: { addedIndex, removedIndex }, draggableInfo: { payload, element } }: DragInfo) => {\r\n    if (options.onDropReady && addedIndex !== null && lastAddedIndex !== addedIndex) {\r\n      lastAddedIndex = addedIndex;\r\n      let adjustedAddedIndex = addedIndex;\r\n\r\n      if (removedIndex !== null && addedIndex > removedIndex) {\r\n        adjustedAddedIndex--;\r\n      }\r\n\r\n      options.onDropReady({\r\n        addedIndex: adjustedAddedIndex,\r\n        removedIndex,\r\n        payload,\r\n        element: element.firstElementChild as HTMLElement,\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\nfunction getDragHandler(params: any) {\r\n  if (params.options.behaviour === 'drop-zone') {\r\n    // sorting is disabled in container, addedIndex will always be 0 if dropped in\r\n    return compose(params)(\r\n      getRemovedItem,\r\n      setRemovedItemVisibilty,\r\n      getPosition,\r\n      notifyParentOnPositionCapture,\r\n      getElementSize,\r\n      handleTargetContainer,\r\n      getDragInsertionIndexForDropZone,\r\n      getShadowBeginEndForDropZone,\r\n      fireDragEnterLeaveEvents,\r\n      fireOnDropReady\r\n    );\r\n  } else {\r\n    return compose(params)(\r\n      getRemovedItem,\r\n      setRemovedItemVisibilty,\r\n      getPosition,\r\n      notifyParentOnPositionCapture,\r\n      getElementSize,\r\n      handleTargetContainer,\r\n      invalidateShadowBeginEndIfNeeded,\r\n      getNextAddedIndex,\r\n      resetShadowAdjustment,\r\n      handleInsertionSizeChange,\r\n      calculateTranslations,\r\n      getShadowBeginEnd,\r\n      handleFirstInsertShadowAdjustment,\r\n      fireDragEnterLeaveEvents,\r\n      fireOnDropReady\r\n    );\r\n  }\r\n}\r\n\r\nfunction getDefaultDragResult() {\r\n  return {\r\n    addedIndex: null,\r\n    removedIndex: null,\r\n    elementSize: null,\r\n    pos: null,\r\n    shadowBeginEnd: null,\r\n  };\r\n}\r\n\r\nfunction compose(params: any) {\r\n  return (...functions: any[]) => {\r\n    const hydratedFunctions = functions.map(p => p(params));\r\n    let result: DragResult | null = null;\r\n    return (draggableInfo: DraggableInfo) => {\r\n      result = hydratedFunctions.reduce((dragResult, fn) => {\r\n        return Object.assign(dragResult, fn({ draggableInfo, dragResult }));\r\n      }, result || getDefaultDragResult());\r\n      return result;\r\n    };\r\n  };\r\n}\r\n\r\n// Container definition begin\r\nfunction Container(element: HTMLElement): (options?: ContainerOptions) => any {\r\n  return function(options?: ContainerOptions) {\r\n    let dragResult: DragResult | null = null;\r\n    let lastDraggableInfo: DraggableInfo | null = null;\r\n    const props = getContainerProps(element, options);\r\n    let dragHandler = getDragHandler(props);\r\n    let dropHandler = handleDrop(props);\r\n    let parentContainer: IContainer | null = null;\r\n    let posIsInChildContainer = false;\r\n    let childContainers: IContainer[] = [];\r\n\r\n    function processLastDraggableInfo() {\r\n      if (lastDraggableInfo !== null) {\r\n        lastDraggableInfo.invalidateShadow = true;\r\n        dragResult = dragHandler(lastDraggableInfo!);\r\n        lastDraggableInfo.invalidateShadow = false;\r\n      }\r\n    }\r\n\r\n    function onChildPositionCaptured(isCaptured: boolean) {\r\n      posIsInChildContainer = isCaptured;\r\n      if (parentContainer) {\r\n        parentContainer.onChildPositionCaptured(isCaptured);\r\n        if (lastDraggableInfo) {\r\n          dragResult = dragHandler(lastDraggableInfo);\r\n        }\r\n      }\r\n    }\r\n\r\n    function setDraggables(draggables: HTMLElement[], element: HTMLElement) {\r\n      const newDraggables = wrapChildren(element);\r\n      for (let i = 0; i < newDraggables.length; i++) {\r\n        draggables[i] = newDraggables[i];\r\n      }\r\n\r\n      for (let i = 0; i < draggables.length - newDraggables.length; i++) {\r\n        draggables.pop();\r\n      }\r\n    }\r\n\r\n    function prepareDrag(container: IContainer, relevantContainers: IContainer[]) {\r\n      const element = container.element;\r\n      const draggables = props.draggables;\r\n      const options = container.getOptions();\r\n      setDraggables(draggables, element);\r\n      container.layout.invalidateRects();\r\n      registerToParentContainer(container, relevantContainers);\r\n      draggables.forEach(p => setAnimation(p, true, options.animationDuration));\r\n    }\r\n\r\n    props.layout.setScrollListener(function() {\r\n      processLastDraggableInfo();\r\n    });\r\n\r\n    function handleDragLeftDeferedTranslation() {\r\n      if (dragResult && dragResult.dragLeft && props.options.behaviour !== 'drop-zone') {\r\n        dragResult.dragLeft = false;\r\n        setTimeout(() => {\r\n          if (dragResult) {\r\n            calculateTranslations(props)({ dragResult });\r\n          }\r\n        }, 20);\r\n      }\r\n    }\r\n\r\n    function dispose(container: IContainer) {\r\n      unwrapChildren(container.element);\r\n    }\r\n\r\n    const container: IContainer = {\r\n      element,\r\n      draggables: props.draggables,\r\n      isDragRelevant: isDragRelevant(props),\r\n      getScale: props.layout.getContainerScale,\r\n      layout: props.layout,\r\n      getChildContainers: () => childContainers,\r\n      onChildPositionCaptured,\r\n      dispose,\r\n      prepareDrag,\r\n      isPosInChildContainer: () => posIsInChildContainer,\r\n      handleDrag(draggableInfo: DraggableInfo) {\r\n        lastDraggableInfo = draggableInfo;\r\n        dragResult = dragHandler(draggableInfo);\r\n        handleDragLeftDeferedTranslation();\r\n        return dragResult;\r\n      },\r\n      handleDrop(draggableInfo: DraggableInfo) {\r\n        lastDraggableInfo = null;\r\n        onChildPositionCaptured(false);\r\n        dragHandler = getDragHandler(props);\r\n        dropHandler(draggableInfo, dragResult!);\r\n        dragResult = null;\r\n        parentContainer = null;\r\n        childContainers = [];\r\n      },\r\n      getDragResult() {\r\n        return dragResult;\r\n      },\r\n      getTranslateCalculator(dragresult: { dragResult: DragResult }) {\r\n        return calculateTranslations(props)(dragresult);\r\n      },\r\n      setParentContainer: (container: IContainer) => {\r\n        parentContainer = container;\r\n      },\r\n      getParentContainer: () => parentContainer,\r\n      onTranslated: () => {\r\n        processLastDraggableInfo();\r\n      },\r\n      getOptions: () => props.options,\r\n      setDraggables: () => {\r\n        setDraggables(props.draggables, element);\r\n      },\r\n    };\r\n\r\n    return container;\r\n  };\r\n}\r\n\r\n// const options: ContainerOptions = {\r\n//   behaviour: 'move',\r\n//   groupName: 'bla bla', // if not defined => container will not interfere with other containers\r\n//   orientation: 'vertical',\r\n//   dragHandleSelector: undefined,\r\n//   nonDragAreaSelector: 'some selector',\r\n//   dragBeginDelay: 0,\r\n//   animationDuration: 180,\r\n//   autoScrollEnabled: true,\r\n//   lockAxis: 'x',\r\n//   dragClass: undefined,\r\n//   dropClass: undefined,\r\n//   onDragStart: (index, payload) => {},\r\n//   onDrop: ({ removedIndex, addedIndex, payload, element }) => {},\r\n//   getChildPayload: index => null,\r\n//   shouldAnimateDrop: (sourceContainerOptions, payload) => true,\r\n//   shouldAcceptDrop: (sourceContainerOptions, payload) => true,\r\n//   onDragEnter: () => {},\r\n//   onDragLeave: () => { },\r\n//   onDropReady: ({ removedIndex, addedIndex, payload, element }) => { },\r\n// };\r\n\r\n// exported part of container\r\nconst smoothDnD: SmoothDnDCreator = function(element: HTMLElement, options?: ContainerOptions): SmoothDnD {\r\n  const containerIniter = Container(element);\r\n  const container = containerIniter(options);\r\n  (element as ElementX)[containerInstance] = container;\r\n  Mediator.register(container);\r\n  return {\r\n    dispose() {\r\n      Mediator.unregister(container); \r\n      container.layout.dispose();\r\n      container.dispose(container);\r\n    },\r\n  };\r\n  };\r\n\r\n  HTMLDivElement\r\n\r\n// wrap all draggables by default \r\n// in react,vue,angular this value will be set to false\r\nsmoothDnD.wrapChild = true;\r\n\r\nexport default smoothDnD;\r\n","import container from './src/container';\r\nimport * as constants from './src/constants';\r\nimport * as dropHandlers from './src/dropHandlers';\r\nimport { SmoothDnDCreator, ElementX, ContainerOptions } from './src/interfaces';\r\n\r\nexport { container as smoothDnD, constants, dropHandlers };\r\n\r\nconst deprecetedDefaultExport: SmoothDnDCreator = function(element: ElementX, options?: ContainerOptions) {\r\n    console.warn('default export is deprecated. please use named export \"smoothDnD\"');\r\n\r\n    if (deprecetedDefaultExport.dropHandler !== undefined) {\r\n        container.dropHandler = deprecetedDefaultExport.dropHandler;\r\n    }\r\n\r\n    if (deprecetedDefaultExport.wrapChild !== undefined) {\r\n        container.wrapChild = deprecetedDefaultExport.wrapChild;\r\n    }\r\n\r\n    return container(element, options);\r\n};\r\n\r\nexport default deprecetedDefaultExport;\r\n"],"names":["constructor","prototype","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","document","ownerDocument","querySelectorAll","i","length","item","global","Node","Element","firstElementChild","Object","defineProperty","get","node","nodes","childNodes","nodeType","Array","some","fun","TypeError","t","len","thisArg","arguments","call","getIntersectionOnAxis","rect1","rect2","axis","left","Math","max","top","right","min","bottom","getContainerRect","element","_rect","getBoundingClientRect","rect","hasBiggerChild","isScrollingOrHidden","width","scrollWidth","height","scrollHeight","getScrollingAxis","style","getComputedStyle","overflow","general","overFlowX","xScroll","overFlowY","yScroll","isScrolling","overFlowAxis","dimensionScroll","clientWidth","clientHeight","getVisibleRect","elementRect","currentElement","parentElement","listenScrollParent","clb","scrollers","dispose","forEach","p","removeEventListener","setTimeout","addEventListener","push","getParent","selector","current","hasClass","cls","className","split","map","indexOf","addClass","classes","filter","unshift","join","removeClass","removeChildAt","parent","index","removeChild","children","addChildAt","child","appendChild","insertBefore","isMobile","window","navigator","userAgent","match","clearSelection","getSelection","empty","removeAllRanges","selection","getElementCursor","cursor","containerInstance","containersInDraggable","defaultGroupName","wrapperClass","defaultGrabHandleClass","animationClass","translationValue","visibilityValue","ghostClass","containerClass","extraSizeForInsertion","stretcherElementClass","stretcherElementInstance","isDraggableDetached","disbaleTouchActions","noUserSelectClass","verticalWrapperClass","horizontalWrapperClass","stretcherElementHorizontalClass","css","constants","convertToCssString","keys","reduce","styleString","propName","propValue","addStyleToHead","head","getElementsByTagName","createElement","cssString","type","styleSheet","cssText","createTextNode","addCursorStyleToBody","removeStyle","styleElement","maxSpeed","addScrollValue","value","scrollLeft","scrollTop","scrollBy","createAnimator","isAnimating","request","startTime","direction","speed","animate","_direction","_speed","start","requestAnimationFrame","timestamp","timeDiff","distanceDiff","stop","cancelAnimationFrame","getAutoScrollInfo","position","scrollableInfo","x","y","begin","end","pos","moveDistance","speedFactor","result","descendants","invalidate","getScrollableElements","containerElements","scrollables","firstDescendentScrollable","el","scrollingAxis","info","assign","getScrollableAnimator","getWindowAnimators","getWindowRect","innerWidth","innerHeight","containers","scrollablesInfo","animators","draggableInfo","reset","animator","scrollParams","mousePosition","grabEvents","moveEvents","releaseEvents","dragListeningContainers","grabbedElement","ghostInfo","isDragging","handleDrag","handleScroll","sourceContainerLockAxis","cursorStyleElement","Utils","listenEvents","addGrabListeners","e","onMouseDown","passive","addMoveListeners","onMouseMove","removeMoveListeners","addReleaseListeners","onMouseUp","removeReleaseListeners","getGhostParent","ghostParent","body","getGhostElement","wrapperElement","container","midX","midY","ghost","cloneNode","zIndex","boxSizing","transition","removeProperty","pointerEvents","getOptions","dragClass","dragCursor","orientation","centerDelta","positionDelta","getDraggableInfo","draggableElement","draggableIndex","draggables","elementIndex","payload","getChildPayload","undefined","targetElement","groupName","invalidateShadow","handleDropAnimation","callback","endDrop","transitionDuration","animateGhostToPosition","duration","dropClass","shouldAnimateDrop","options","dragResult","getDragResult","shadowBeginEnd","animationDuration","behaviour","removeOnDropOut","removedIndex","elementSize","layout","getTranslateCalculator","addedIndex","prevDraggableEnd","getBeginEnd","getBeginEndOfContainer","getTopLeftOfElementBegin","opacity","transform","handleDragStartConditions","startEvent","delay","timer","moveThreshold","maxMoveInDelay","onMove","event","getPointerEvent","currentX","clientX","currentY","clientY","abs","callCallback","deregisterEvent","onUp","onHTMLDrag","registerEvents","clearTimeout","_startEvent","_delay","_clb","button","target","containerElement","dragHandleSelector","nonDragAreaSelector","startDrag","dragBeginDelay","initiateDrag","fireOnDragStartEnd","handleDrop","sourceContainer","touches","dragHandler","targetContainers","containerBoxChanged","invalidateRects","onTranslated","getScrollHandler","autoScrollEnabled","dragScroller","props","isStart","fn","onDragStart","onDragEnd","isSource","isDragRelevant","willAcceptDrop","setDraggables","lockAxis","toLowerCase","prepareDrag","preventDefault","Mediator","register","unregister","splice","horizontalMap","size","distanceToParent","translate","dragPosition","scrollSize","offsetSize","scrollValue","scale","setSize","setters","val","verticalMap","orientationDependentProps","obj","prop","mappedProp","set","layoutManager","_animationDuration","propMapper","values","translation","registeredScrollListener","invalidateContainerRectangles","scrollListener","invalidateContainerScale","visibleRect","scaleX","offsetWidth","scaleY","offsetHeight","getContainerRectangles","getBeginEndOfDOMRect","getBeginEndOfContainerVisibleRect","getContainerScale","getSize","getDistanceToOffsetParent","distance","getAxisValue","updateDescendantContainerRects","getChildContainers","setTranslation","getTranslation","setVisibility","isVisible","visibility","isInVisibleRect","containerRect","setScrollListener","getScrollSize","getScrollValue","setScrollValue","getPosition","domDropHandler","dropResult","onDrop","droppedElement","removedWrapper","wrapper","reactDropHandler","handler","defaultOptions","shouldAcceptDrop","setAnimation","add","getContainer","initOptions","sourceOptions","parentWrapper","wrapChild","smoothDnD","div","wrapChildren","ELEMENT_NODE","unwrapChildren","findDraggebleAtPos","find","startIndex","endIndex","withRespectToMiddlePoints","middleIndex","floor","resetDraggables","parentNode","setTargetContainer","draggablesReset","dropHandler","actualAddIndex","dropHandlerParams","getContainerProps","initialOptions","getRelaventParentContainer","relevantContainers","containerOfParentElement","draggable","registerToParentContainer","parentInfo","setParentContainer","getRemovedItem","prevRemovedIndex","setRemovedItemVisibilty","isPosInChildContainer","notifyParentOnPositionCapture","isCaptured","getParentContainer","onChildPositionCaptured","getElementSize","handleTargetContainer","getDragInsertionIndex","findDraggable","beginAdjustment","getDragInsertionIndexForDropZone","getShadowBeginEndForDropZone","prevAddedIndex","invalidateShadowBeginEndIfNeeded","params","shadowBoundsGetter","getShadowBeginEnd","getNextAddedIndex","getIndexForPos","resetShadowAdjustment","lastAddedIndex","handleInsertionSizeChange","strectherElement","containerBeginEnd","hasScrollBar","containerEnd","lastDraggableEnd","stretcherSize","toRemove","calculateTranslations","beforeIndex","afterBounds","beforeBounds","beforeSize","threshold","afterIndex","afterSize","shadowRectTopLeft","handleFirstInsertShadowAdjustment","fireDragEnterLeaveEvents","wasDragIn","isDragIn","onDragEnter","onDragLeave","dragLeft","fireOnDropReady","onDropReady","adjustedAddedIndex","getDragHandler","compose","getDefaultDragResult","functions","hydratedFunctions","Container","lastDraggableInfo","parentContainer","posIsInChildContainer","childContainers","processLastDraggableInfo","newDraggables","pop","handleDragLeftDeferedTranslation","getScale","dragresult","containerIniter","deprecetedDefaultExport","console","warn"],"mappings":"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"}