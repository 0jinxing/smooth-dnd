{"version":3,"sources":["webpack://SmoothDND/webpack/universalModuleDefinition","webpack://SmoothDND/webpack/bootstrap","webpack://SmoothDND/./src/constants.js","webpack://SmoothDND/./src/utils.js","webpack://SmoothDND/./src/dropHandlers.js","webpack://SmoothDND/./src/styles.js","webpack://SmoothDND/./src/mediator.js","webpack://SmoothDND/./src/layoutManager.js","webpack://SmoothDND/./src/dragscroller.js","webpack://SmoothDND/./src/container.js","webpack://SmoothDND/./index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","containerInstance","containersInDraggable","defaultGroupName","wrapperClass","defaultGrabHandleClass","animationClass","translationValue","visibilityValue","ghostClass","containerClass","extraSizeForInsertion","stretcherElementClass","stretcherElementInstance","isDraggableDetached","disbaleTouchActions","noUserSelectClass","getIntersection","rect1","rect2","left","Math","max","top","right","min","bottom","getIntersectionOnAxis","axis","getContainerRect","element","_rect","getBoundingClientRect","rect","hasBiggerChild","isScrollingOrHidden","width","scrollWidth","height","scrollHeight","isScrolling","style","getComputedStyle","overflow","overFlowAxis","clientWidth","clientHeight","hasScrollBar","getVisibleRect","elementRect","currentElement","parentElement","listenScrollParent","clb","scrollers","setTimeout","addEventListener","push","dispose","forEach","removeEventListener","hasParent","parent","current","getParent","selector","matches","hasClass","cls","className","split","map","indexOf","addClass","classes","filter","join","removeClass","debounce","fn","delay","immediate","timer","_len","arguments","length","params","Array","_key","clearTimeout","apply","undefined","concat","removeChildAt","index","removeChild","children","addChildAt","child","lenght","appendChild","insertBefore","isMobile","navigator","userAgent","match","domDropHandler","_ref","draggables","options","layout","dropResult","onDrop","removedIndex","addedIndex","droppedElement","_utils","splice","wrapper","document","createElement","_constants","orientation","cloneNode","reactDropHandler","handler","_ref2","constants","css","position","_defineProperty","_css","box-sizing","white-space","display","transition","touch-actions","-ms-touch-actions","addStyleToHead","head","getElementsByTagName","cssString","convertToCssString","entries","reduce","styleString","_slicedToArray","propName","propValue","_typeof","type","styleSheet","cssText","createTextNode","Utils","_styles","grabEvents","moveEvents","releaseEvents","dragListeningContainers","grabbedElement","ghostInfo","draggableInfo","containers","isDragging","listenEvents","e","onMouseDown","passive","handleDragStartConditions","startEvent","moveThreshold","maxMoveInDelay","onMove","event","_getPointerEvent","getPointerEvent","currentX","clientX","currentY","clientY","abs","deregisterEvent","callCallback","onUp","onHTMLDrag","_startEvent","_delay","_clb","target","containerElement","container","dragHandleSelector","getOptions","nonDragAreaSelector","startDrag","preventDefault","dragBeginDelay","getSelection","empty","onMouseMove","onMouseUp","callback","endDrop","ghost","transitionDuration","body","animateGhostToPosition","duration","targetElement","getDragResult","shadowBeginEnd","animationDuration","behaviour","_container$getDragRes","elementSize","getTranslateCalculator","dragResult","prevDraggableEnd","getBeginEnd","end","getBeginEndOfContainer","begin","getTopLeftOfElementBegin","opacity","transform","handleDropAnimation","touchAction","handleDrop","touches","positionDelta","x","centerDelta","y","isDragRelevant","prepareDrag","draggableElement","draggableIndex","elementIndex","payload","getChildPayload","groupName","getDraggableInfo","_container$getScale","getScale","_container$getScale$s","scaleX","_container$getScale$s2","scaleY","_element$getBoundingC","dragClass","childNodes","midX","midY","div","pointerEvents","clone","transformOrigin","margin","getGhostElement","handleDrag","register","unregister","_animationDuration","propMapper","obj","prop","mappedProp","set","requestAnimationFrame","setters","orientationDependentProps","horizontalMap","verticalMap","values","translation","registeredScrollListener","invalidateContainerRectangles","invalidate","scrollListener","offsetWidth","offsetHeight","invalidateContainerScale","visibleRect","getSize","getAxisValue","getTranslation","isInVisibleRect","_values$visibleRect","getContainerRectangles","getBeginEndOfDOMRect","getBeginEndOfContainerVisibleRect","getDistanceToOffsetParent","setTranslation","updateDescendantContainerRects","invalidateRects","onTranslated","getChildContainers","setVisibility","isVisible","visibility","parentNode","getContainerScale","setScrollListener","setSize","size","getScrollSize","getScrollValue","setScrollValue","val","getPosition","distanceToParent","translate","dragPosition","scrollSize","offsetSize","scrollValue","scale","getScrollableParent","requestFrame","isAnimating","request","startTime","direction","speed","animate","_direction","_speed","start","timestamp","timeDiff","distanceDiff","scrollTo","stop","cancelAnimationFrame","lastPos","scrollableParent","scrollParentBeginEnd","animator","pos","scrollableBeginEnd","reset","autoScrollInfo","speedFactor","containerIniter","lastDraggableInfo","props","initialOptions","defaultOptions","result","assign","acceptGroups","initOptions","wrapChildren","_layoutManager2","default","getContainerProps","dragHandler","getDragHandler","dropHandler","_ref4","draggablesReset","_ref3","setAnimation","resetDraggables","_dropHandlers","_ref5","actualAddIndex","dropHandlerParams","firstChild","console","log","handleScrollOnDrag","_dragscroller2","parentContainer","posIsInChildContainer","childContainers","processLastDraggableInfo","invalidateShadow","onChildPositionCaptured","isCaptured","sourceContainer","sourceOptions","parentWrapper","relevantContainers","newDraggables","pop","registerToParentContainer","isPosInChildContainer","calculateTranslations","setParentContainer","getParentContainer","Container","_mediator2","setOptions","add","getContainer","wrapChild","findDraggebleAtPos","withRespectToMiddlePoints","find","startIndex","endIndex","_layout$getBeginEnd","middleIndex","floor","_layout$getBeginEnd2","getRelaventParentContainer","containerOfParentElement","draggable","parentInfo","getRemovedItem","_ref6","prevRemovedIndex","_ref7","setRemovedItemVisibilty","_ref8","_ref9","_ref10","_ref11","notifyParentOnPositionCapture","_ref12","_ref13","getElementSize","_ref14","_ref15","handleTargetContainer","_ref16","_ref17","setTargetContainer","invalidateShadowBeginEndIfNeeded","shadowBoundsGetter","getShadowBeginEnd","_ref20","getNextAddedIndex","_ref18","findDraggable","getIndexForPos","_ref19","_ref19$dragResult","beginAdjustment","_ref21","resetShadowAdjustment","lastAddedIndex","_ref22","_ref22$dragResult","handleInsertionSizeChange","_ref23","strectherElement","stretcherElementAdded","_ref24","_ref24$dragResult","containerBeginEnd","containerEnd","lastDraggableEnd","stretcherSize","toRemove","_ref25","prevAddedIndex","_ref26","_ref26$dragResult","_ref27","_ref28","beforeIndex","afterBounds","beforeBounds","beforeSize","threshold","afterIndex","afterSize","handleFirstInsertShadowAdjustment","_ref29","_ref29$dragResult","functions","hydratedFunctions","compose","_container","dropHandlers"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SmoothDND\"] = factory();\n\telse\n\t\troot[\"SmoothDND\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","export const containerInstance = 'smooth-dnd-container-instance';\r\nexport const containersInDraggable = 'smooth-dnd-containers-in-draggable';\r\n\r\nexport const defaultGroupName = '@@smooth-dnd-default-group@@';\r\nexport const wrapperClass = 'smooth-dnd-draggable-wrapper';\r\nexport const defaultGrabHandleClass = 'smooth-dnd-default-grap-handle';\r\nexport const animationClass = 'animated';\r\nexport const translationValue = '__smooth_dnd_draggable_translation_value';\r\nexport const visibilityValue = '__smooth_dnd_draggable_visibility_value';\r\nexport const ghostClass = 'smooth-dnd-ghost';\r\n\r\nexport const containerClass = 'smooth-dnd-container';\r\n\r\nexport const extraSizeForInsertion = 'smooth-dnd-extra-size-for-insertion';\r\nexport const stretcherElementClass = 'smooth-dnd-stretcher-element';\r\nexport const stretcherElementInstance = 'smooth-dnd-stretcher-instance';\r\n\r\nexport const isDraggableDetached = 'smoth-dnd-is-draggable-detached';\r\n\r\nexport const disbaleTouchActions = 'smooth-dnd-disable-touch-action';\r\nexport const noUserSelectClass = 'smooth-dnd-no-user-select';\r\n","export const getIntersection = (rect1, rect2) => {\r\n  return {\r\n    left: Math.max(rect1.left, rect2.left),\r\n    top: Math.max(rect1.top, rect2.top),\r\n    right: Math.min(rect1.right, rect2.right),\r\n    bottom: Math.min(rect1.bottom, rect2.bottom),\r\n  }\r\n}\r\n\r\nexport const getIntersectionOnAxis = (rect1, rect2, axis) => {\r\n  if (axis === 'x') {\r\n    return {\r\n      left: Math.max(rect1.left, rect2.left),\r\n      top: rect1.top,\r\n      right: Math.min(rect1.right, rect2.right),\r\n      bottom: rect1.bottom\r\n    }\r\n  } else {\r\n    return {\r\n      left: rect1.left,\r\n      top: Math.max(rect1.top, rect2.top),\r\n      right: rect1.right,\r\n      bottom: Math.min(rect1.bottom, rect2.bottom),\r\n    }\r\n  }\r\n}\r\n\r\nexport const getContainerRect = (element) => {\r\n  const _rect = element.getBoundingClientRect();\r\n  const rect = { \r\n    left: _rect.left,\r\n    right: _rect.right + 10,\r\n    top: _rect.top,\r\n    bottom: _rect.bottom\r\n  }\r\n  \r\n  if (hasBiggerChild(element, 'x') && !isScrollingOrHidden(element, 'x')) {\r\n    const width = rect.right - rect.left;\r\n    rect.right = rect.right + element.scrollWidth - width;\r\n  }\r\n\r\n  if (hasBiggerChild(element, 'y') && !isScrollingOrHidden(element, 'y')) {\r\n    const height = rect.bottom - rect.top;\r\n    rect.bottom = rect.bottom + element.scrollHeight - height;\r\n  }\r\n\r\n  return rect;\r\n}\r\n\r\nexport const isScrolling = (element, axis) => {\r\n  const style = window.getComputedStyle(element);\r\n  const overflow = style['overflow'];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general = overflow === 'auto' || overflow === 'scroll';\r\n  const dimensionScroll = overFlowAxis === 'auto' || overFlowAxis === 'scroll';\r\n  return general || dimensionScroll;\r\n}\r\n\r\nexport const isScrollingOrHidden = (element, axis) => {\r\n  const style = window.getComputedStyle(element);\r\n  const overflow = style['overflow'];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general = overflow === 'auto' || overflow === 'scroll' || overflow === 'hidden';\r\n  const dimensionScroll = overFlowAxis === 'auto' || overFlowAxis === 'scroll' || overFlowAxis === 'hidden';\r\n  return general || dimensionScroll;\r\n}\r\n\r\nexport const hasBiggerChild = (element, axis) => {\r\n  if (axis === 'x') {\r\n    return element.scrollWidth > element.clientWidth\r\n  } else {\r\n    return element.scrollHeight > element.clientHeight;\r\n  }\r\n}\r\n\r\nexport const hasScrollBar = (element, axis) => {\r\n  return hasBiggerChild(element, axis) && isScrolling(element, axis);\r\n}\r\n\r\nexport const getVisibleRect = (element, elementRect) => {\r\n  let currentElement = element;\r\n  let rect = elementRect || getContainerRect(element);\r\n  currentElement = element.parentElement;\r\n  while (currentElement) {\r\n    if (hasBiggerChild(currentElement, 'x') && isScrollingOrHidden(currentElement, 'x')) {\r\n      rect = getIntersectionOnAxis(rect, currentElement.getBoundingClientRect(), 'x');\r\n    }\r\n\r\n    if (hasBiggerChild(currentElement, 'y') && isScrollingOrHidden(currentElement, 'y')) {\r\n      rect = getIntersectionOnAxis(rect, currentElement.getBoundingClientRect(), 'y');\r\n    }\r\n\r\n    currentElement = currentElement.parentElement;\r\n  }\r\n\r\n  return rect;\r\n}\r\n\r\nexport const listenScrollParent = (element, clb) => {\r\n  let scrollers = [];\r\n  const dispose = () => {\r\n    scrollers.forEach(p => {\r\n      p.removeEventListener('scroll', clb);\r\n    });\r\n    window.removeEventListener('scroll', clb);\r\n  }\r\n\r\n  setTimeout(function() {\r\n    let currentElement = element;\r\n    while (currentElement) {\r\n      if (isScrolling(currentElement, 'x') || isScrolling(currentElement, 'y')) {\r\n        currentElement.addEventListener('scroll', clb);\r\n        scrollers.push(currentElement);\r\n      }\r\n      currentElement = currentElement.parentElement;\r\n    }\r\n\r\n    window.addEventListener('scroll', clb);\r\n  }, 10);\r\n\r\n  return {\r\n    dispose\r\n  }\r\n}\r\n\r\nexport const hasParent = (element, parent) => {\r\n  let current = element;\r\n  while (current) {\r\n    if (current === parent) {\r\n      return true;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport const getParent = (element, selector) => {\r\n  let current = element;\r\n  while (current) {\r\n    if (current.matches(selector)) {\r\n      return current;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport const hasClass = (element, cls) => {\r\n  return element.className.split(' ').map(p => p).indexOf(cls) > -1;\r\n}\r\n\r\nexport const addClass = (element, cls) => {\r\n  const classes = element.className.split(' ').filter(p => p);\r\n  if (classes.indexOf(cls) === -1) {\r\n    classes.push(cls);\r\n    element.className = classes.join(' ');\r\n  }\r\n}\r\n\r\nexport const removeClass = (element, cls) => {\r\n  const classes = element.className.split(' ').filter(p => p && p !== cls);\r\n  element.className = classes.join(' ');\r\n}\r\n\r\nexport const debounce = (fn, delay, immediate) => {\r\n  let timer = null;\r\n  return (...params) => {\r\n    if (timer) {\r\n      clearTimeout(timer);\r\n    }\r\n    if (immediate && !timer) {\r\n      fn.call(this, ...params);\r\n    } else {\r\n      timer = setTimeout(() => {\r\n        timer = null;\r\n        fn.call(this, ...params);\r\n      }, delay);\r\n    }\r\n  }\r\n}\r\n\r\nexport const removeChildAt = (parent, index) => {\r\n  return parent.removeChild(parent.children[index]);\r\n}\r\n\r\nexport const addChildAt = (parent, child, index) => {\r\n  if (index >= parent.children.lenght) {\r\n    parent.appendChild(child);\r\n  } else {\r\n    parent.insertBefore(child, parent.children[index]);\r\n  }\r\n}\r\n\r\nexport const isMobile = () => {\r\n  if (navigator.userAgent.match(/Android/i)\r\n    || navigator.userAgent.match(/webOS/i)\r\n    || navigator.userAgent.match(/iPhone/i)\r\n    || navigator.userAgent.match(/iPad/i)\r\n    || navigator.userAgent.match(/iPod/i)\r\n    || navigator.userAgent.match(/BlackBerry/i)\r\n    || navigator.userAgent.match(/Windows Phone/i)\r\n  ) {\r\n    return true;\r\n  }\r\n  else {\r\n    return false;\r\n  }\r\n}","import { addChildAt, removeChildAt } from './utils';\r\nimport {\r\n\twrapperClass,\r\n\tanimationClass,\r\n\tcontainersInDraggable\r\n} from './constants';\r\n\r\n\r\nexport function domDropHandler({ element, draggables, layout, options }) {\r\n\treturn (dropResult, onDrop) => {\r\n\t\tconst { removedIndex, addedIndex, droppedElement } = dropResult;\r\n\t\tif (removedIndex !== null) {\r\n\t\t\tremoveChildAt(element, removedIndex);\r\n\t\t\tdraggables.splice(removedIndex, 1);\r\n\t\t}\r\n\r\n\t\tif (addedIndex !== null) {\r\n\t\t\tconst wrapper = document.createElement('div');\r\n\t\t\twrapper.className = `${wrapperClass} ${options.orientation} ${animationClass} `;\r\n\t\t\twrapper.appendChild(droppedElement.cloneNode(true));\r\n\t\t\twrapper[containersInDraggable] = [];\r\n\t\t\taddChildAt(element, wrapper, addedIndex);\r\n\t\t\tif (addedIndex >= draggables.length) {\r\n\t\t\t\tdraggables.push(wrapper);\r\n\t\t\t} else {\r\n\t\t\t\tdraggables.splice(addedIndex, 0, wrapper);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (onDrop) {\r\n\t\t\tonDrop(dropResult);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function reactDropHandler() {\r\n\tconst handler = ({ element, draggables, layout, options }) => {\r\n\t\treturn (dropResult, onDrop) => {\r\n\t\t\tif (onDrop) {\r\n\t\t\t\tonDrop(dropResult);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\treturn {\r\n\t\thandler\r\n\t};\r\n}","import * as constants from './constants';\r\n\r\nconst css = {\r\n\t[`.${constants.containerClass}`]: {\r\n\t\t'position': 'relative',\r\n\t},\r\n\t[`.${constants.containerClass} *`]: {\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal`]: {\r\n\t\t'white-space': 'nowrap',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal .${constants.wrapperClass}`]: {\r\n\t\t'height': '100%',\r\n\t\t'display': 'inline-block'\r\n\t},\r\n\t[`.${constants.wrapperClass}`]: {\r\n\t\t'overflow': 'hidden'\r\n\t},\r\n\t[`.${constants.wrapperClass}.animated`]: {\r\n\t\t'transition': 'transform ease'\r\n\t},\r\n\t[`.${constants.ghostClass} *`]: {\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.ghostClass}.animated`]: {\r\n\t\t'transition': 'all ease-out'\r\n\t},\r\n\t[`.${constants.disbaleTouchActions} *`]: {\r\n\t\t'touch-actions': 'none',\r\n\t\t'-ms-touch-actions': 'none'\r\n\t}\r\n};\r\n\r\nfunction convertToCssString(css) {\r\n\treturn Object.entries(css).reduce((styleString, [propName, propValue]) => {\r\n\t\tif (typeof (propValue) === 'object') {\r\n\t\t\treturn `${styleString}${propName}{${convertToCssString(propValue)}}`;\r\n\t\t}\r\n\t\treturn `${styleString}${propName}:${propValue};`;\r\n\t}, '');\r\n}\r\n\r\nfunction addStyleToHead() {\t\r\n\tconst head = document.head || document.getElementsByTagName('head')[0];\r\n\tconst style = document.createElement('style');\r\n\tconst cssString = convertToCssString(css);\r\n\tstyle.type = 'text/css';\r\n\tif (style.styleSheet) {\r\n\t\tstyle.styleSheet.cssText = cssString;\r\n\t} else {\r\n\t\tstyle.appendChild(document.createTextNode(cssString));\r\n\t}\r\n\r\n\thead.appendChild(style);\r\n}\r\n\r\nexport {\r\n\taddStyleToHead\r\n};","import * as Utils from './utils';\r\nimport * as constants from './constants';\r\nimport { addStyleToHead } from './styles';\r\n\r\nconst grabEvents = ['mousedown', 'touchstart'];\r\nconst moveEvents = ['mousemove', 'touchmove'];\r\nconst releaseEvents = ['mouseup', 'touchend'];\r\n\r\nlet dragListeningContainers = null;\r\nlet grabbedElement = null;\r\nlet ghostInfo = null;\r\nlet draggableInfo = null;\r\nlet containers = [];\r\nlet isDragging = false;\r\n\r\n// Utils.addClass(document.body, 'clearfix');\r\n\r\nconst isMobile = Utils.isMobile();\r\n\r\nfunction listenEvents() {\r\n\taddGrabListeners();\r\n}\r\n\r\nfunction addGrabListeners() {\r\n\tgrabEvents.forEach(e => {\r\n\t\twindow.document.addEventListener(e, onMouseDown, {passive: false});\r\n\t});\r\n}\r\n\r\nfunction addMoveListeners() {\r\n\tmoveEvents.forEach(e => {\r\n\t\twindow.document.addEventListener(e, onMouseMove, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction removeMoveListeners() {\r\n\tmoveEvents.forEach(e => {\r\n\t\twindow.document.removeEventListener(e, onMouseMove, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction addReleaseListeners() {\r\n\treleaseEvents.forEach(e => {\r\n\t\twindow.document.addEventListener(e, onMouseUp, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction removeReleaseListeners() {\r\n\treleaseEvents.forEach(e => {\r\n\t\twindow.document.removeEventListener(e, onMouseUp, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction getGhostElement(element, { x, y }, container) {\r\n\tconst { scaleX = 1, scaleY = 1 } = container.getScale();\r\n\tconst { left, top, right, bottom } = element.getBoundingClientRect();\r\n\tif (container.getOptions().dragClass) {\r\n\t\tUtils.addClass(element.childNodes[0], container.getOptions().dragClass);\r\n\t}\r\n\tconst midX = left + ((right - left) / 2);\r\n\tconst midY = top + ((bottom - top) / 2);\r\n\tconst div = document.createElement('div');\r\n\tdiv.style.position = 'fixed';\r\n\tdiv.style.pointerEvents = 'none';\r\n\tdiv.style.left = left + 'px';\r\n\tdiv.style.top = top + 'px';\r\n\tdiv.style.width = right - left + 'px';\r\n\tdiv.style.height = bottom - top + 'px';\r\n\tdiv.style.overflow = 'hidden';\r\n\tdiv.className = constants.ghostClass;\r\n\tconst clone = element.cloneNode(true);\r\n\tclone.style.width = ((right - left) / scaleX) + 'px';\r\n\tclone.style.height = ((bottom - top) / scaleY) + 'px';\r\n\tclone.style.transform = `scale3d(${scaleX || 1}, ${scaleY || 1}, 1)`;\r\n\tclone.style.transformOrigin = '0 0 0';\r\n\tclone.style.margin = '0px';\r\n\tdiv.appendChild(clone);\r\n\r\n\treturn {\r\n\t\tghost: div,\r\n\t\tcenterDelta: { x: midX - x, y: midY - y },\r\n\t\tpositionDelta: { left: left - x, top: top - y },\r\n\t\tclientWidth: right - left,\r\n\t\tclientHeight: bottom - top\r\n\t};\r\n}\r\n\r\nfunction getDraggableInfo(draggableElement) {\r\n\tconst container = containers.filter(p => draggableElement.parentElement === p.element)[0];\r\n\tconst draggableIndex = container.draggables.indexOf(draggableElement);\r\n\treturn {\r\n\t\tcontainer,\r\n\t\telement: draggableElement,\r\n\t\telementIndex: draggableIndex,\r\n\t\tpayload: container.getChildPayload(draggableIndex),\r\n\t\ttargetElement: null,\r\n\t\tposition: { x: 0, y: 0 },\r\n\t\tgroupName: container.groupName\r\n\t};\r\n}\r\n\r\nfunction handleDropAnimation(callback) {\r\n\tfunction endDrop() {\r\n\t\tUtils.removeClass(ghostInfo.ghost, 'animated');\r\n\t\tghostInfo.ghost.style.transitionDuration = null;\r\n\t\tdocument.body.removeChild(ghostInfo.ghost);\r\n\t\tcallback();\r\n\t}\r\n\r\n\tfunction animateGhostToPosition({ top, left }, duration) {\r\n\t\tUtils.addClass(ghostInfo.ghost, 'animated');\r\n\t\tghostInfo.ghost.style.transitionDuration = duration + 'ms';\r\n\t\tghostInfo.ghost.style.left = left + 'px';\r\n\t\tghostInfo.ghost.style.top = top + 'px';\r\n\t\tsetTimeout(function() {\r\n\t\t\tendDrop();\r\n\t\t}, duration + 10);\r\n\t}\r\n\r\n\tif (draggableInfo.targetElement) {\r\n\t\tconst container = containers.filter(p => p.element === draggableInfo.targetElement)[0];\r\n\t\tconst dragResult = container.getDragResult();\r\n\t\tanimateGhostToPosition(dragResult.shadowBeginEnd.rect, Math.max(150, container.getOptions().animationDuration / 2));\r\n\t} else {\r\n\t\tconst container = containers.filter(p => p === draggableInfo.container)[0];\r\n\t\tif (container.getOptions().behaviour === 'move') {\r\n\t\t\tconst { removedIndex, elementSize } = container.getDragResult();\r\n\t\t\tconst layout = container.layout;\r\n\t\t\t// drag ghost to back\r\n\t\t\tcontainer.getTranslateCalculator({\r\n\t\t\t\tdragResult: {\r\n\t\t\t\t\tremovedIndex,\r\n\t\t\t\t\taddedIndex: removedIndex,\r\n\t\t\t\t\telementSize\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst prevDraggableEnd = removedIndex > 0 ? layout.getBeginEnd(container.draggables[removedIndex - 1]).end : layout.getBeginEndOfContainer().begin;\r\n\t\t\tanimateGhostToPosition(layout.getTopLeftOfElementBegin(prevDraggableEnd), container.getOptions().animationDuration);\r\n\t\t} else {\r\n\t\t\tUtils.addClass(ghostInfo.ghost, 'animated');\r\n\t\t\tghostInfo.ghost.style.transitionDuration = container.getOptions().animationDuration + 'ms';\r\n\t\t\tghostInfo.ghost.style.opacity = '0';\r\n\t\t\tghostInfo.ghost.style.transform = 'scale(0.90)';\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tendDrop();\r\n\t\t\t}, container.getOptions().animationDuration);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst handleDragStartConditions = (function handleDragStartConditions() {\r\n\tlet startEvent;\r\n\tlet delay;\r\n\tlet clb;\r\n\tlet timer = null;\r\n\tconst moveThreshold = 1;\r\n\tconst maxMoveInDelay = 8;\r\n\r\n\tfunction onMove(event) {\r\n\t\tconst { clientX: currentX, clientY: currentY } = getPointerEvent(event);\r\n\t\tif (!delay) {\r\n\t\t\tif (Math.abs(startEvent.clientX - currentX) > moveThreshold || Math.abs(startEvent.clientY - currentY) > moveThreshold) {\r\n\t\t\t\treturn callCallback();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (Math.abs(startEvent.clientX - currentX) > maxMoveInDelay || Math.abs(startEvent.clientY - currentY) > maxMoveInDelay) {\r\n\t\t\t\tderegisterEvent();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onUp() { deregisterEvent(); }\r\n\tfunction onHTMLDrag() { deregisterEvent(); }\r\n\r\n\tfunction registerEvents() {\r\n\t\tif (delay) {\r\n\t\t\ttimer = setTimeout(callCallback, delay);\r\n\t\t}\r\n\r\n\t\tmoveEvents.forEach(e => window.document.addEventListener(e, onMove), { passive: false });\r\n\t\treleaseEvents.forEach(e => window.document.addEventListener(e, onUp), { passive: false });\r\n\t\tdocument.addEventListener('drag', onHTMLDrag, { passive: false });\r\n\t}\r\n\r\n\tfunction deregisterEvent() {\r\n\t\tclearTimeout(timer);\r\n\t\tmoveEvents.forEach(e => window.document.removeEventListener(e, onMove), { passive: false });\r\n\t\treleaseEvents.forEach(e => window.document.removeEventListener(e, onUp), { passive: false });\r\n\t\tdocument.removeEventListener('drag', onHTMLDrag, { passive: false });\r\n\t}\r\n\r\n\tfunction callCallback() {\r\n\t\tclearTimeout(timer);\r\n\t\tderegisterEvent();\r\n\t\tclb();\r\n\t}\r\n\r\n\treturn function(_startEvent, _delay, _clb) {\r\n\t\tstartEvent = getPointerEvent(_startEvent);\r\n\t\tdelay = _delay || (isMobile ? 200 : 0);\r\n\t\tclb = _clb;\r\n\r\n\t\tregisterEvents();\r\n\t};\r\n})();\r\n\r\nfunction onMouseDown(event) {\r\n\tconst e = getPointerEvent(event);\r\n\tif (!isDragging) {\r\n\t\tgrabbedElement = Utils.getParent(e.target, '.' + constants.wrapperClass);\r\n\t\tif (grabbedElement) {\r\n\t\t\tconst containerElement = Utils.getParent(grabbedElement, '.' + constants.containerClass);\r\n\t\t\tconst container = containers.filter(p => p.element === containerElement)[0];\r\n\t\t\tconst dragHandleSelector = container.getOptions().dragHandleSelector;\r\n\t\t\tconst nonDragAreaSelector = container.getOptions().nonDragAreaSelector;\r\n\r\n\t\t\tlet startDrag = true;\r\n\t\t\tif (dragHandleSelector && !Utils.getParent(e.target, dragHandleSelector)) {\r\n\t\t\t\tstartDrag = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (nonDragAreaSelector && Utils.getParent(e.target, nonDragAreaSelector)) {\r\n\t\t\t\tstartDrag = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (startDrag) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\thandleDragStartConditions(e, container.getOptions().dragBeginDelay, () => {\t\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\twindow.getSelection().empty();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t\taddMoveListeners();\r\n\t\t\t\t\taddReleaseListeners();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction onMouseUp() {\r\n\tremoveMoveListeners();\r\n\tremoveReleaseListeners();\r\n\tif (draggableInfo) {\r\n\t\thandleDropAnimation(() => {\r\n\t\t\tdocument.body.style.touchAction = null;\r\n\t\t\t(dragListeningContainers || []).forEach(p => {\r\n\t\t\t\tUtils.removeClass(p.element, constants.noUserSelectClass);\r\n\t\t\t\tp.handleDrop(draggableInfo);\r\n\t\t\t});\r\n\r\n\t\t\tdragListeningContainers = null;\r\n\t\t\tgrabbedElement = null;\r\n\t\t\tghostInfo = null;\r\n\t\t\tdraggableInfo = null;\r\n\t\t\tisDragging = false;\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction getPointerEvent(e) {\r\n\treturn e.touches ? e.touches[0] : e;\t\r\n}\r\n\r\nfunction onMouseMove(event) {\r\n\tevent.preventDefault();\r\n\tconst e = getPointerEvent(event);\r\n\tif (!draggableInfo) {\r\n\t\tisDragging = true;\r\n\t\tconst container = containers.filter(p => grabbedElement.parentElement === p.element)[0];\r\n\t\tdragListeningContainers = containers.filter(p => p.isDragRelevant(container));\r\n\t\tdragListeningContainers.forEach(p => Utils.addClass(p.element, constants.noUserSelectClass));\r\n\t\tdragListeningContainers.forEach(p => p.prepareDrag(p, dragListeningContainers));\r\n\r\n\t\t// first move after grabbing  draggable\r\n\t\tdraggableInfo = getDraggableInfo(grabbedElement);\r\n\t\tghostInfo = getGhostElement(grabbedElement, { x: e.clientX, y: e.clientY }, draggableInfo.container);\r\n\t\tdraggableInfo.position = {\r\n\t\t\tx: e.clientX + ghostInfo.centerDelta.x,\r\n\t\t\ty: e.clientY + ghostInfo.centerDelta.y\r\n\t\t};\r\n\r\n\t\tdocument.body.appendChild(ghostInfo.ghost);\r\n\t} else {\r\n\t\t// just update ghost position && draggableInfo position\r\n\t\tghostInfo.ghost.style.left = `${e.clientX + ghostInfo.positionDelta.left}px`;\r\n\t\tghostInfo.ghost.style.top = `${e.clientY + ghostInfo.positionDelta.top}px`;\r\n\t\tdraggableInfo.position.x = e.clientX + ghostInfo.centerDelta.x;\r\n\t\tdraggableInfo.position.y = e.clientY + ghostInfo.centerDelta.y;\r\n\t\tdraggableInfo.clientWidth = ghostInfo.clientWidth;\r\n\t\tdraggableInfo.clientHeight = ghostInfo.clientHeight;\r\n\t}\r\n\r\n\tdragListeningContainers.forEach(p => p.handleDrag(draggableInfo));\r\n}\r\n\r\nfunction Mediator() {\r\n\tlistenEvents();\r\n\treturn {\r\n\t\tregister: function(container) {\r\n\t\t\tcontainers.push(container);\r\n\t\t},\r\n\t\tunregister: function(container) {\r\n\t\t\tcontainers.splice(containers.indexOf(container), 1);\r\n\t\t}\r\n\t};\r\n}\r\n\r\naddStyleToHead();\r\n\r\nexport default Mediator();\r\n\r\n\r\n\r\n","import * as Utils from './utils';\r\nimport { translationValue, visibilityValue, extraSizeForInsertion, containersInDraggable } from './constants';\r\n\r\n\r\n\r\nconst horizontalMap = {\r\n\tsize: 'offsetWidth',\r\n\tdistanceToParent: 'offsetLeft',\r\n\ttranslate: 'transform',\r\n\tbegin: 'left',\r\n\tend: 'right',\r\n\tdragPosition: 'x',\r\n\tscrollSize: 'scrollWidth',\r\n\toffsetSize: 'offsetWidth',\r\n\tscrollValue: 'scrollLeft',\r\n\tscale: 'scaleX',\r\n\tsetSize: 'width',\r\n\tsetters: {\r\n\t\t'translate': (val) => `translate3d(${val}px, 0, 0)`\r\n\t}\r\n};\r\n\r\nconst verticalMap = {\r\n\tsize: 'offsetHeight',\r\n\tdistanceToParent: 'offsetTop',\r\n\ttranslate: 'transform',\r\n\tbegin: 'top',\r\n\tend: 'bottom',\r\n\tdragPosition: 'y',\r\n\tscrollSize: 'scrollHeight',\r\n\toffsetSize: 'offsetHeight',\r\n\tscrollValue: 'scrollTop',\r\n\tscale: 'scaleY',\r\n\tsetSize: 'height',\r\n\tsetters: {\r\n\t\t'translate': (val) => `translate3d(0,${val}px, 0)`\r\n\t}\r\n};\r\n\r\nfunction orientationDependentProps(map) {\r\n\tfunction get(obj, prop) {\r\n\t\tconst mappedProp = map[prop];\r\n\t\treturn obj[mappedProp || prop];\r\n\t}\r\n\r\n\tfunction set(obj, prop, value) {\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tobj[map[prop]] = map.setters[prop] ? map.setters[prop](value) : value;\r\n\t\t});\r\n\t}\r\n\r\n\treturn { get, set };\r\n}\r\n\r\nexport default function layoutManager(containerElement, orientation, _animationDuration) {\r\n\tcontainerElement[extraSizeForInsertion] = 0;\r\n\tconst animationDuration = _animationDuration;\r\n\tconst map = orientation === 'horizontal' ? horizontalMap : verticalMap;\r\n\tconst propMapper = orientationDependentProps(map);\r\n\tconst values = {\r\n\t\ttranslation: 0\r\n\t};\r\n\tlet registeredScrollListener = null;\r\n\r\n\twindow.addEventListener('resize', function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\t// invalidateContainerScale(containerElement);\r\n\t});\r\n\r\n\tsetTimeout(() => {\r\n\t\tinvalidate();\r\n\t}, 10);\r\n\t// invalidate();\r\n\r\n\tconst scrollListener = Utils.listenScrollParent(containerElement, function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tregisteredScrollListener && registeredScrollListener();\r\n\t});\r\n\tfunction invalidate() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tinvalidateContainerScale(containerElement);\r\n\t}\r\n\r\n\tlet visibleRect;\r\n\tfunction invalidateContainerRectangles(containerElement) {\r\n\t\tvalues.rect = Utils.getContainerRect(containerElement);\r\n\t\tvalues.visibleRect = Utils.getVisibleRect(containerElement, values.rect);\r\n\r\n\t\t// if (visibleRect) {\r\n\t\t//   visibleRect.parentNode.removeChild(visibleRect);\r\n\t\t// }\r\n\t\t// visibleRect = document.createElement('div');\r\n\t\t// visibleRect.style.position = 'fixed';\r\n\t\t// visibleRect.style.border = '1px solid red';\r\n\t\t// visibleRect.style.top = values.visibleRect.top + 'px';\r\n\t\t// visibleRect.style.left = values.visibleRect.left + 'px';\r\n\t\t// visibleRect.style.width = values.visibleRect.right - values.visibleRect.left + 'px';\r\n\t\t// visibleRect.style.height = values.visibleRect.bottom - values.visibleRect.top + 'px';\r\n\t\t// document.body.appendChild(visibleRect);\r\n\r\n\t}\r\n\r\n\tfunction invalidateContainerScale(containerElement) {\r\n\t\tconst rect = containerElement.getBoundingClientRect();\r\n\t\tvalues.scaleX = (rect.right - rect.left) / containerElement.offsetWidth;\r\n\t\tvalues.scaleY = (rect.bottom - rect.top) / containerElement.offsetHeight;\r\n\t}\r\n\r\n\tfunction getContainerRectangles() {\r\n\t\treturn {\r\n\t\t\trect: values.rect,\r\n\t\t\tvisibleRect: values.visibleRect\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfDOMRect(rect) {\r\n\t\treturn {\r\n\t\t\tbegin: propMapper.get(rect, 'begin'),\r\n\t\t\tend: propMapper.get(rect, 'end')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainer() {\r\n\t\tconst begin = propMapper.get(values.rect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.rect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainerVisibleRect() {\r\n\t\tconst begin = propMapper.get(values.visibleRect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.visibleRect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getContainerScale() {\r\n\t\treturn { scaleX: values.scaleX, scaleY: values.scaleY };\r\n\t}\r\n\r\n\tfunction getSize(element) {\r\n\t\treturn propMapper.get(element, 'size') * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getDistanceToOffsetParent(element) {\r\n\t\tconst distance = propMapper.get(element, 'distanceToParent') + (element[translationValue] || 0);\r\n\t\treturn distance * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getBeginEnd(element) {\r\n\t\tconst begin = getDistanceToOffsetParent(element) + (propMapper.get(values.rect, 'begin') + values.translation) - propMapper.get(containerElement, 'scrollValue');\r\n\t\treturn {\r\n\t\t\tbegin,\r\n\t\t\tend: begin + getSize(element) * propMapper.get(values, 'scale')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction setSize(element, size) {\r\n\t\tpropMapper.set(element, 'setSize', size);\r\n\t}\r\n\r\n\tfunction getAxisValue(position) {\r\n\t\treturn propMapper.get(position, 'dragPosition');\r\n\t}\r\n\r\n\tfunction updateDescendantContainerRects(container) {\r\n\t\tcontainer.layout.invalidateRects();\r\n\t\tcontainer.onTranslated();\r\n\t\tif (container.getChildContainers()) {\r\n\t\t\tcontainer.getChildContainers().forEach(p => updateDescendantContainerRects(p));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setTranslation(element, translation) {\r\n\t\tif (getTranslation(element) !== translation) {\r\n\t\t\tpropMapper.set(element.style, 'translate', translation);\r\n\t\t\telement[translationValue] = translation;\r\n\r\n\t\t\tif (element[containersInDraggable]) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\telement[containersInDraggable].forEach(p => {\r\n\t\t\t\t\t\tupdateDescendantContainerRects(p);\r\n\t\t\t\t\t});\r\n\t\t\t\t}, animationDuration + 20);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getTranslation(element) {\r\n\t\treturn element[translationValue];\r\n\t}\r\n\r\n\tfunction setVisibility(element, isVisible) {\r\n\t\tif (element[visibilityValue] === undefined || element[visibilityValue] !== isVisible) {\r\n\t\t\telement.style.visibility = isVisible ? 'inherit' : 'hidden';\r\n\t\t\telement[visibilityValue] = isVisible;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isVisible(element) {\r\n\t\treturn element[visibilityValue] === undefined || element[visibilityValue];\r\n\t}\r\n\r\n\tfunction isInVisibleRect(x, y) {\r\n\t\tconst { left, top, right, bottom } = values.visibleRect;\r\n\t\tif (orientation === 'vertical') {\r\n\t\t\treturn x > left && x < right && y > top && y < bottom;\r\n\t\t} else {\r\n\t\t\treturn x > left && x < right  && y > top && y < bottom;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setScrollListener(callback) {\r\n\t\tregisteredScrollListener = callback;\r\n\t}\r\n\r\n\tfunction getTopLeftOfElementBegin(begin) {\r\n\t\tlet top = 0;\r\n\t\tlet left = 0;\r\n\t\tif (orientation === 'horizontal') {\r\n\t\t\tleft = begin;\r\n\t\t\ttop = values.rect.top;\r\n\t\t} else {\r\n\t\t\tleft = values.rect.left;\r\n\t\t\ttop = begin;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttop, left\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getScrollSize(element) {\r\n\t\treturn propMapper.get(element, 'scrollSize');\r\n\t}\r\n\r\n\tfunction getScrollValue(element) {\r\n\t\treturn propMapper.get(element, 'scrollValue');\r\n\t}\r\n\r\n\tfunction setScrollValue(element, val) {\r\n\t\treturn propMapper.set(element, 'scrollValue', val);\r\n\t}\r\n\r\n\tfunction dispose() {\r\n\t\tif (scrollListener) {\r\n\t\t\tscrollListener.dispose();\r\n\t\t}\r\n\r\n\t\tif (visibleRect) {\r\n\t\t\tvisibleRect.parentNode.removeChild(visibleRect);\r\n\t\t\tvisibleRect = null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getPosition(position) {\r\n\t\treturn isInVisibleRect(position.x, position.y) ? getAxisValue(position) : null;\r\n\t}\r\n\r\n\tfunction invalidateRects() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetSize,\r\n\t\t//getDistanceToContainerBegining,\r\n\t\tgetContainerRectangles,\r\n\t\tgetBeginEndOfDOMRect,\r\n\t\tgetBeginEndOfContainer,\r\n\t\tgetBeginEndOfContainerVisibleRect,\r\n\t\tgetBeginEnd,\r\n\t\tgetAxisValue,\r\n\t\tsetTranslation,\r\n\t\tgetTranslation,\r\n\t\tsetVisibility,\r\n\t\tisVisible,\r\n\t\tisInVisibleRect,\r\n\t\tdispose,\r\n\t\tgetContainerScale,\r\n\t\tsetScrollListener,\r\n\t\tsetSize,\r\n\t\tgetTopLeftOfElementBegin,\r\n\t\tgetScrollSize,\r\n\t\tgetScrollValue,\r\n\t\tsetScrollValue,\r\n\t\tinvalidate,\r\n\t\tinvalidateRects,\r\n\t\tgetPosition,\r\n\t};\r\n}","import { isScrolling } from './utils';\r\n\r\nconst maxSpeed = 1500; // px/s\r\nconst minSpeed = 20; // px/s\r\n\r\nfunction getScrollableParent(element, axis) {\r\n\tlet current = element;\r\n\twhile (current) {\r\n\t\tif (isScrolling(current)) {\r\n\t\t\treturn current;\r\n\t\t}\r\n\t\tcurrent = current.parentElement;\r\n\t}\r\n}\r\n\r\nfunction requestFrame(element, layout) {\r\n\tlet isAnimating = false;\r\n\tlet request = null;\r\n\tlet startTime = null;\r\n\tlet direction = null;\r\n\tlet speed = null;\r\n\r\n\tfunction animate(_direction, _speed) {\r\n\t\tdirection = _direction;\r\n\t\tspeed = _speed;\r\n\t\tisAnimating = true;\r\n\t\tif (isAnimating) {\r\n\t\t\tstart();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction start() {\r\n\t\tif (request === null) {\r\n\t\t\trequest = requestAnimationFrame((timestamp) => {\r\n\t\t\t\tif (startTime === null) { startTime = timestamp; }\r\n\t\t\t\tconst timeDiff = timestamp - startTime;\r\n\t\t\t\tstartTime = timestamp;\r\n\t\t\t\tlet distanceDiff = (timeDiff / 1000) * speed;\r\n\t\t\t\tdistanceDiff = direction === 'begin' ? (0 - distanceDiff) : distanceDiff;\r\n\t\t\t\tconst scrollTo = layout.getScrollValue(element) + distanceDiff;\r\n\t\t\t\tlayout.setScrollValue(element, scrollTo);\r\n\t\t\t\t// console.log(scrollTo);\r\n\t\t\t\trequest = null;\r\n\t\t\t\tstart();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction stop() {\r\n\t\tif (isAnimating) {\r\n\t\t\tcancelAnimationFrame(request);\r\n\t\t\tisAnimating = false;\r\n\t\t\tstartTime = null;\r\n\t\t\trequest = null;\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tanimate,\r\n\t\tstop\r\n\t};\r\n}\r\n\r\n\r\nfunction getAutoScrollInfo(pos, elementSize, scrollableBeginEnd) {\r\n\tconst { begin, end } = scrollableBeginEnd;\r\n\tconst moveDistance = 100;\r\n\tif (end - pos < moveDistance) {\r\n\t\treturn {\r\n\t\t\tdirection: 'end',\r\n\t\t\tspeedFactor: (moveDistance - (end - pos)) / moveDistance\r\n\t\t};\r\n\t} else if (pos - begin < moveDistance) {\r\n\t\t// console.log(pos - begin);\r\n\t\treturn {\r\n\t\t\tdirection: 'begin',\r\n\t\t\tspeedFactor: (moveDistance - (pos - begin)) / moveDistance\r\n\t\t};\r\n\t}\r\n}\r\n\r\n\r\nexport default ({ element, layout, options }) => {\r\n\tlet lastPos = null;\r\n\tconst axis = options.orientation === 'vertical' ? 'Y' : 'X';\r\n\tlet scrollableParent = getScrollableParent(element, axis);\r\n\tconst scrollParentBeginEnd = scrollableParent ? layout.getBeginEndOfDOMRect(scrollableParent.getBoundingClientRect()) : null;\r\n\tlet animator = requestFrame(element, layout);\r\n\treturn ({ draggableInfo, dragResult, reset }) => {\r\n\t\tif (scrollableParent) {\r\n\t\t\tif (reset) {\r\n\t\t\t\tanimator.stop();\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (dragResult.pos !== null) {\r\n\t\t\t\tif (lastPos === null) {\r\n\t\t\t\t\tscrollableParent = getScrollableParent(element, axis);\r\n\t\t\t\t\tanimator.stop();\r\n\t\t\t\t\tanimator = requestFrame(scrollableParent, layout);\r\n\t\t\t\t}\r\n\t\t\t\tconst autoScrollInfo = getAutoScrollInfo(dragResult.pos, dragResult.elementSize, scrollParentBeginEnd);\r\n\t\t\t\tif (autoScrollInfo) {\r\n\t\t\t\t\tanimator.animate(autoScrollInfo.direction, autoScrollInfo.speedFactor * maxSpeed);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tanimator.stop();\r\n\t\t\t\t}\r\n\t\t\t\tlastPos = dragResult.pos;\r\n\t\t\t} else {\r\n\t\t\t\tanimator.stop();\r\n\t\t\t}\r\n\r\n\t\t\tlastPos = dragResult.pos;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n};","import { hasClass, addClass, removeClass, getParent } from './utils';\r\nimport { domDropHandler } from './dropHandlers';\r\nimport dragscroller from './dragscroller';\r\nimport {\r\n\tdefaultGroupName,\r\n\twrapperClass,\r\n\tanimationClass,\r\n\tstretcherElementClass,\r\n\tstretcherElementInstance,\r\n\ttranslationValue,\r\n\tcontainerClass,\r\n\tcontainerInstance,\r\n\tcontainersInDraggable\r\n} from './constants';\r\nimport layoutManager from './layoutManager';\r\nimport Mediator from './mediator';\r\n// import './container.css';\r\n\r\nconst defaultOptions = {\r\n\tgroupName: null,\r\n\tbehaviour: 'move', // move | copy\r\n\tacceptGroups: [defaultGroupName],\r\n\torientation: 'vertical', // vertical | horizontal\r\n\tgetChildPayload: () => { return undefined; },\r\n\tanimationDuration: 180\r\n};\r\n\r\nfunction setAnimation(element, add, animationDuration) {\r\n\tif (add) {\r\n\t\taddClass(element, animationClass);\r\n\t\telement.style.transitionDuration = animationDuration + 'ms';\r\n\t} else {\r\n\t\tremoveClass(element, animationClass);\r\n\t\telement.style.transitionDuration = null;\r\n\t}\r\n}\r\n\r\nfunction getContainer(element) {\r\n\treturn element ? element[containerInstance] : null;\r\n}\r\n\r\nfunction initOptions(props = defaultOptions) {\r\n\tconst result = Object.assign({}, defaultOptions, props);\r\n\tif (result.groupName && !props.acceptGroups) {\r\n\t\tresult.acceptGroups = [props.groupName];\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction isDragRelevant({ element, options }) {\r\n\treturn function(sourceContainer) {\r\n\t\tconst sourceOptions = sourceContainer.getOptions();\r\n\t\tif (options.behaviour === 'copy') return false;\r\n\r\n\t\tconst parentWrapper = getParent(element, '.' + wrapperClass);\r\n\t\tif (parentWrapper === sourceContainer.element) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (sourceContainer.element === element) return true;\r\n\t\tif (sourceOptions.groupName && sourceOptions.groupName === options.groupName) return true;\r\n\t\tif (options.acceptGroups.indexOf(sourceOptions.groupName) > -1) return true;\r\n\r\n\t\treturn false;\r\n\t};\r\n}\r\n\r\nfunction wrapChild(child, orientation) {\r\n\tconst div = document.createElement('div');\r\n\tdiv.className = `${wrapperClass} ${orientation} ${animationClass}`;\r\n\tchild.parentElement.insertBefore(div, child);\r\n\tdiv.appendChild(child);\r\n\treturn div;\r\n}\r\n\r\nfunction wrapChildren(element, orientation, animationDuration) {\r\n\tconst draggables = Array.prototype.map.call(element.children, child => {\r\n\t\tlet wrapper = child;\r\n\t\tif (!hasClass(child, wrapperClass)) {\r\n\t\t\twrapper = wrapChild(child, orientation, animationDuration);\r\n\t\t}\r\n\r\n\t\twrapper.style.transitionDuration = animationDuration + 'ms';\r\n\t\twrapper[containersInDraggable] = [];\r\n\t\twrapper[translationValue] = 0;\r\n\t\treturn wrapper;\r\n\t});\r\n\treturn draggables;\r\n}\r\n\r\nfunction findDraggebleAtPos({ layout }) {\r\n\tconst find = (draggables, pos, startIndex, endIndex, withRespectToMiddlePoints = false) => {\r\n\t\tif (endIndex < startIndex) {\r\n\t\t\treturn startIndex;\r\n\t\t}\r\n\t\t// binary serach draggable\r\n\t\tif (startIndex === endIndex) {\r\n\t\t\tlet { begin, end } = layout.getBeginEnd(draggables[startIndex]);\r\n\t\t\t// mouse pos is inside draggable\r\n\t\t\t// now decide which index to return\r\n\t\t\tif (pos > begin && pos <= end) {\r\n\t\t\t\tif (withRespectToMiddlePoints) {\r\n\t\t\t\t\treturn (pos < ((end + begin) / 2)) ? startIndex : startIndex + 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn startIndex;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst middleIndex = Math.floor((endIndex + startIndex) / 2);\r\n\t\t\tconst { begin, end } = layout.getBeginEnd(draggables[middleIndex]);\r\n\t\t\tif (pos < begin) {\r\n\t\t\t\treturn find(draggables, pos, startIndex, middleIndex - 1, withRespectToMiddlePoints);\r\n\t\t\t} else if (pos > end) {\r\n\t\t\t\treturn find(draggables, pos, middleIndex + 1, endIndex, withRespectToMiddlePoints);\r\n\t\t\t} else {\r\n\t\t\t\tif (withRespectToMiddlePoints) {\r\n\t\t\t\t\treturn (pos < ((end + begin) / 2)) ? middleIndex : middleIndex + 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn middleIndex;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn (draggables, pos, withRespectToMiddlePoints = false) => {\r\n\t\treturn find(draggables, pos, 0, draggables.length - 1, withRespectToMiddlePoints);\r\n\t};\r\n}\r\n\r\nfunction resetDraggables({ element, draggables, layout, options }) {\r\n\treturn function() {\r\n\t\tdraggables.forEach(p => {\r\n\t\t\tsetAnimation(p, false);\r\n\t\t\tlayout.setTranslation(p, 0);\r\n\t\t\tlayout.setVisibility(p, true);\r\n\t\t\tp[containersInDraggable] = [];\r\n\t\t});\r\n\r\n\t\tif (element[stretcherElementInstance]) {\r\n\t\t\telement[stretcherElementInstance].parentNode.removeChild(element[stretcherElementInstance]);\r\n\t\t\telement[stretcherElementInstance] = null;\r\n\t\t}\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tdraggables.forEach(p => {\r\n\t\t\t\tsetAnimation(p, true, options.animationDuration);\r\n\t\t\t});\r\n\t\t}, 50);\r\n\t};\r\n}\r\n\r\nfunction setTargetContainer(draggableInfo, element, set = true) {\r\n\tif (element && set) {\r\n\t\tdraggableInfo.targetElement = element;\r\n\t} else {\r\n\t\tif (draggableInfo.targetElement === element) {\r\n\t\t\tdraggableInfo.targetElement = null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction handleDrop({ element, draggables, layout, options }) {\r\n\tconst draggablesReset = resetDraggables({ element, draggables, layout, options });\r\n\tconst dropHandler = (options.dropHandler || domDropHandler)(({ element, draggables, layout, options }));\r\n\treturn function(draggableInfo, { addedIndex, removedIndex }) {\r\n\t\tdraggablesReset();\r\n\t\t// if drop zone is valid => complete drag else do nothing everything will be reverted by draggablesReset()\r\n\t\tif (draggableInfo.targetElement) {\r\n\t\t\tlet actualAddIndex = addedIndex !== null ? ((removedIndex !== null && removedIndex < addedIndex) ? addedIndex - 1 : addedIndex) : null;\r\n\t\t\tconst dropHandlerParams = {\r\n\t\t\t\tremovedIndex,\r\n\t\t\t\taddedIndex: actualAddIndex,\r\n\t\t\t\tpayload: draggableInfo.payload,\r\n\t\t\t\tdroppedElement: draggableInfo.element.firstChild\r\n\t\t\t};\r\n\t\t\tdropHandler(dropHandlerParams, options.onDrop);\r\n\t\t\tconsole.log(removedIndex, actualAddIndex, draggableInfo.payload, draggableInfo.element.firstChild);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getContainerProps(element, initialOptions) {\r\n\tconst options = initOptions(initialOptions);\r\n\tconst draggables = wrapChildren(element, options.orientation, options.animationDuration);\r\n\t// set flex classes before layout is inited for scroll listener\r\n\taddClass(element, `${containerClass} ${options.orientation}`);\r\n\tconst layout = layoutManager(element, options.orientation, options.animationDuration);\r\n\treturn {\r\n\t\telement,\r\n\t\tdraggables,\r\n\t\toptions,\r\n\t\tlayout\r\n\t};\r\n}\r\n\r\nfunction getRelaventParentContainer(container, relevantContainers) {\r\n\tlet current = container.element;\r\n\twhile (current) {\r\n\t\tconst containerOfParentElement = getContainer(current.parentElement);\r\n\t\tif (containerOfParentElement && relevantContainers.indexOf(containerOfParentElement) > -1) {\r\n\t\t\treturn {\r\n\t\t\t\tcontainer: containerOfParentElement,\r\n\t\t\t\tdraggable: current\r\n\t\t\t};\r\n\t\t}\r\n\t\tcurrent = current.parentElement;\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\nfunction registerToParentContainer(container, relevantContainers) {\r\n\tconst parentInfo = getRelaventParentContainer(container, relevantContainers);\r\n\tif (parentInfo) {\r\n\t\tparentInfo.container.getChildContainers().push(container);\r\n\t\tcontainer.setParentContainer(parentInfo.container);\r\n\t\t//current should be draggable\r\n\t\tparentInfo.draggable[containersInDraggable].push(container);\r\n\t}\r\n}\r\n\r\nfunction getRemovedItem({ draggables, element, options }) {\r\n\tlet prevRemovedIndex = null;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tlet removedIndex = prevRemovedIndex;\r\n\t\tif (prevRemovedIndex == null && draggableInfo.container.element === element && options.behaviour === 'move') {\r\n\t\t\tremovedIndex = prevRemovedIndex = draggableInfo.elementIndex;\r\n\t\t}\r\n\r\n\t\treturn { removedIndex };\r\n\t};\r\n}\r\n\r\nfunction setRemovedItemVisibilty({ draggables, layout }) {\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (dragResult.removedIndex !== null) {\r\n\t\t\tlayout.setVisibility(draggables[dragResult.removedIndex], false);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getPosition({ element, layout }) {\r\n\treturn ({ draggableInfo }) => {\r\n\t\treturn {\r\n\t\t\tpos: !getContainer(element).isPosInChildContainer() ? layout.getPosition(draggableInfo.position) : null\r\n\t\t};\r\n\t};\r\n}\r\n\r\nfunction notifyParentOnPositionCapture({ element }) {\r\n\tlet isCaptured = false;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (getContainer(element).getParentContainer() && isCaptured !== (dragResult.pos !== null)) {\r\n\t\t\tisCaptured = dragResult.pos !== null;\r\n\t\t\tgetContainer(element).getParentContainer().onChildPositionCaptured(isCaptured);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getElementSize({ layout }) {\r\n\tlet elementSize = null;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (dragResult.pos === null) {\r\n\t\t\treturn elementSize = null;\r\n\t\t} else {\r\n\t\t\telementSize = elementSize || layout.getSize(draggableInfo.element);\r\n\t\t}\r\n\t\treturn { elementSize };\r\n\t};\r\n}\r\n\r\nfunction handleTargetContainer({ element }) {\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tsetTargetContainer(draggableInfo, element, !!dragResult.pos);\r\n\t};\r\n}\r\n\r\nfunction getDragInsertionIndex({ draggables, layout }) {\r\n\tconst findDraggable = findDraggebleAtPos({ layout });\r\n\treturn ({ dragResult: { shadowBeginEnd, pos } }) => {\r\n\t\tif (!shadowBeginEnd) {\r\n\t\t\tconst index = findDraggable(draggables, pos, true);\r\n\t\t\treturn index !== null ? index : draggables.length;\r\n\t\t} else {\r\n\t\t\tif (shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment <= pos && shadowBeginEnd.end >= pos) {\r\n\t\t\t\t// position inside ghost\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (pos < shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment) {\r\n\t\t\treturn findDraggable(draggables, pos);\r\n\t\t} else if (pos > shadowBeginEnd.end) {\r\n\t\t\treturn findDraggable(draggables, pos) + 1;\r\n\t\t} else {\r\n\t\t\treturn draggables.length;\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction invalidateShadowBeginEndIfNeeded(params) {\r\n\tconst shadowBoundsGetter = getShadowBeginEnd(params);\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (draggableInfo.invalidateShadow) {\r\n\t\t\treturn shadowBoundsGetter({ draggableInfo, dragResult });\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n}\r\n\r\nfunction getNextAddedIndex(params) {\r\n\tconst getIndexForPos = getDragInsertionIndex(params);\r\n\treturn ({ dragResult }) => {\r\n\t\tlet index = null;\r\n\t\tif (dragResult.pos !== null) {\r\n\t\t\tindex = getIndexForPos({ dragResult });\r\n\t\t\tif (index === null) {\r\n\t\t\t\tindex = dragResult.addedIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {\r\n\t\t\taddedIndex: index\r\n\t\t};\r\n\t};\r\n}\r\n\r\nfunction resetShadowAdjustment() {\r\n\tlet lastAddedIndex = null;\r\n\treturn ({ dragResult: { addedIndex, shadowBeginEnd } }) => {\r\n\t\tif (addedIndex !== lastAddedIndex && lastAddedIndex !== null && shadowBeginEnd) {\r\n\t\t\tshadowBeginEnd.beginAdjustment = 0;\r\n\t\t}\r\n\t\tlastAddedIndex = addedIndex;\r\n\t};\r\n}\r\n\r\nfunction handleInsertionSizeChange({ element, draggables, layout, options }) {\r\n\tlet strectherElement = null;\r\n\tlet stretcherElementAdded = false;\r\n\r\n\treturn function({ dragResult: { addedIndex, removedIndex, elementSize } }) {\r\n\t\tif (removedIndex === null) {\r\n\t\t\tif (addedIndex !== null) {\r\n\t\t\t\tif (!stretcherElementAdded) {\r\n\t\t\t\t\tconst containerBeginEnd = layout.getBeginEndOfContainer();\r\n\t\t\t\t\tconst hasScrollBar = layout.getScrollSize(element) > layout.getSize(element);\r\n\t\t\t\t\tconst containerEnd = hasScrollBar ? (containerBeginEnd.begin + layout.getScrollSize(element) - layout.getScrollValue(element)) : containerBeginEnd.end;\r\n\t\t\t\t\tconst lastDraggableEnd = layout.getBeginEnd(draggables[draggables.length - 1]).end - draggables[draggables.length - 1][translationValue];\r\n\t\t\t\t\tif (lastDraggableEnd + elementSize > containerEnd) {\r\n\t\t\t\t\t\tstrectherElement = document.createElement('div');\r\n\t\t\t\t\t\tstrectherElement.className = stretcherElementClass + ' ' + options.orientation;\r\n\t\t\t\t\t\tconst stretcherSize = (elementSize + lastDraggableEnd) - containerEnd;\r\n\t\t\t\t\t\tlayout.setSize(strectherElement.style, `${stretcherSize}px`);\r\n\t\t\t\t\t\telement.appendChild(strectherElement);\r\n\t\t\t\t\t\telement[stretcherElementInstance] = strectherElement;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstretcherElementAdded = true;\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tlayout.invalidateRects();\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (strectherElement) {\r\n\t\t\t\t\tlayout.setTranslation(strectherElement, 0);\r\n\t\t\t\t\tlet toRemove = strectherElement;\r\n\t\t\t\t\tstrectherElement = null;\r\n\t\t\t\t\telement.removeChild(toRemove);\r\n\t\t\t\t\telement[stretcherElementInstance] = null;\r\n\t\t\t\t}\r\n\t\t\t\tstretcherElementAdded = false;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tlayout.invalidateRects();\r\n\t\t\t\t}, 100);\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction calculateTranslations({ element, draggables, layout }) {\r\n\tlet prevAddedIndex = null;\r\n\tlet prevRemovedIndex = null;\r\n\treturn function({ dragResult: { addedIndex, removedIndex, elementSize } }) {\r\n\t\tif (addedIndex !== prevAddedIndex || removedIndex !== prevRemovedIndex) {\r\n\t\t\tfor (let index = 0; index < draggables.length; index++) {\r\n\t\t\t\tif (index !== removedIndex) {\r\n\t\t\t\t\tconst draggable = draggables[index];\r\n\t\t\t\t\tlet translate = 0;\r\n\t\t\t\t\tif (removedIndex !== null && removedIndex < index) {\r\n\t\t\t\t\t\ttranslate -= layout.getSize(draggables[removedIndex]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (addedIndex !== null && addedIndex <= index) {\r\n\t\t\t\t\t\ttranslate += elementSize;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlayout.setTranslation(draggable, translate);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprevAddedIndex = addedIndex;\r\n\t\t\tprevRemovedIndex = removedIndex;\r\n\r\n\t\t\treturn { addedIndex, removedIndex };\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getShadowBeginEnd({ draggables, layout }) {\r\n\tlet prevAddedIndex = null;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tconst { addedIndex, removedIndex, elementSize, pos, shadowBeginEnd } = dragResult;\r\n\t\tif (pos !== null) {\r\n\t\t\tif (addedIndex !== null && (draggableInfo.invalidateShadow || addedIndex !== prevAddedIndex)) {\r\n\t\t\t\tif (prevAddedIndex)\r\n\t\t\t\t\tprevAddedIndex = addedIndex;\r\n\t\t\t\tlet beforeIndex = addedIndex - 1;\r\n\t\t\t\tlet begin = 0;\r\n\t\t\t\tlet afterBounds = null;\r\n\t\t\t\tlet beforeBounds = null;\r\n\t\t\t\tif (beforeIndex === removedIndex) {\r\n\t\t\t\t\tbeforeIndex--;\r\n\t\t\t\t}\r\n\t\t\t\tif (beforeIndex > -1) {\r\n\t\t\t\t\tconst beforeSize = layout.getSize(draggables[beforeIndex]);\r\n\t\t\t\t\tbeforeBounds = layout.getBeginEnd(draggables[beforeIndex]);\r\n\t\t\t\t\tif (elementSize < beforeSize) {\r\n\t\t\t\t\t\tconst threshold = (beforeSize - elementSize) / 2;\r\n\t\t\t\t\t\tbegin = beforeBounds.end - threshold;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbegin = beforeBounds.end;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbeforeBounds = { end: layout.getBeginEndOfContainer().begin };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet end = 10000;\r\n\t\t\t\tlet afterIndex = addedIndex;\r\n\t\t\t\tif (afterIndex === removedIndex) {\r\n\t\t\t\t\tafterIndex++;\r\n\t\t\t\t}\r\n\t\t\t\tif (afterIndex < draggables.length) {\r\n\t\t\t\t\tconst afterSize = layout.getSize(draggables[afterIndex]);\r\n\t\t\t\t\tafterBounds = layout.getBeginEnd(draggables[afterIndex]);\r\n\r\n\t\t\t\t\tif (elementSize < afterSize) {\r\n\t\t\t\t\t\tconst threshold = (afterSize - elementSize) / 2;\r\n\t\t\t\t\t\tend = afterBounds.begin + threshold;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tend = afterBounds.begin;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tafterBounds = { begin: layout.getContainerRectangles().end };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst shadowRectTopLeft = beforeBounds && afterBounds ? layout.getTopLeftOfElementBegin(beforeBounds.end, afterBounds.begin) : null;\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tshadowBeginEnd: {\r\n\t\t\t\t\t\tbegin,\r\n\t\t\t\t\t\tend,\r\n\t\t\t\t\t\trect: shadowRectTopLeft,\r\n\t\t\t\t\t\tbeginAdjustment: shadowBeginEnd ? shadowBeginEnd.beginAdjustment : 0,\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tprevAddedIndex = null;\r\n\t\t\treturn {\r\n\t\t\t\tshadowBeginEnd: null\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction handleFirstInsertShadowAdjustment() {\r\n\tlet lastAddedIndex = null;\r\n\treturn ({ dragResult: { pos, addedIndex, shadowBeginEnd }, draggableInfo: { invalidateShadow } }) => {\r\n\t\tif (pos !== null) {\r\n\t\t\tif (addedIndex != null && lastAddedIndex === null) {\r\n\t\t\t\tif (pos < shadowBeginEnd.begin) {\r\n\t\t\t\t\tconst beginAdjustment = pos - shadowBeginEnd.begin - 5;\r\n\t\t\t\t\tshadowBeginEnd.beginAdjustment = beginAdjustment;\r\n\t\t\t\t}\r\n\t\t\t\tlastAddedIndex = addedIndex;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlastAddedIndex = null;\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getDragHandler(params) {\r\n\treturn compose(params)(\r\n\t\tgetRemovedItem,\r\n\t\tsetRemovedItemVisibilty,\r\n\t\tgetPosition,\r\n\t\tnotifyParentOnPositionCapture,\r\n\t\tgetElementSize,\r\n\t\thandleTargetContainer,\r\n\t\tinvalidateShadowBeginEndIfNeeded,\r\n\t\tgetNextAddedIndex,\r\n\t\tresetShadowAdjustment,\r\n\t\thandleInsertionSizeChange,\r\n\t\tcalculateTranslations,\r\n\t\tgetShadowBeginEnd,\r\n\t\thandleFirstInsertShadowAdjustment\r\n\t);\r\n}\r\n\r\nfunction getDefaultDragResult() {\r\n\treturn {\r\n\t\taddedIndex: null,\r\n\t\tremovedIndex: null,\r\n\t\telementSize: null,\r\n\t\tpos: null,\r\n\t\tshadowBeginEnd: null\r\n\t};\r\n}\r\n\r\nfunction compose(params) {\r\n\treturn (...functions) => {\r\n\t\tconst hydratedFunctions = functions.map(p => p(params));\r\n\t\tlet result = null;\r\n\t\treturn (draggableInfo) => {\r\n\t\t\tresult = hydratedFunctions.reduce((dragResult, fn) => {\r\n\t\t\t\treturn Object.assign(dragResult, fn({ draggableInfo, dragResult }));\r\n\t\t\t}, result || getDefaultDragResult());\r\n\t\t\treturn result;\r\n\t\t};\r\n\t};\r\n}\r\n\r\n// Container definition begin\r\nfunction Container(element) {\r\n\treturn function(options) {\r\n\t\tlet dragResult = null;\r\n\t\tlet lastDraggableInfo = null;\r\n\t\tconst props = getContainerProps(element, options);\r\n\t\tlet dragHandler = getDragHandler(props);\r\n\t\tlet dropHandler = handleDrop(props);\r\n\t\tlet handleScrollOnDrag = dragscroller(props);\r\n\t\tlet parentContainer = null;\r\n\t\tlet posIsInChildContainer = false;\r\n\t\tlet childContainers = [];\r\n\r\n\t\tfunction processLastDraggableInfo() {\r\n\t\t\tif (lastDraggableInfo !== null) {\r\n\t\t\t\tlastDraggableInfo.invalidateShadow = true;\r\n\t\t\t\tdragResult = dragHandler(lastDraggableInfo);\r\n\t\t\t\tlastDraggableInfo.invalidateShadow = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction onChildPositionCaptured(isCaptured) {\r\n\t\t\tposIsInChildContainer = isCaptured;\r\n\t\t\tif (parentContainer) {\r\n\t\t\t\tparentContainer.onChildPositionCaptured(isCaptured);\r\n\t\t\t\tif (lastDraggableInfo) {\r\n\t\t\t\t\tdragResult = dragHandler(lastDraggableInfo);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction prepareDrag(container, relevantContainers) {\r\n\t\t\tconst element = container.element;\r\n\t\t\tconst draggables = props.draggables;\r\n\t\t\tconst options = container.getOptions();\r\n\t\t\tconst newDraggables = wrapChildren(element, options.orientation, options.animationDuration);\r\n\t\t\tfor (let i = 0; i < newDraggables.length; i++) {\r\n\t\t\t\tdraggables[i] = newDraggables[i];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i = 0; i < draggables.length - newDraggables.length; i++) {\r\n\t\t\t\tdraggables.pop();\r\n\t\t\t}\r\n\r\n\t\t\tcontainer.layout.invalidateRects();\r\n\t\t\tregisterToParentContainer(container, relevantContainers);\r\n\t\t}\r\n\r\n\t\tprops.layout.setScrollListener(function() {\r\n\t\t\tprocessLastDraggableInfo();\r\n\t\t});\r\n\r\n\t\tfunction dispose(container) {\r\n\t\t\t// additional dispose actions\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\telement,\r\n\t\t\tdraggables: props.draggables,\r\n\t\t\tisDragRelevant: isDragRelevant(props),\r\n\t\t\tgetScale: props.layout.getContainerScale,\r\n\t\t\tgetChildPayload: props.options.getChildPayload,\r\n\t\t\tgroupName: props.options.groupName,\r\n\t\t\tlayout: props.layout,\r\n\t\t\tgetChildContainers: () => childContainers,\r\n\t\t\tonChildPositionCaptured,\r\n\t\t\tdispose,\r\n\t\t\tprepareDrag,\r\n\t\t\tisPosInChildContainer: () => posIsInChildContainer,\r\n\t\t\thandleDrag: function(draggableInfo) {\r\n\t\t\t\tlastDraggableInfo = draggableInfo;\r\n\t\t\t\tdragResult = dragHandler(draggableInfo);\r\n\t\t\t\t// console.log(dragResult);\r\n\t\t\t\thandleScrollOnDrag({ draggableInfo, dragResult });\r\n\t\t\t},\r\n\t\t\thandleDrop: function(draggableInfo) {\r\n\t\t\t\tlastDraggableInfo = null;\r\n\t\t\t\tonChildPositionCaptured(false);\r\n\t\t\t\tdragHandler = getDragHandler(props);\r\n\t\t\t\tdropHandler(draggableInfo, dragResult);\r\n\t\t\t\thandleScrollOnDrag({ reset: true });\r\n\t\t\t\thandleScrollOnDrag = dragscroller(props);\r\n\t\t\t\tparentContainer = null;\r\n\t\t\t\tchildContainers = [];\r\n\t\t\t},\r\n\t\t\tgetDragResult: function() {\r\n\t\t\t\treturn dragResult;\r\n\t\t\t},\r\n\t\t\tgetTranslateCalculator: function(...params) {\r\n\t\t\t\treturn calculateTranslations(props)(...params);\r\n\t\t\t},\r\n\t\t\tsetParentContainer: (e) => { parentContainer = e; },\r\n\t\t\tgetParentContainer: () => parentContainer,\r\n\t\t\tonTranslated: () => {\r\n\t\t\t\tprocessLastDraggableInfo();\r\n\t\t\t},\r\n\t\t\tgetOptions: () => props.options,\r\n\t\t};\r\n\t};\r\n}\r\n\r\nconst options = {\r\n\tonDragStart: (itemIndex) => { },\r\n\tonDragMove: () => { },\r\n\tonDrop: () => { },\r\n\tbehaviour: 'move',\r\n\tgroupName: 'bla bla', // if not defined => container will not interfere with other containers\r\n\tacceptGroups: [],\r\n\torientation: 'vertical',\r\n\tdragHandleSelector: null,\r\n\tnonDragAreaSelector: 'some selector',\r\n\tdragBeginDelay: 0,\r\n\tanimationDuration: 180,\r\n\tgetChildPayload: (index) => null,\r\n};\r\n\r\n// exported part of container\r\nexport default function(element, options) {\r\n\tconst containerIniter = Container(element);\r\n\tconst container = containerIniter(options);\r\n\telement[containerInstance] = container;\r\n\tMediator.register(container);\r\n\treturn {\r\n\t\tsetOptions: containerIniter,\r\n\t\tdispose: function() {\r\n\t\t\tMediator.unregister(container);\r\n\t\t\tcontainer.layout.dispose();\r\n\t\t\tcontainer.dispose(container);\r\n\t\t}\r\n\t};\r\n}\r\n","import container from './src/container';\r\nimport * as constants from './src/constants';\r\nimport * as dropHandlers from './src/dropHandlers';\r\nexport default container;\r\nexport {\r\n\tconstants,\r\n\tdropHandlers\r\n};"],"sourceRoot":""}