{"version":3,"sources":["webpack://SmoothDND/webpack/universalModuleDefinition","webpack://SmoothDND/webpack/bootstrap","webpack://SmoothDND/./index.js","webpack://SmoothDND/./src/constants.js","webpack://SmoothDND/./src/container.js","webpack://SmoothDND/./src/dragscroller.js","webpack://SmoothDND/./src/dropHandlers.js","webpack://SmoothDND/./src/layoutManager.js","webpack://SmoothDND/./src/mediator.js","webpack://SmoothDND/./src/styles.js","webpack://SmoothDND/./src/utils.js"],"names":["containerInstance","containersInDraggable","defaultGroupName","wrapperClass","defaultGrabHandleClass","animationClass","translationValue","visibilityValue","ghostClass","containerClass","extraSizeForInsertion","stretcherElementClass","stretcherElementInstance","isDraggableDetached","disbaleTouchActions","noUserSelectClass","defaultOptions","groupName","behaviour","acceptGroups","orientation","getChildPayload","undefined","animationDuration","setAnimation","element","add","addClass","style","transitionDuration","removeClass","getContainer","initOptions","props","result","Object","assign","isDragRelevant","options","sourceContainer","sourceOptions","getOptions","parentWrapper","getParent","indexOf","wrapChild","child","div","document","createElement","className","parentElement","insertBefore","appendChild","wrapChildren","draggables","Array","prototype","map","call","children","wrapper","hasClass","findDraggebleAtPos","layout","find","pos","startIndex","endIndex","withRespectToMiddlePoints","begin","end","getBeginEnd","middleIndex","Math","floor","length","resetDraggables","forEach","p","setTranslation","setVisibility","parentNode","removeChild","setTimeout","setTargetContainer","draggableInfo","set","targetElement","handleDrop","draggablesReset","dropHandler","addedIndex","removedIndex","actualAddIndex","dropHandlerParams","payload","droppedElement","firstChild","onDrop","console","log","getContainerProps","initialOptions","layoutManager","getRelaventParentContainer","container","relevantContainers","current","containerOfParentElement","draggable","registerToParentContainer","parentInfo","getChildContainers","push","setParentContainer","getRemovedItem","prevRemovedIndex","dragResult","elementIndex","setRemovedItemVisibilty","getPosition","isPosInChildContainer","position","notifyParentOnPositionCapture","isCaptured","getParentContainer","onChildPositionCaptured","getElementSize","elementSize","getSize","handleTargetContainer","getDragInsertionIndex","findDraggable","shadowBeginEnd","index","beginAdjustment","invalidateShadowBeginEndIfNeeded","params","shadowBoundsGetter","getShadowBeginEnd","invalidateShadow","getNextAddedIndex","getIndexForPos","resetShadowAdjustment","lastAddedIndex","handleInsertionSizeChange","strectherElement","stretcherElementAdded","containerBeginEnd","getBeginEndOfContainer","hasScrollBar","getScrollSize","containerEnd","getScrollValue","lastDraggableEnd","stretcherSize","setSize","invalidateRects","toRemove","calculateTranslations","prevAddedIndex","translate","beforeIndex","afterBounds","beforeBounds","beforeSize","threshold","afterIndex","afterSize","getContainerRectangles","shadowRectTopLeft","getTopLeftOfElementBegin","rect","handleFirstInsertShadowAdjustment","getDragHandler","compose","getDefaultDragResult","functions","hydratedFunctions","reduce","fn","Container","lastDraggableInfo","dragHandler","handleScrollOnDrag","dragscroller","parentContainer","posIsInChildContainer","childContainers","processLastDraggableInfo","prepareDrag","newDraggables","i","pop","setScrollListener","dispose","getScale","getContainerScale","handleDrag","reset","getDragResult","getTranslateCalculator","e","onTranslated","onDragStart","itemIndex","onDragMove","dragHandleSelector","nonDragAreaSelector","dragBeginDelay","containerIniter","Mediator","register","setOptions","unregister","maxSpeed","minSpeed","getScrollableParent","axis","isScrolling","requestFrame","isAnimating","request","startTime","direction","speed","animate","_direction","_speed","start","requestAnimationFrame","timestamp","timeDiff","distanceDiff","scrollTo","setScrollValue","stop","cancelAnimationFrame","getAutoScrollInfo","scrollableBeginEnd","moveDistance","speedFactor","lastPos","scrollableParent","scrollParentBeginEnd","getBeginEndOfDOMRect","getBoundingClientRect","animator","autoScrollInfo","domDropHandler","dropResult","removeChildAt","splice","cloneNode","addChildAt","reactDropHandler","handler","horizontalMap","size","distanceToParent","dragPosition","scrollSize","offsetSize","scrollValue","scale","setters","val","verticalMap","orientationDependentProps","get","obj","prop","mappedProp","value","containerElement","_animationDuration","propMapper","values","translation","registeredScrollListener","window","addEventListener","invalidateContainerRectangles","invalidate","scrollListener","invalidateContainerScale","visibleRect","scaleX","right","left","offsetWidth","scaleY","bottom","top","offsetHeight","getBeginEndOfContainerVisibleRect","getDistanceToOffsetParent","distance","getAxisValue","updateDescendantContainerRects","getTranslation","isVisible","visibility","isInVisibleRect","x","y","callback","grabEvents","moveEvents","releaseEvents","dragListeningContainers","grabbedElement","ghostInfo","containers","isDragging","isMobile","listenEvents","addGrabListeners","onMouseDown","passive","addMoveListeners","onMouseMove","removeMoveListeners","removeEventListener","addReleaseListeners","onMouseUp","removeReleaseListeners","getGhostElement","dragClass","Utils","childNodes","midX","midY","pointerEvents","width","height","overflow","clone","transform","transformOrigin","margin","ghost","centerDelta","positionDelta","clientWidth","clientHeight","getDraggableInfo","draggableElement","filter","draggableIndex","handleDropAnimation","endDrop","body","animateGhostToPosition","duration","max","prevDraggableEnd","opacity","handleDragStartConditions","startEvent","delay","clb","timer","moveThreshold","maxMoveInDelay","onMove","event","clientX","currentX","clientY","currentY","getPointerEvent","abs","callCallback","deregisterEvent","onUp","onHTMLDrag","registerEvents","clearTimeout","_startEvent","_delay","_clb","target","startDrag","preventDefault","getSelection","empty","touchAction","touches","addStyleToHead","css","convertToCssString","entries","styleString","propName","propValue","head","getElementsByTagName","cssString","type","styleSheet","cssText","createTextNode","getIntersection","rect1","rect2","min","getIntersectionOnAxis","getContainerRect","_rect","hasBiggerChild","isScrollingOrHidden","scrollWidth","scrollHeight","getComputedStyle","overFlowAxis","general","dimensionScroll","getVisibleRect","elementRect","currentElement","listenScrollParent","scrollers","hasParent","parent","selector","matches","cls","split","classes","join","debounce","immediate","lenght","navigator","userAgent","match"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;;;;;ACnEA;AACA;AACA;AACA,+DAAe,sDAAf;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHO,MAAMA,oBAAoB,+BAA1B;AACA,MAAMC,wBAAwB,oCAA9B;;AAEA,MAAMC,mBAAmB,8BAAzB;AACA,MAAMC,eAAe,8BAArB;AACA,MAAMC,yBAAyB,gCAA/B;AACA,MAAMC,iBAAiB,UAAvB;AACA,MAAMC,mBAAmB,0CAAzB;AACA,MAAMC,kBAAkB,yCAAxB;AACA,MAAMC,aAAa,kBAAnB;;AAEA,MAAMC,iBAAiB,sBAAvB;;AAEA,MAAMC,wBAAwB,qCAA9B;AACA,MAAMC,wBAAwB,8BAA9B;AACA,MAAMC,2BAA2B,+BAAjC;;AAEA,MAAMC,sBAAsB,iCAA5B;;AAEA,MAAMC,sBAAsB,iCAA5B;AACA,MAAMC,oBAAoB,2BAA1B,C;;;;;;;;;;;;;;;;;;;ACpBP;AACA;AACA;AACA;AAWA;AACA;AACA;;AAEA,MAAMC,iBAAiB;AACtBC,YAAW,IADW;AAEtBC,YAAW,MAFW,EAEH;AACnBC,eAAc,CAAC,2DAAD,CAHQ;AAItBC,cAAa,UAJS,EAIG;AACzBC,kBAAiB,MAAM;AAAE,SAAOC,SAAP;AAAmB,EALtB;AAMtBC,oBAAmB;AANG,CAAvB;;AASA,SAASC,YAAT,CAAsBC,OAAtB,EAA+BC,GAA/B,EAAoCH,iBAApC,EAAuD;AACtD,KAAIG,GAAJ,EAAS;AACRC,EAAA,uDAAAA,CAASF,OAAT,EAAkB,yDAAlB;AACAA,UAAQG,KAAR,CAAcC,kBAAd,GAAmCN,oBAAoB,IAAvD;AACA,EAHD,MAGO;AACNO,EAAA,0DAAAA,CAAYL,OAAZ,EAAqB,yDAArB;AACAA,UAAQG,KAAR,CAAcC,kBAAd,GAAmC,IAAnC;AACA;AACD;;AAED,SAASE,YAAT,CAAsBN,OAAtB,EAA+B;AAC9B,QAAOA,UAAUA,QAAQ,4DAAR,CAAV,GAAuC,IAA9C;AACA;;AAED,SAASO,WAAT,CAAqBC,QAAQjB,cAA7B,EAA6C;AAC5C,OAAMkB,SAASC,OAAOC,MAAP,CAAc,EAAd,EAAkBpB,cAAlB,EAAkCiB,KAAlC,CAAf;AACA,KAAIC,OAAOjB,SAAP,IAAoB,CAACgB,MAAMd,YAA/B,EAA6C;AAC5Ce,SAAOf,YAAP,GAAsB,CAACc,MAAMhB,SAAP,CAAtB;AACA;AACD,QAAOiB,MAAP;AACA;;AAED,SAASG,cAAT,CAAwB,EAAEZ,OAAF,EAAWa,OAAX,EAAxB,EAA8C;AAC7C,QAAO,UAASC,eAAT,EAA0B;AAChC,QAAMC,gBAAgBD,gBAAgBE,UAAhB,EAAtB;AACA,MAAIH,QAAQpB,SAAR,KAAsB,MAA1B,EAAkC,OAAO,KAAP;;AAElC,QAAMwB,gBAAgB,wDAAAC,CAAUlB,OAAV,EAAmB,MAAM,uDAAzB,CAAtB;AACA,MAAIiB,kBAAkBH,gBAAgBd,OAAtC,EAA+C;AAC9C,UAAO,KAAP;AACA;;AAED,MAAIc,gBAAgBd,OAAhB,KAA4BA,OAAhC,EAAyC,OAAO,IAAP;AACzC,MAAIe,cAAcvB,SAAd,IAA2BuB,cAAcvB,SAAd,KAA4BqB,QAAQrB,SAAnE,EAA8E,OAAO,IAAP;AAC9E,MAAIqB,QAAQnB,YAAR,CAAqByB,OAArB,CAA6BJ,cAAcvB,SAA3C,IAAwD,CAAC,CAA7D,EAAgE,OAAO,IAAP;;AAEhE,SAAO,KAAP;AACA,EAdD;AAeA;;AAED,SAAS4B,SAAT,CAAmBC,KAAnB,EAA0B1B,WAA1B,EAAuC;AACtC,OAAM2B,MAAMC,SAASC,aAAT,CAAuB,KAAvB,CAAZ;AACAF,KAAIG,SAAJ,GAAiB,GAAE,uDAAa,IAAG9B,WAAY,IAAG,yDAAe,EAAjE;AACA0B,OAAMK,aAAN,CAAoBC,YAApB,CAAiCL,GAAjC,EAAsCD,KAAtC;AACAC,KAAIM,WAAJ,CAAgBP,KAAhB;AACA,QAAOC,GAAP;AACA;;AAED,SAASO,YAAT,CAAsB7B,OAAtB,EAA+BL,WAA/B,EAA4CG,iBAA5C,EAA+D;AAC9D,OAAMgC,aAAaC,MAAMC,SAAN,CAAgBC,GAAhB,CAAoBC,IAApB,CAAyBlC,QAAQmC,QAAjC,EAA2Cd,SAAS;AACtE,MAAIe,UAAUf,KAAd;AACA,MAAI,CAAC,uDAAAgB,CAAShB,KAAT,EAAgB,uDAAhB,CAAL,EAAoC;AACnCe,aAAUhB,UAAUC,KAAV,EAAiB1B,WAAjB,EAA8BG,iBAA9B,CAAV;AACA;;AAEDsC,UAAQjC,KAAR,CAAcC,kBAAd,GAAmCN,oBAAoB,IAAvD;AACAsC,UAAQ,gEAAR,IAAiC,EAAjC;AACAA,UAAQ,2DAAR,IAA4B,CAA5B;AACA,SAAOA,OAAP;AACA,EAVkB,CAAnB;AAWA,QAAON,UAAP;AACA;;AAED,SAASQ,kBAAT,CAA4B,EAAEC,MAAF,EAA5B,EAAwC;AACvC,OAAMC,OAAO,CAACV,UAAD,EAAaW,GAAb,EAAkBC,UAAlB,EAA8BC,QAA9B,EAAwCC,4BAA4B,KAApE,KAA8E;AAC1F,MAAID,WAAWD,UAAf,EAA2B;AAC1B,UAAOA,UAAP;AACA;AACD;AACA,MAAIA,eAAeC,QAAnB,EAA6B;AAC5B,OAAI,EAAEE,KAAF,EAASC,GAAT,KAAiBP,OAAOQ,WAAP,CAAmBjB,WAAWY,UAAX,CAAnB,CAArB;AACA;AACA;AACA,OAAID,MAAMI,KAAN,IAAeJ,OAAOK,GAA1B,EAA+B;AAC9B,QAAIF,yBAAJ,EAA+B;AAC9B,YAAQH,MAAO,CAACK,MAAMD,KAAP,IAAgB,CAAxB,GAA8BH,UAA9B,GAA2CA,aAAa,CAA/D;AACA,KAFD,MAEO;AACN,YAAOA,UAAP;AACA;AACD,IAND,MAMO;AACN,WAAO,IAAP;AACA;AACD,GAbD,MAaO;AACN,SAAMM,cAAcC,KAAKC,KAAL,CAAW,CAACP,WAAWD,UAAZ,IAA0B,CAArC,CAApB;AACA,SAAM,EAAEG,KAAF,EAASC,GAAT,KAAiBP,OAAOQ,WAAP,CAAmBjB,WAAWkB,WAAX,CAAnB,CAAvB;AACA,OAAIP,MAAMI,KAAV,EAAiB;AAChB,WAAOL,KAAKV,UAAL,EAAiBW,GAAjB,EAAsBC,UAAtB,EAAkCM,cAAc,CAAhD,EAAmDJ,yBAAnD,CAAP;AACA,IAFD,MAEO,IAAIH,MAAMK,GAAV,EAAe;AACrB,WAAON,KAAKV,UAAL,EAAiBW,GAAjB,EAAsBO,cAAc,CAApC,EAAuCL,QAAvC,EAAiDC,yBAAjD,CAAP;AACA,IAFM,MAEA;AACN,QAAIA,yBAAJ,EAA+B;AAC9B,YAAQH,MAAO,CAACK,MAAMD,KAAP,IAAgB,CAAxB,GAA8BG,WAA9B,GAA4CA,cAAc,CAAjE;AACA,KAFD,MAEO;AACN,YAAOA,WAAP;AACA;AACD;AACD;AACD,EAjCD;;AAmCA,QAAO,CAAClB,UAAD,EAAaW,GAAb,EAAkBG,4BAA4B,KAA9C,KAAwD;AAC9D,SAAOJ,KAAKV,UAAL,EAAiBW,GAAjB,EAAsB,CAAtB,EAAyBX,WAAWqB,MAAX,GAAoB,CAA7C,EAAgDP,yBAAhD,CAAP;AACA,EAFD;AAGA;;AAED,SAASQ,eAAT,CAAyB,EAAEpD,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA+B1B,OAA/B,EAAzB,EAAmE;AAClE,QAAO,YAAW;AACjBiB,aAAWuB,OAAX,CAAmBC,KAAK;AACvBvD,gBAAauD,CAAb,EAAgB,KAAhB;AACAf,UAAOgB,cAAP,CAAsBD,CAAtB,EAAyB,CAAzB;AACAf,UAAOiB,aAAP,CAAqBF,CAArB,EAAwB,IAAxB;AACAA,KAAE,gEAAF,IAA2B,EAA3B;AACA,GALD;;AAOA,MAAItD,QAAQ,mEAAR,CAAJ,EAAuC;AACtCA,WAAQ,mEAAR,EAAkCyD,UAAlC,CAA6CC,WAA7C,CAAyD1D,QAAQ,mEAAR,CAAzD;AACAA,WAAQ,mEAAR,IAAoC,IAApC;AACA;;AAED2D,aAAW,MAAM;AAChB7B,cAAWuB,OAAX,CAAmBC,KAAK;AACvBvD,iBAAauD,CAAb,EAAgB,IAAhB,EAAsBzC,QAAQf,iBAA9B;AACA,IAFD;AAGA,GAJD,EAIG,EAJH;AAKA,EAlBD;AAmBA;;AAED,SAAS8D,kBAAT,CAA4BC,aAA5B,EAA2C7D,OAA3C,EAAoD8D,MAAM,IAA1D,EAAgE;AAC/D,KAAI9D,WAAW8D,GAAf,EAAoB;AACnBD,gBAAcE,aAAd,GAA8B/D,OAA9B;AACA,EAFD,MAEO;AACN,MAAI6D,cAAcE,aAAd,KAAgC/D,OAApC,EAA6C;AAC5C6D,iBAAcE,aAAd,GAA8B,IAA9B;AACA;AACD;AACD;;AAED,SAASC,UAAT,CAAoB,EAAEhE,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA+B1B,OAA/B,EAApB,EAA8D;AAC7D,OAAMoD,kBAAkBb,gBAAgB,EAAEpD,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA+B1B,OAA/B,EAAhB,CAAxB;AACA,OAAMqD,cAAc,CAACrD,QAAQqD,WAAR,IAAuB,4DAAxB,EAAyC,EAAElE,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA+B1B,OAA/B,EAAzC,CAApB;AACA,QAAO,UAASgD,aAAT,EAAwB,EAAEM,UAAF,EAAcC,YAAd,EAAxB,EAAsD;AAC5DH;AACA;AACA,MAAIJ,cAAcE,aAAlB,EAAiC;AAChC,OAAIM,iBAAiBF,eAAe,IAAf,GAAwBC,iBAAiB,IAAjB,IAAyBA,eAAeD,UAAzC,GAAuDA,aAAa,CAApE,GAAwEA,UAA/F,GAA6G,IAAlI;AACA,SAAMG,oBAAoB;AACzBF,gBADyB;AAEzBD,gBAAYE,cAFa;AAGzBE,aAASV,cAAcU,OAHE;AAIzBC,oBAAgBX,cAAc7D,OAAd,CAAsByE;AAJb,IAA1B;AAMAP,eAAYI,iBAAZ,EAA+BzD,QAAQ6D,MAAvC;AACAC,WAAQC,GAAR,CAAYR,YAAZ,EAA0BC,cAA1B,EAA0CR,cAAcU,OAAxD,EAAiEV,cAAc7D,OAAd,CAAsByE,UAAvF;AACA;AACD,EAdD;AAeA;;AAED,SAASI,iBAAT,CAA2B7E,OAA3B,EAAoC8E,cAApC,EAAoD;AACnD,OAAMjE,UAAUN,YAAYuE,cAAZ,CAAhB;AACA,OAAMhD,aAAaD,aAAa7B,OAAb,EAAsBa,QAAQlB,WAA9B,EAA2CkB,QAAQf,iBAAnD,CAAnB;AACA;AACAI,CAAA,uDAAAA,CAASF,OAAT,EAAmB,GAAE,yDAAe,IAAGa,QAAQlB,WAAY,EAA3D;AACA,OAAM4C,SAAS,8DAAAwC,CAAc/E,OAAd,EAAuBa,QAAQlB,WAA/B,EAA4CkB,QAAQf,iBAApD,CAAf;AACA,QAAO;AACNE,SADM;AAEN8B,YAFM;AAGNjB,SAHM;AAIN0B;AAJM,EAAP;AAMA;;AAED,SAASyC,0BAAT,CAAoCC,SAApC,EAA+CC,kBAA/C,EAAmE;AAClE,KAAIC,UAAUF,UAAUjF,OAAxB;AACA,QAAOmF,OAAP,EAAgB;AACf,QAAMC,2BAA2B9E,aAAa6E,QAAQzD,aAArB,CAAjC;AACA,MAAI0D,4BAA4BF,mBAAmB/D,OAAnB,CAA2BiE,wBAA3B,IAAuD,CAAC,CAAxF,EAA2F;AAC1F,UAAO;AACNH,eAAWG,wBADL;AAENC,eAAWF;AAFL,IAAP;AAIA;AACDA,YAAUA,QAAQzD,aAAlB;AACA;;AAED,QAAO,IAAP;AACA;;AAED,SAAS4D,yBAAT,CAAmCL,SAAnC,EAA8CC,kBAA9C,EAAkE;AACjE,OAAMK,aAAaP,2BAA2BC,SAA3B,EAAsCC,kBAAtC,CAAnB;AACA,KAAIK,UAAJ,EAAgB;AACfA,aAAWN,SAAX,CAAqBO,kBAArB,GAA0CC,IAA1C,CAA+CR,SAA/C;AACAA,YAAUS,kBAAV,CAA6BH,WAAWN,SAAxC;AACA;AACAM,aAAWF,SAAX,CAAqB,gEAArB,EAA4CI,IAA5C,CAAiDR,SAAjD;AACA;AACD;;AAED,SAASU,cAAT,CAAwB,EAAE7D,UAAF,EAAc9B,OAAd,EAAuBa,OAAvB,EAAxB,EAA0D;AACzD,KAAI+E,mBAAmB,IAAvB;AACA,QAAO,CAAC,EAAE/B,aAAF,EAAiBgC,UAAjB,EAAD,KAAmC;AACzC,MAAIzB,eAAewB,gBAAnB;AACA,MAAIA,oBAAoB,IAApB,IAA4B/B,cAAcoB,SAAd,CAAwBjF,OAAxB,KAAoCA,OAAhE,IAA2Ea,QAAQpB,SAAR,KAAsB,MAArG,EAA6G;AAC5G2E,kBAAewB,mBAAmB/B,cAAciC,YAAhD;AACA;;AAED,SAAO,EAAE1B,YAAF,EAAP;AACA,EAPD;AAQA;;AAED,SAAS2B,uBAAT,CAAiC,EAAEjE,UAAF,EAAcS,MAAd,EAAjC,EAAyD;AACxD,QAAO,CAAC,EAAEsB,aAAF,EAAiBgC,UAAjB,EAAD,KAAmC;AACzC,MAAIA,WAAWzB,YAAX,KAA4B,IAAhC,EAAsC;AACrC7B,UAAOiB,aAAP,CAAqB1B,WAAW+D,WAAWzB,YAAtB,CAArB,EAA0D,KAA1D;AACA;AACD,EAJD;AAKA;;AAED,SAAS4B,WAAT,CAAqB,EAAEhG,OAAF,EAAWuC,MAAX,EAArB,EAA0C;AACzC,QAAO,CAAC,EAAEsB,aAAF,EAAD,KAAuB;AAC7B,SAAO;AACNpB,QAAK,CAACnC,aAAaN,OAAb,EAAsBiG,qBAAtB,EAAD,GAAiD1D,OAAOyD,WAAP,CAAmBnC,cAAcqC,QAAjC,CAAjD,GAA8F;AAD7F,GAAP;AAGA,EAJD;AAKA;;AAED,SAASC,6BAAT,CAAuC,EAAEnG,OAAF,EAAvC,EAAoD;AACnD,KAAIoG,aAAa,KAAjB;AACA,QAAO,CAAC,EAAEvC,aAAF,EAAiBgC,UAAjB,EAAD,KAAmC;AACzC,MAAIvF,aAAaN,OAAb,EAAsBqG,kBAAtB,MAA8CD,gBAAgBP,WAAWpD,GAAX,KAAmB,IAAnC,CAAlD,EAA4F;AAC3F2D,gBAAaP,WAAWpD,GAAX,KAAmB,IAAhC;AACAnC,gBAAaN,OAAb,EAAsBqG,kBAAtB,GAA2CC,uBAA3C,CAAmEF,UAAnE;AACA;AACD,EALD;AAMA;;AAED,SAASG,cAAT,CAAwB,EAAEhE,MAAF,EAAxB,EAAoC;AACnC,KAAIiE,cAAc,IAAlB;AACA,QAAO,CAAC,EAAE3C,aAAF,EAAiBgC,UAAjB,EAAD,KAAmC;AACzC,MAAIA,WAAWpD,GAAX,KAAmB,IAAvB,EAA6B;AAC5B,UAAO+D,cAAc,IAArB;AACA,GAFD,MAEO;AACNA,iBAAcA,eAAejE,OAAOkE,OAAP,CAAe5C,cAAc7D,OAA7B,CAA7B;AACA;AACD,SAAO,EAAEwG,WAAF,EAAP;AACA,EAPD;AAQA;;AAED,SAASE,qBAAT,CAA+B,EAAE1G,OAAF,EAA/B,EAA4C;AAC3C,QAAO,CAAC,EAAE6D,aAAF,EAAiBgC,UAAjB,EAAD,KAAmC;AACzCjC,qBAAmBC,aAAnB,EAAkC7D,OAAlC,EAA2C,CAAC,CAAC6F,WAAWpD,GAAxD;AACA,EAFD;AAGA;;AAED,SAASkE,qBAAT,CAA+B,EAAE7E,UAAF,EAAcS,MAAd,EAA/B,EAAuD;AACtD,OAAMqE,gBAAgBtE,mBAAmB,EAAEC,MAAF,EAAnB,CAAtB;AACA,QAAO,CAAC,EAAEsD,YAAY,EAAEgB,cAAF,EAAkBpE,GAAlB,EAAd,EAAD,KAA6C;AACnD,MAAI,CAACoE,cAAL,EAAqB;AACpB,SAAMC,QAAQF,cAAc9E,UAAd,EAA0BW,GAA1B,EAA+B,IAA/B,CAAd;AACA,UAAOqE,UAAU,IAAV,GAAiBA,KAAjB,GAAyBhF,WAAWqB,MAA3C;AACA,GAHD,MAGO;AACN,OAAI0D,eAAehE,KAAf,GAAuBgE,eAAeE,eAAtC,IAAyDtE,GAAzD,IAAgEoE,eAAe/D,GAAf,IAAsBL,GAA1F,EAA+F;AAC9F;AACA,WAAO,IAAP;AACA;AACD;;AAED,MAAIA,MAAMoE,eAAehE,KAAf,GAAuBgE,eAAeE,eAAhD,EAAiE;AAChE,UAAOH,cAAc9E,UAAd,EAA0BW,GAA1B,CAAP;AACA,GAFD,MAEO,IAAIA,MAAMoE,eAAe/D,GAAzB,EAA8B;AACpC,UAAO8D,cAAc9E,UAAd,EAA0BW,GAA1B,IAAiC,CAAxC;AACA,GAFM,MAEA;AACN,UAAOX,WAAWqB,MAAlB;AACA;AACD,EAlBD;AAmBA;;AAED,SAAS6D,gCAAT,CAA0CC,MAA1C,EAAkD;AACjD,OAAMC,qBAAqBC,kBAAkBF,MAAlB,CAA3B;AACA,QAAO,CAAC,EAAEpD,aAAF,EAAiBgC,UAAjB,EAAD,KAAmC;AACzC,MAAIhC,cAAcuD,gBAAlB,EAAoC;AACnC,UAAOF,mBAAmB,EAAErD,aAAF,EAAiBgC,UAAjB,EAAnB,CAAP;AACA;AACD,SAAO,IAAP;AACA,EALD;AAMA;;AAED,SAASwB,iBAAT,CAA2BJ,MAA3B,EAAmC;AAClC,OAAMK,iBAAiBX,sBAAsBM,MAAtB,CAAvB;AACA,QAAO,CAAC,EAAEpB,UAAF,EAAD,KAAoB;AAC1B,MAAIiB,QAAQ,IAAZ;AACA,MAAIjB,WAAWpD,GAAX,KAAmB,IAAvB,EAA6B;AAC5BqE,WAAQQ,eAAe,EAAEzB,UAAF,EAAf,CAAR;AACA,OAAIiB,UAAU,IAAd,EAAoB;AACnBA,YAAQjB,WAAW1B,UAAnB;AACA;AACD;AACD,SAAO;AACNA,eAAY2C;AADN,GAAP;AAGA,EAXD;AAYA;;AAED,SAASS,qBAAT,GAAiC;AAChC,KAAIC,iBAAiB,IAArB;AACA,QAAO,CAAC,EAAE3B,YAAY,EAAE1B,UAAF,EAAc0C,cAAd,EAAd,EAAD,KAAoD;AAC1D,MAAI1C,eAAeqD,cAAf,IAAiCA,mBAAmB,IAApD,IAA4DX,cAAhE,EAAgF;AAC/EA,kBAAeE,eAAf,GAAiC,CAAjC;AACA;AACDS,mBAAiBrD,UAAjB;AACA,EALD;AAMA;;AAED,SAASsD,yBAAT,CAAmC,EAAEzH,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA+B1B,OAA/B,EAAnC,EAA6E;AAC5E,KAAI6G,mBAAmB,IAAvB;AACA,KAAIC,wBAAwB,KAA5B;;AAEA,QAAO,UAAS,EAAE9B,YAAY,EAAE1B,UAAF,EAAcC,YAAd,EAA4BoC,WAA5B,EAAd,EAAT,EAAoE;AAC1E,MAAIpC,iBAAiB,IAArB,EAA2B;AAC1B,OAAID,eAAe,IAAnB,EAAyB;AACxB,QAAI,CAACwD,qBAAL,EAA4B;AAC3B,WAAMC,oBAAoBrF,OAAOsF,sBAAP,EAA1B;AACA,WAAMC,eAAevF,OAAOwF,aAAP,CAAqB/H,OAArB,IAAgCuC,OAAOkE,OAAP,CAAezG,OAAf,CAArD;AACA,WAAMgI,eAAeF,eAAgBF,kBAAkB/E,KAAlB,GAA0BN,OAAOwF,aAAP,CAAqB/H,OAArB,CAA1B,GAA0DuC,OAAO0F,cAAP,CAAsBjI,OAAtB,CAA1E,GAA4G4H,kBAAkB9E,GAAnJ;AACA,WAAMoF,mBAAmB3F,OAAOQ,WAAP,CAAmBjB,WAAWA,WAAWqB,MAAX,GAAoB,CAA/B,CAAnB,EAAsDL,GAAtD,GAA4DhB,WAAWA,WAAWqB,MAAX,GAAoB,CAA/B,EAAkC,2DAAlC,CAArF;AACA,SAAI+E,mBAAmB1B,WAAnB,GAAiCwB,YAArC,EAAmD;AAClDN,yBAAmBnG,SAASC,aAAT,CAAuB,KAAvB,CAAnB;AACAkG,uBAAiBjG,SAAjB,GAA6B,gEAAAvC,GAAwB,GAAxB,GAA8B2B,QAAQlB,WAAnE;AACA,YAAMwI,gBAAiB3B,cAAc0B,gBAAf,GAAmCF,YAAzD;AACAzF,aAAO6F,OAAP,CAAeV,iBAAiBvH,KAAhC,EAAwC,GAAEgI,aAAc,IAAxD;AACAnI,cAAQ4B,WAAR,CAAoB8F,gBAApB;AACA1H,cAAQ,mEAAR,IAAoC0H,gBAApC;AACA;AACDC,6BAAwB,IAAxB;AACAhE,gBAAW,MAAM;AAChBpB,aAAO8F,eAAP;AACA,MAFD,EAEG,GAFH;AAGA;AACD,IAnBD,MAmBO;AACN,QAAIX,gBAAJ,EAAsB;AACrBnF,YAAOgB,cAAP,CAAsBmE,gBAAtB,EAAwC,CAAxC;AACA,SAAIY,WAAWZ,gBAAf;AACAA,wBAAmB,IAAnB;AACA1H,aAAQ0D,WAAR,CAAoB4E,QAApB;AACAtI,aAAQ,mEAAR,IAAoC,IAApC;AACA;AACD2H,4BAAwB,KAAxB;AACAhE,eAAW,MAAM;AAChBpB,YAAO8F,eAAP;AACA,KAFD,EAEG,GAFH;AAIA;AACD;AACD,EApCD;AAqCA;;AAED,SAASE,qBAAT,CAA+B,EAAEvI,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA/B,EAAgE;AAC/D,KAAIiG,iBAAiB,IAArB;AACA,KAAI5C,mBAAmB,IAAvB;AACA,QAAO,UAAS,EAAEC,YAAY,EAAE1B,UAAF,EAAcC,YAAd,EAA4BoC,WAA5B,EAAd,EAAT,EAAoE;AAC1E,MAAIrC,eAAeqE,cAAf,IAAiCpE,iBAAiBwB,gBAAtD,EAAwE;AACvE,QAAK,IAAIkB,QAAQ,CAAjB,EAAoBA,QAAQhF,WAAWqB,MAAvC,EAA+C2D,OAA/C,EAAwD;AACvD,QAAIA,UAAU1C,YAAd,EAA4B;AAC3B,WAAMiB,YAAYvD,WAAWgF,KAAX,CAAlB;AACA,SAAI2B,YAAY,CAAhB;AACA,SAAIrE,iBAAiB,IAAjB,IAAyBA,eAAe0C,KAA5C,EAAmD;AAClD2B,mBAAalG,OAAOkE,OAAP,CAAe3E,WAAWsC,YAAX,CAAf,CAAb;AACA;AACD,SAAID,eAAe,IAAf,IAAuBA,cAAc2C,KAAzC,EAAgD;AAC/C2B,mBAAajC,WAAb;AACA;AACDjE,YAAOgB,cAAP,CAAsB8B,SAAtB,EAAiCoD,SAAjC;AACA;AACD;;AAEDD,oBAAiBrE,UAAjB;AACAyB,sBAAmBxB,YAAnB;;AAEA,UAAO,EAAED,UAAF,EAAcC,YAAd,EAAP;AACA;AACD,EArBD;AAsBA;;AAED,SAAS+C,iBAAT,CAA2B,EAAErF,UAAF,EAAcS,MAAd,EAA3B,EAAmD;AAClD,KAAIiG,iBAAiB,IAArB;AACA,QAAO,CAAC,EAAE3E,aAAF,EAAiBgC,UAAjB,EAAD,KAAmC;AACzC,QAAM,EAAE1B,UAAF,EAAcC,YAAd,EAA4BoC,WAA5B,EAAyC/D,GAAzC,EAA8CoE,cAA9C,KAAiEhB,UAAvE;AACA,MAAIpD,QAAQ,IAAZ,EAAkB;AACjB,OAAI0B,eAAe,IAAf,KAAwBN,cAAcuD,gBAAd,IAAkCjD,eAAeqE,cAAzE,CAAJ,EAA8F;AAC7F,QAAIA,cAAJ,EACCA,iBAAiBrE,UAAjB;AACD,QAAIuE,cAAcvE,aAAa,CAA/B;AACA,QAAItB,QAAQ,CAAZ;AACA,QAAI8F,cAAc,IAAlB;AACA,QAAIC,eAAe,IAAnB;AACA,QAAIF,gBAAgBtE,YAApB,EAAkC;AACjCsE;AACA;AACD,QAAIA,cAAc,CAAC,CAAnB,EAAsB;AACrB,WAAMG,aAAatG,OAAOkE,OAAP,CAAe3E,WAAW4G,WAAX,CAAf,CAAnB;AACAE,oBAAerG,OAAOQ,WAAP,CAAmBjB,WAAW4G,WAAX,CAAnB,CAAf;AACA,SAAIlC,cAAcqC,UAAlB,EAA8B;AAC7B,YAAMC,YAAY,CAACD,aAAarC,WAAd,IAA6B,CAA/C;AACA3D,cAAQ+F,aAAa9F,GAAb,GAAmBgG,SAA3B;AACA,MAHD,MAGO;AACNjG,cAAQ+F,aAAa9F,GAArB;AACA;AACD,KATD,MASO;AACN8F,oBAAe,EAAE9F,KAAKP,OAAOsF,sBAAP,GAAgChF,KAAvC,EAAf;AACA;;AAED,QAAIC,MAAM,KAAV;AACA,QAAIiG,aAAa5E,UAAjB;AACA,QAAI4E,eAAe3E,YAAnB,EAAiC;AAChC2E;AACA;AACD,QAAIA,aAAajH,WAAWqB,MAA5B,EAAoC;AACnC,WAAM6F,YAAYzG,OAAOkE,OAAP,CAAe3E,WAAWiH,UAAX,CAAf,CAAlB;AACAJ,mBAAcpG,OAAOQ,WAAP,CAAmBjB,WAAWiH,UAAX,CAAnB,CAAd;;AAEA,SAAIvC,cAAcwC,SAAlB,EAA6B;AAC5B,YAAMF,YAAY,CAACE,YAAYxC,WAAb,IAA4B,CAA9C;AACA1D,YAAM6F,YAAY9F,KAAZ,GAAoBiG,SAA1B;AACA,MAHD,MAGO;AACNhG,YAAM6F,YAAY9F,KAAlB;AACA;AACD,KAVD,MAUO;AACN8F,mBAAc,EAAE9F,OAAON,OAAO0G,sBAAP,GAAgCnG,GAAzC,EAAd;AACA;;AAED,UAAMoG,oBAAoBN,gBAAgBD,WAAhB,GAA8BpG,OAAO4G,wBAAP,CAAgCP,aAAa9F,GAA7C,EAAkD6F,YAAY9F,KAA9D,CAA9B,GAAqG,IAA/H;;AAEA,WAAO;AACNgE,qBAAgB;AACfhE,WADe;AAEfC,SAFe;AAGfsG,YAAMF,iBAHS;AAIfnC,uBAAiBF,iBAAiBA,eAAeE,eAAhC,GAAkD;AAJpD;AADV,KAAP;AAQA,IApDD,MAoDO;AACN,WAAO,IAAP;AACA;AACD,GAxDD,MAwDO;AACNyB,oBAAiB,IAAjB;AACA,UAAO;AACN3B,oBAAgB;AADV,IAAP;AAGA;AACD,EAhED;AAiEA;;AAED,SAASwC,iCAAT,GAA6C;AAC5C,KAAI7B,iBAAiB,IAArB;AACA,QAAO,CAAC,EAAE3B,YAAY,EAAEpD,GAAF,EAAO0B,UAAP,EAAmB0C,cAAnB,EAAd,EAAmDhD,eAAe,EAAEuD,gBAAF,EAAlE,EAAD,KAA8F;AACpG,MAAI3E,QAAQ,IAAZ,EAAkB;AACjB,OAAI0B,cAAc,IAAd,IAAsBqD,mBAAmB,IAA7C,EAAmD;AAClD,QAAI/E,MAAMoE,eAAehE,KAAzB,EAAgC;AAC/B,WAAMkE,kBAAkBtE,MAAMoE,eAAehE,KAArB,GAA6B,CAArD;AACAgE,oBAAeE,eAAf,GAAiCA,eAAjC;AACA;AACDS,qBAAiBrD,UAAjB;AACA;AACD,GARD,MAQO;AACNqD,oBAAiB,IAAjB;AACA;AACD,EAZD;AAaA;;AAED,SAAS8B,cAAT,CAAwBrC,MAAxB,EAAgC;AAC/B,QAAOsC,QAAQtC,MAAR,EACNtB,cADM,EAENI,uBAFM,EAGNC,WAHM,EAING,6BAJM,EAKNI,cALM,EAMNG,qBANM,EAONM,gCAPM,EAQNK,iBARM,EASNE,qBATM,EAUNE,yBAVM,EAWNc,qBAXM,EAYNpB,iBAZM,EAaNkC,iCAbM,CAAP;AAeA;;AAED,SAASG,oBAAT,GAAgC;AAC/B,QAAO;AACNrF,cAAY,IADN;AAENC,gBAAc,IAFR;AAGNoC,eAAa,IAHP;AAIN/D,OAAK,IAJC;AAKNoE,kBAAgB;AALV,EAAP;AAOA;;AAED,SAAS0C,OAAT,CAAiBtC,MAAjB,EAAyB;AACxB,QAAO,CAAC,GAAGwC,SAAJ,KAAkB;AACxB,QAAMC,oBAAoBD,UAAUxH,GAAV,CAAcqB,KAAKA,EAAE2D,MAAF,CAAnB,CAA1B;AACA,MAAIxG,SAAS,IAAb;AACA,SAAQoD,aAAD,IAAmB;AACzBpD,YAASiJ,kBAAkBC,MAAlB,CAAyB,CAAC9D,UAAD,EAAa+D,EAAb,KAAoB;AACrD,WAAOlJ,OAAOC,MAAP,CAAckF,UAAd,EAA0B+D,GAAG,EAAE/F,aAAF,EAAiBgC,UAAjB,EAAH,CAA1B,CAAP;AACA,IAFQ,EAENpF,UAAU+I,sBAFJ,CAAT;AAGA,UAAO/I,MAAP;AACA,GALD;AAMA,EATD;AAUA;;AAED;AACA,SAASoJ,SAAT,CAAmB7J,OAAnB,EAA4B;AAC3B,QAAO,UAASa,OAAT,EAAkB;AACxB,MAAIgF,aAAa,IAAjB;AACA,MAAIiE,oBAAoB,IAAxB;AACA,QAAMtJ,QAAQqE,kBAAkB7E,OAAlB,EAA2Ba,OAA3B,CAAd;AACA,MAAIkJ,cAAcT,eAAe9I,KAAf,CAAlB;AACA,MAAI0D,cAAcF,WAAWxD,KAAX,CAAlB;AACA,MAAIwJ,qBAAqB,6DAAAC,CAAazJ,KAAb,CAAzB;AACA,MAAI0J,kBAAkB,IAAtB;AACA,MAAIC,wBAAwB,KAA5B;AACA,MAAIC,kBAAkB,EAAtB;;AAEA,WAASC,wBAAT,GAAoC;AACnC,OAAIP,sBAAsB,IAA1B,EAAgC;AAC/BA,sBAAkB1C,gBAAlB,GAAqC,IAArC;AACAvB,iBAAakE,YAAYD,iBAAZ,CAAb;AACAA,sBAAkB1C,gBAAlB,GAAqC,KAArC;AACA;AACD;;AAED,WAASd,uBAAT,CAAiCF,UAAjC,EAA6C;AAC5C+D,2BAAwB/D,UAAxB;AACA,OAAI8D,eAAJ,EAAqB;AACpBA,oBAAgB5D,uBAAhB,CAAwCF,UAAxC;AACA,QAAI0D,iBAAJ,EAAuB;AACtBjE,kBAAakE,YAAYD,iBAAZ,CAAb;AACA;AACD;AACD;;AAED,WAASQ,WAAT,CAAqBrF,SAArB,EAAgCC,kBAAhC,EAAoD;AACnD,SAAMlF,UAAUiF,UAAUjF,OAA1B;AACA,SAAM8B,aAAatB,MAAMsB,UAAzB;AACA,SAAMjB,UAAUoE,UAAUjE,UAAV,EAAhB;AACA,SAAMuJ,gBAAgB1I,aAAa7B,OAAb,EAAsBa,QAAQlB,WAA9B,EAA2CkB,QAAQf,iBAAnD,CAAtB;AACA,QAAK,IAAI0K,IAAI,CAAb,EAAgBA,IAAID,cAAcpH,MAAlC,EAA0CqH,GAA1C,EAA+C;AAC9C1I,eAAW0I,CAAX,IAAgBD,cAAcC,CAAd,CAAhB;AACA;;AAED,QAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAI1I,WAAWqB,MAAX,GAAoBoH,cAAcpH,MAAtD,EAA8DqH,GAA9D,EAAmE;AAClE1I,eAAW2I,GAAX;AACA;;AAEDxF,aAAU1C,MAAV,CAAiB8F,eAAjB;AACA/C,6BAA0BL,SAA1B,EAAqCC,kBAArC;AACA;;AAED1E,QAAM+B,MAAN,CAAamI,iBAAb,CAA+B,YAAW;AACzCL;AACA,GAFD;;AAIA,WAASM,OAAT,CAAiB1F,SAAjB,EAA4B;AAC3B;AACA;;AAED,SAAO;AACNjF,UADM;AAEN8B,eAAYtB,MAAMsB,UAFZ;AAGNlB,mBAAgBA,eAAeJ,KAAf,CAHV;AAINoK,aAAUpK,MAAM+B,MAAN,CAAasI,iBAJjB;AAKNjL,oBAAiBY,MAAMK,OAAN,CAAcjB,eALzB;AAMNJ,cAAWgB,MAAMK,OAAN,CAAcrB,SANnB;AAON+C,WAAQ/B,MAAM+B,MAPR;AAQNiD,uBAAoB,MAAM4E,eARpB;AASN9D,0BATM;AAUNqE,UAVM;AAWNL,cAXM;AAYNrE,0BAAuB,MAAMkE,qBAZvB;AAaNW,eAAY,UAASjH,aAAT,EAAwB;AACnCiG,wBAAoBjG,aAApB;AACAgC,iBAAakE,YAAYlG,aAAZ,CAAb;AACA;AACAmG,uBAAmB,EAAEnG,aAAF,EAAiBgC,UAAjB,EAAnB;AACA,IAlBK;AAmBN7B,eAAY,UAASH,aAAT,EAAwB;AACnCiG,wBAAoB,IAApB;AACAxD,4BAAwB,KAAxB;AACAyD,kBAAcT,eAAe9I,KAAf,CAAd;AACA0D,gBAAYL,aAAZ,EAA2BgC,UAA3B;AACAmE,uBAAmB,EAAEe,OAAO,IAAT,EAAnB;AACAf,yBAAqB,6DAAAC,CAAazJ,KAAb,CAArB;AACA0J,sBAAkB,IAAlB;AACAE,sBAAkB,EAAlB;AACA,IA5BK;AA6BNY,kBAAe,YAAW;AACzB,WAAOnF,UAAP;AACA,IA/BK;AAgCNoF,2BAAwB,UAAS,GAAGhE,MAAZ,EAAoB;AAC3C,WAAOsB,sBAAsB/H,KAAtB,EAA6B,GAAGyG,MAAhC,CAAP;AACA,IAlCK;AAmCNvB,uBAAqBwF,CAAD,IAAO;AAAEhB,sBAAkBgB,CAAlB;AAAsB,IAnC7C;AAoCN7E,uBAAoB,MAAM6D,eApCpB;AAqCNiB,iBAAc,MAAM;AACnBd;AACA,IAvCK;AAwCNrJ,eAAY,MAAMR,MAAMK;AAxClB,GAAP;AA0CA,EAhGD;AAiGA;;AAED,MAAMA,UAAU;AACfuK,cAAcC,SAAD,IAAe,CAAG,CADhB;AAEfC,aAAY,MAAM,CAAG,CAFN;AAGf5G,SAAQ,MAAM,CAAG,CAHF;AAIfjF,YAAW,MAJI;AAKfD,YAAW,SALI,EAKO;AACtBE,eAAc,EANC;AAOfC,cAAa,UAPE;AAQf4L,qBAAoB,IARL;AASfC,sBAAqB,eATN;AAUfC,iBAAgB,CAVD;AAWf3L,oBAAmB,GAXJ;AAYfF,kBAAkBkH,KAAD,IAAW;AAZb,CAAhB;;AAeA;AACA,+DAAe,UAAS9G,OAAT,EAAkBa,OAAlB,EAA2B;AACzC,OAAM6K,kBAAkB7B,UAAU7J,OAAV,CAAxB;AACA,OAAMiF,YAAYyG,gBAAgB7K,OAAhB,CAAlB;AACAb,SAAQ,4DAAR,IAA6BiF,SAA7B;AACA0G,CAAA,iDAAAA,CAASC,QAAT,CAAkB3G,SAAlB;AACA,QAAO;AACN4G,cAAYH,eADN;AAENf,WAAS,YAAW;AACnBgB,GAAA,iDAAAA,CAASG,UAAT,CAAoB7G,SAApB;AACAA,aAAU1C,MAAV,CAAiBoI,OAAjB;AACA1F,aAAU0F,OAAV,CAAkB1F,SAAlB;AACA;AANK,EAAP;AAQA,C;;;;;;;;;;;;;;ACzpBD;;AAEA,MAAM8G,WAAW,IAAjB,C,CAAuB;AACvB,MAAMC,WAAW,EAAjB,C,CAAqB;;AAErB,SAASC,mBAAT,CAA6BjM,OAA7B,EAAsCkM,IAAtC,EAA4C;AAC3C,KAAI/G,UAAUnF,OAAd;AACA,QAAOmF,OAAP,EAAgB;AACf,MAAI,0DAAAgH,CAAYhH,OAAZ,CAAJ,EAA0B;AACzB,UAAOA,OAAP;AACA;AACDA,YAAUA,QAAQzD,aAAlB;AACA;AACD;;AAED,SAAS0K,YAAT,CAAsBpM,OAAtB,EAA+BuC,MAA/B,EAAuC;AACtC,KAAI8J,cAAc,KAAlB;AACA,KAAIC,UAAU,IAAd;AACA,KAAIC,YAAY,IAAhB;AACA,KAAIC,YAAY,IAAhB;AACA,KAAIC,QAAQ,IAAZ;;AAEA,UAASC,OAAT,CAAiBC,UAAjB,EAA6BC,MAA7B,EAAqC;AACpCJ,cAAYG,UAAZ;AACAF,UAAQG,MAAR;AACAP,gBAAc,IAAd;AACA,MAAIA,WAAJ,EAAiB;AAChBQ;AACA;AACD;;AAED,UAASA,KAAT,GAAiB;AAChB,MAAIP,YAAY,IAAhB,EAAsB;AACrBA,aAAUQ,sBAAuBC,SAAD,IAAe;AAC9C,QAAIR,cAAc,IAAlB,EAAwB;AAAEA,iBAAYQ,SAAZ;AAAwB;AAClD,UAAMC,WAAWD,YAAYR,SAA7B;AACAA,gBAAYQ,SAAZ;AACA,QAAIE,eAAgBD,WAAW,IAAZ,GAAoBP,KAAvC;AACAQ,mBAAeT,cAAc,OAAd,GAAyB,IAAIS,YAA7B,GAA6CA,YAA5D;AACA,UAAMC,WAAW3K,OAAO0F,cAAP,CAAsBjI,OAAtB,IAAiCiN,YAAlD;AACA1K,WAAO4K,cAAP,CAAsBnN,OAAtB,EAA+BkN,QAA/B;AACA;AACAZ,cAAU,IAAV;AACAO;AACA,IAXS,CAAV;AAYA;AACD;;AAED,UAASO,IAAT,GAAgB;AACf,MAAIf,WAAJ,EAAiB;AAChBgB,wBAAqBf,OAArB;AACAD,iBAAc,KAAd;AACAE,eAAY,IAAZ;AACAD,aAAU,IAAV;AACA;AACD;;AAED,QAAO;AACNI,SADM;AAENU;AAFM,EAAP;AAIA;;AAGD,SAASE,iBAAT,CAA2B7K,GAA3B,EAAgC+D,WAAhC,EAA6C+G,kBAA7C,EAAiE;AAChE,OAAM,EAAE1K,KAAF,EAASC,GAAT,KAAiByK,kBAAvB;AACA,OAAMC,eAAe,GAArB;AACA,KAAI1K,MAAML,GAAN,GAAY+K,YAAhB,EAA8B;AAC7B,SAAO;AACNhB,cAAW,KADL;AAENiB,gBAAa,CAACD,gBAAgB1K,MAAML,GAAtB,CAAD,IAA+B+K;AAFtC,GAAP;AAIA,EALD,MAKO,IAAI/K,MAAMI,KAAN,GAAc2K,YAAlB,EAAgC;AACtC;AACA,SAAO;AACNhB,cAAW,OADL;AAENiB,gBAAa,CAACD,gBAAgB/K,MAAMI,KAAtB,CAAD,IAAiC2K;AAFxC,GAAP;AAIA;AACD;;AAGD,+DAAe,CAAC,EAAExN,OAAF,EAAWuC,MAAX,EAAmB1B,OAAnB,EAAD,KAAkC;AAChD,KAAI6M,UAAU,IAAd;AACA,OAAMxB,OAAOrL,QAAQlB,WAAR,KAAwB,UAAxB,GAAqC,GAArC,GAA2C,GAAxD;AACA,KAAIgO,mBAAmB1B,oBAAoBjM,OAApB,EAA6BkM,IAA7B,CAAvB;AACA,OAAM0B,uBAAuBrL,OAAOsL,oBAAP,CAA4BF,iBAAiBG,qBAAjB,EAA5B,CAA7B;AACA,KAAIC,WAAW3B,aAAapM,OAAb,EAAsBuC,MAAtB,CAAf;AACA,QAAO,CAAC,EAAEsB,aAAF,EAAiBgC,UAAjB,EAA6BkF,KAA7B,EAAD,KAA0C;AAChD,MAAI4C,gBAAJ,EAAsB;AACrB,OAAI5C,KAAJ,EAAW;AACVgD,aAASX,IAAT;AACA,WAAO,IAAP;AACA;AACD,OAAIvH,WAAWpD,GAAX,KAAmB,IAAvB,EAA6B;AAC5B,QAAIiL,YAAY,IAAhB,EAAsB;AACrBC,wBAAmB1B,oBAAoBjM,OAApB,EAA6BkM,IAA7B,CAAnB;AACA6B,cAASX,IAAT;AACAW,gBAAW3B,aAAauB,gBAAb,EAA+BpL,MAA/B,CAAX;AACA;AACD,UAAMyL,iBAAiBV,kBAAkBzH,WAAWpD,GAA7B,EAAkCoD,WAAWW,WAA7C,EAA0DoH,oBAA1D,CAAvB;AACA,QAAII,cAAJ,EAAoB;AACnBD,cAASrB,OAAT,CAAiBsB,eAAexB,SAAhC,EAA2CwB,eAAeP,WAAf,GAA6B1B,QAAxE;AACA,KAFD,MAEO;AACNgC,cAASX,IAAT;AACA;AACDM,cAAU7H,WAAWpD,GAArB;AACA,IAbD,MAaO;AACNsL,aAASX,IAAT;AACA;;AAEDM,aAAU7H,WAAWpD,GAArB;AACA;AACD,SAAO,IAAP;AACA,EA1BD;AA2BA,CAjCD,E;;;;;;;;;;;;;;;;;AClFA;AACA;;AAOO,SAASwL,cAAT,CAAwB,EAAEjO,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA+B1B,OAA/B,EAAxB,EAAkE;AACxE,QAAO,CAACqN,UAAD,EAAaxJ,MAAb,KAAwB;AAC9B,QAAM,EAAEN,YAAF,EAAgBD,UAAhB,EAA4BK,cAA5B,KAA+C0J,UAArD;AACA,MAAI9J,iBAAiB,IAArB,EAA2B;AAC1B+J,GAAA,4DAAAA,CAAcnO,OAAd,EAAuBoE,YAAvB;AACAtC,cAAWsM,MAAX,CAAkBhK,YAAlB,EAAgC,CAAhC;AACA;;AAED,MAAID,eAAe,IAAnB,EAAyB;AACxB,SAAM/B,UAAUb,SAASC,aAAT,CAAuB,KAAvB,CAAhB;AACAY,WAAQX,SAAR,GAAqB,GAAE,uDAAa,IAAGZ,QAAQlB,WAAY,IAAG,yDAAe,GAA7E;AACAyC,WAAQR,WAAR,CAAoB4C,eAAe6J,SAAf,CAAyB,IAAzB,CAApB;AACAjM,WAAQ,gEAAR,IAAiC,EAAjC;AACAkM,GAAA,yDAAAA,CAAWtO,OAAX,EAAoBoC,OAApB,EAA6B+B,UAA7B;AACA,OAAIA,cAAcrC,WAAWqB,MAA7B,EAAqC;AACpCrB,eAAW2D,IAAX,CAAgBrD,OAAhB;AACA,IAFD,MAEO;AACNN,eAAWsM,MAAX,CAAkBjK,UAAlB,EAA8B,CAA9B,EAAiC/B,OAAjC;AACA;AACD;;AAED,MAAIsC,MAAJ,EAAY;AACXA,UAAOwJ,UAAP;AACA;AACD,EAvBD;AAwBA;;AAEM,SAASK,gBAAT,GAA4B;AAClC,OAAMC,UAAU,CAAC,EAAExO,OAAF,EAAW8B,UAAX,EAAuBS,MAAvB,EAA+B1B,OAA/B,EAAD,KAA8C;AAC7D,SAAO,CAACqN,UAAD,EAAaxJ,MAAb,KAAwB;AAC9B,OAAIA,MAAJ,EAAY;AACXA,WAAOwJ,UAAP;AACA;AACD,GAJD;AAKA,EAND;;AAQA,QAAO;AACNM;AADM,EAAP;AAGA,C;;;;;;;;;;;;;;;;AC/CD;AACA;;AAIA,MAAMC,gBAAgB;AACrBC,OAAM,aADe;AAErBC,mBAAkB,YAFG;AAGrBlG,YAAW,WAHU;AAIrB5F,QAAO,MAJc;AAKrBC,MAAK,OALgB;AAMrB8L,eAAc,GANO;AAOrBC,aAAY,aAPS;AAQrBC,aAAY,aARS;AASrBC,cAAa,YATQ;AAUrBC,QAAO,QAVc;AAWrB5G,UAAS,OAXY;AAYrB6G,UAAS;AACR,eAAcC,GAAD,IAAU,eAAcA,GAAI;AADjC;AAZY,CAAtB;;AAiBA,MAAMC,cAAc;AACnBT,OAAM,cADa;AAEnBC,mBAAkB,WAFC;AAGnBlG,YAAW,WAHQ;AAInB5F,QAAO,KAJY;AAKnBC,MAAK,QALc;AAMnB8L,eAAc,GANK;AAOnBC,aAAY,cAPO;AAQnBC,aAAY,cARO;AASnBC,cAAa,WATM;AAUnBC,QAAO,QAVY;AAWnB5G,UAAS,QAXU;AAYnB6G,UAAS;AACR,eAAcC,GAAD,IAAU,iBAAgBA,GAAI;AADnC;AAZU,CAApB;;AAiBA,SAASE,yBAAT,CAAmCnN,GAAnC,EAAwC;AACvC,UAASoN,GAAT,CAAaC,GAAb,EAAkBC,IAAlB,EAAwB;AACvB,QAAMC,aAAavN,IAAIsN,IAAJ,CAAnB;AACA,SAAOD,IAAIE,cAAcD,IAAlB,CAAP;AACA;;AAED,UAASzL,GAAT,CAAawL,GAAb,EAAkBC,IAAlB,EAAwBE,KAAxB,EAA+B;AAC9B3C,wBAAsB,MAAM;AAC3BwC,OAAIrN,IAAIsN,IAAJ,CAAJ,IAAiBtN,IAAIgN,OAAJ,CAAYM,IAAZ,IAAoBtN,IAAIgN,OAAJ,CAAYM,IAAZ,EAAkBE,KAAlB,CAApB,GAA+CA,KAAhE;AACA,GAFD;AAGA;;AAED,QAAO,EAAEJ,GAAF,EAAOvL,GAAP,EAAP;AACA;;AAEc,SAASiB,aAAT,CAAuB2K,gBAAvB,EAAyC/P,WAAzC,EAAsDgQ,kBAAtD,EAA0E;AACxFD,kBAAiB,gEAAjB,IAA0C,CAA1C;AACA,OAAM5P,oBAAoB6P,kBAA1B;AACA,OAAM1N,MAAMtC,gBAAgB,YAAhB,GAA+B8O,aAA/B,GAA+CU,WAA3D;AACA,OAAMS,aAAaR,0BAA0BnN,GAA1B,CAAnB;AACA,OAAM4N,SAAS;AACdC,eAAa;AADC,EAAf;AAGA,KAAIC,2BAA2B,IAA/B;;AAEAC,QAAOC,gBAAP,CAAwB,QAAxB,EAAkC,YAAW;AAC5CC,gCAA8BR,gBAA9B;AACA;AACA,EAHD;;AAKA/L,YAAW,MAAM;AAChBwM;AACA,EAFD,EAEG,EAFH;AAGA;;AAEA,OAAMC,iBAAiB,0DAAyBV,gBAAzB,EAA2C,YAAW;AAC5EQ,gCAA8BR,gBAA9B;AACAK,8BAA4BA,0BAA5B;AACA,EAHsB,CAAvB;AAIA,UAASI,UAAT,GAAsB;AACrBD,gCAA8BR,gBAA9B;AACAW,2BAAyBX,gBAAzB;AACA;;AAED,KAAIY,WAAJ;AACA,UAASJ,6BAAT,CAAuCR,gBAAvC,EAAyD;AACxDG,SAAOzG,IAAP,GAAc,wDAAuBsG,gBAAvB,CAAd;AACAG,SAAOS,WAAP,GAAqB,sDAAqBZ,gBAArB,EAAuCG,OAAOzG,IAA9C,CAArB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAED,UAASiH,wBAAT,CAAkCX,gBAAlC,EAAoD;AACnD,QAAMtG,OAAOsG,iBAAiB5B,qBAAjB,EAAb;AACA+B,SAAOU,MAAP,GAAgB,CAACnH,KAAKoH,KAAL,GAAapH,KAAKqH,IAAnB,IAA2Bf,iBAAiBgB,WAA5D;AACAb,SAAOc,MAAP,GAAgB,CAACvH,KAAKwH,MAAL,GAAcxH,KAAKyH,GAApB,IAA2BnB,iBAAiBoB,YAA5D;AACA;;AAED,UAAS7H,sBAAT,GAAkC;AACjC,SAAO;AACNG,SAAMyG,OAAOzG,IADP;AAENkH,gBAAaT,OAAOS;AAFd,GAAP;AAIA;;AAED,UAASzC,oBAAT,CAA8BzE,IAA9B,EAAoC;AACnC,SAAO;AACNvG,UAAO+M,WAAWP,GAAX,CAAejG,IAAf,EAAqB,OAArB,CADD;AAENtG,QAAK8M,WAAWP,GAAX,CAAejG,IAAf,EAAqB,KAArB;AAFC,GAAP;AAIA;;AAED,UAASvB,sBAAT,GAAkC;AACjC,QAAMhF,QAAQ+M,WAAWP,GAAX,CAAeQ,OAAOzG,IAAtB,EAA4B,OAA5B,IAAuCyG,OAAOC,WAA5D;AACA,QAAMhN,MAAM8M,WAAWP,GAAX,CAAeQ,OAAOzG,IAAtB,EAA4B,KAA5B,IAAqCyG,OAAOC,WAAxD;AACA,SAAO,EAAEjN,KAAF,EAASC,GAAT,EAAP;AACA;;AAED,UAASiO,iCAAT,GAA6C;AAC5C,QAAMlO,QAAQ+M,WAAWP,GAAX,CAAeQ,OAAOS,WAAtB,EAAmC,OAAnC,IAA8CT,OAAOC,WAAnE;AACA,QAAMhN,MAAM8M,WAAWP,GAAX,CAAeQ,OAAOS,WAAtB,EAAmC,KAAnC,IAA4CT,OAAOC,WAA/D;AACA,SAAO,EAAEjN,KAAF,EAASC,GAAT,EAAP;AACA;;AAED,UAAS+H,iBAAT,GAA6B;AAC5B,SAAO,EAAE0F,QAAQV,OAAOU,MAAjB,EAAyBI,QAAQd,OAAOc,MAAxC,EAAP;AACA;;AAED,UAASlK,OAAT,CAAiBzG,OAAjB,EAA0B;AACzB,SAAO4P,WAAWP,GAAX,CAAerP,OAAf,EAAwB,MAAxB,IAAkC4P,WAAWP,GAAX,CAAeQ,MAAf,EAAuB,OAAvB,CAAzC;AACA;;AAED,UAASmB,yBAAT,CAAmChR,OAAnC,EAA4C;AAC3C,QAAMiR,WAAWrB,WAAWP,GAAX,CAAerP,OAAf,EAAwB,kBAAxB,KAA+CA,QAAQ,2DAAR,KAA6B,CAA5E,CAAjB;AACA,SAAOiR,WAAWrB,WAAWP,GAAX,CAAeQ,MAAf,EAAuB,OAAvB,CAAlB;AACA;;AAED,UAAS9M,WAAT,CAAqB/C,OAArB,EAA8B;AAC7B,QAAM6C,QAAQmO,0BAA0BhR,OAA1B,KAAsC4P,WAAWP,GAAX,CAAeQ,OAAOzG,IAAtB,EAA4B,OAA5B,IAAuCyG,OAAOC,WAApF,IAAmGF,WAAWP,GAAX,CAAeK,gBAAf,EAAiC,aAAjC,CAAjH;AACA,SAAO;AACN7M,QADM;AAENC,QAAKD,QAAQ4D,QAAQzG,OAAR,IAAmB4P,WAAWP,GAAX,CAAeQ,MAAf,EAAuB,OAAvB;AAF1B,GAAP;AAIA;;AAED,UAASzH,OAAT,CAAiBpI,OAAjB,EAA0B0O,IAA1B,EAAgC;AAC/BkB,aAAW9L,GAAX,CAAe9D,OAAf,EAAwB,SAAxB,EAAmC0O,IAAnC;AACA;;AAED,UAASwC,YAAT,CAAsBhL,QAAtB,EAAgC;AAC/B,SAAO0J,WAAWP,GAAX,CAAenJ,QAAf,EAAyB,cAAzB,CAAP;AACA;;AAED,UAASiL,8BAAT,CAAwClM,SAAxC,EAAmD;AAClDA,YAAU1C,MAAV,CAAiB8F,eAAjB;AACApD,YAAUkG,YAAV;AACA,MAAIlG,UAAUO,kBAAV,EAAJ,EAAoC;AACnCP,aAAUO,kBAAV,GAA+BnC,OAA/B,CAAuCC,KAAK6N,+BAA+B7N,CAA/B,CAA5C;AACA;AACD;;AAED,UAASC,cAAT,CAAwBvD,OAAxB,EAAiC8P,WAAjC,EAA8C;AAC7C,MAAIsB,eAAepR,OAAf,MAA4B8P,WAAhC,EAA6C;AAC5CF,cAAW9L,GAAX,CAAe9D,QAAQG,KAAvB,EAA8B,WAA9B,EAA2C2P,WAA3C;AACA9P,WAAQ,2DAAR,IAA4B8P,WAA5B;;AAEA,OAAI9P,QAAQ,gEAAR,CAAJ,EAAoC;AACnC2D,eAAW,MAAM;AAChB3D,aAAQ,gEAAR,EAA+BqD,OAA/B,CAAuCC,KAAK;AAC3C6N,qCAA+B7N,CAA/B;AACA,MAFD;AAGA,KAJD,EAIGxD,oBAAoB,EAJvB;AAKA;AACD;AACD;;AAED,UAASsR,cAAT,CAAwBpR,OAAxB,EAAiC;AAChC,SAAOA,QAAQ,2DAAR,CAAP;AACA;;AAED,UAASwD,aAAT,CAAuBxD,OAAvB,EAAgCqR,SAAhC,EAA2C;AAC1C,MAAIrR,QAAQ,0DAAR,MAA6BH,SAA7B,IAA0CG,QAAQ,0DAAR,MAA6BqR,SAA3E,EAAsF;AACrFrR,WAAQG,KAAR,CAAcmR,UAAd,GAA2BD,YAAY,SAAZ,GAAwB,QAAnD;AACArR,WAAQ,0DAAR,IAA2BqR,SAA3B;AACA;AACD;;AAED,UAASA,SAAT,CAAmBrR,OAAnB,EAA4B;AAC3B,SAAOA,QAAQ,0DAAR,MAA6BH,SAA7B,IAA0CG,QAAQ,0DAAR,CAAjD;AACA;;AAED,UAASuR,eAAT,CAAyBC,CAAzB,EAA4BC,CAA5B,EAA+B;AAC9B,QAAM,EAAEhB,IAAF,EAAQI,GAAR,EAAaL,KAAb,EAAoBI,MAApB,KAA+Bf,OAAOS,WAA5C;AACA,MAAI3Q,gBAAgB,UAApB,EAAgC;AAC/B,UAAO6R,IAAIf,IAAJ,IAAYe,IAAIhB,KAAhB,IAAyBiB,IAAIZ,GAA7B,IAAoCY,IAAIb,MAA/C;AACA,GAFD,MAEO;AACN,UAAOY,IAAIf,IAAJ,IAAYe,IAAIhB,KAAhB,IAA0BiB,IAAIZ,GAA9B,IAAqCY,IAAIb,MAAhD;AACA;AACD;;AAED,UAASlG,iBAAT,CAA2BgH,QAA3B,EAAqC;AACpC3B,6BAA2B2B,QAA3B;AACA;;AAED,UAASvI,wBAAT,CAAkCtG,KAAlC,EAAyC;AACxC,MAAIgO,MAAM,CAAV;AACA,MAAIJ,OAAO,CAAX;AACA,MAAI9Q,gBAAgB,YAApB,EAAkC;AACjC8Q,UAAO5N,KAAP;AACAgO,SAAMhB,OAAOzG,IAAP,CAAYyH,GAAlB;AACA,GAHD,MAGO;AACNJ,UAAOZ,OAAOzG,IAAP,CAAYqH,IAAnB;AACAI,SAAMhO,KAAN;AACA;;AAED,SAAO;AACNgO,MADM,EACDJ;AADC,GAAP;AAGA;;AAED,UAAS1I,aAAT,CAAuB/H,OAAvB,EAAgC;AAC/B,SAAO4P,WAAWP,GAAX,CAAerP,OAAf,EAAwB,YAAxB,CAAP;AACA;;AAED,UAASiI,cAAT,CAAwBjI,OAAxB,EAAiC;AAChC,SAAO4P,WAAWP,GAAX,CAAerP,OAAf,EAAwB,aAAxB,CAAP;AACA;;AAED,UAASmN,cAAT,CAAwBnN,OAAxB,EAAiCkP,GAAjC,EAAsC;AACrC,SAAOU,WAAW9L,GAAX,CAAe9D,OAAf,EAAwB,aAAxB,EAAuCkP,GAAvC,CAAP;AACA;;AAED,UAASvE,OAAT,GAAmB;AAClB,MAAIyF,cAAJ,EAAoB;AACnBA,kBAAezF,OAAf;AACA;;AAED,MAAI2F,WAAJ,EAAiB;AAChBA,eAAY7M,UAAZ,CAAuBC,WAAvB,CAAmC4M,WAAnC;AACAA,iBAAc,IAAd;AACA;AACD;;AAED,UAAStK,WAAT,CAAqBE,QAArB,EAA+B;AAC9B,SAAOqL,gBAAgBrL,SAASsL,CAAzB,EAA4BtL,SAASuL,CAArC,IAA0CP,aAAahL,QAAb,CAA1C,GAAmE,IAA1E;AACA;;AAED,UAASmC,eAAT,GAA2B;AAC1B6H,gCAA8BR,gBAA9B;AACA;;AAED,QAAO;AACNjJ,SADM;AAEN;AACAwC,wBAHM;AAIN4E,sBAJM;AAKNhG,wBALM;AAMNkJ,mCANM;AAONhO,aAPM;AAQNmO,cARM;AASN3N,gBATM;AAUN6N,gBAVM;AAWN5N,eAXM;AAYN6N,WAZM;AAaNE,iBAbM;AAcN5G,SAdM;AAeNE,mBAfM;AAgBNH,mBAhBM;AAiBNtC,SAjBM;AAkBNe,0BAlBM;AAmBNpB,eAnBM;AAoBNE,gBApBM;AAqBNkF,gBArBM;AAsBNgD,YAtBM;AAuBN9H,iBAvBM;AAwBNrC;AAxBM,EAAP;AA0BA,C;;;;;;;;;;;;;;;;AC/RD;AACA;AACA;;AAEA,MAAM2L,aAAa,CAAC,WAAD,EAAc,YAAd,CAAnB;AACA,MAAMC,aAAa,CAAC,WAAD,EAAc,WAAd,CAAnB;AACA,MAAMC,gBAAgB,CAAC,SAAD,EAAY,UAAZ,CAAtB;;AAEA,IAAIC,0BAA0B,IAA9B;AACA,IAAIC,iBAAiB,IAArB;AACA,IAAIC,YAAY,IAAhB;AACA,IAAInO,gBAAgB,IAApB;AACA,IAAIoO,aAAa,EAAjB;AACA,IAAIC,aAAa,KAAjB;;AAEA;;AAEA,MAAMC,WAAW,iDAAjB;;AAEA,SAASC,YAAT,GAAwB;AACvBC;AACA;;AAED,SAASA,gBAAT,GAA4B;AAC3BV,YAAWtO,OAAX,CAAmB6H,KAAK;AACvB8E,SAAOzO,QAAP,CAAgB0O,gBAAhB,CAAiC/E,CAAjC,EAAoCoH,WAApC,EAAiD,EAACC,SAAS,KAAV,EAAjD;AACA,EAFD;AAGA;;AAED,SAASC,gBAAT,GAA4B;AAC3BZ,YAAWvO,OAAX,CAAmB6H,KAAK;AACvB8E,SAAOzO,QAAP,CAAgB0O,gBAAhB,CAAiC/E,CAAjC,EAAoCuH,WAApC,EAAiD,EAAEF,SAAS,KAAX,EAAjD;AACA,EAFD;AAGA;;AAED,SAASG,mBAAT,GAA+B;AAC9Bd,YAAWvO,OAAX,CAAmB6H,KAAK;AACvB8E,SAAOzO,QAAP,CAAgBoR,mBAAhB,CAAoCzH,CAApC,EAAuCuH,WAAvC,EAAoD,EAAEF,SAAS,KAAX,EAApD;AACA,EAFD;AAGA;;AAED,SAASK,mBAAT,GAA+B;AAC9Bf,eAAcxO,OAAd,CAAsB6H,KAAK;AAC1B8E,SAAOzO,QAAP,CAAgB0O,gBAAhB,CAAiC/E,CAAjC,EAAoC2H,SAApC,EAA+C,EAAEN,SAAS,KAAX,EAA/C;AACA,EAFD;AAGA;;AAED,SAASO,sBAAT,GAAkC;AACjCjB,eAAcxO,OAAd,CAAsB6H,KAAK;AAC1B8E,SAAOzO,QAAP,CAAgBoR,mBAAhB,CAAoCzH,CAApC,EAAuC2H,SAAvC,EAAkD,EAAEN,SAAS,KAAX,EAAlD;AACA,EAFD;AAGA;;AAED,SAASQ,eAAT,CAAyB/S,OAAzB,EAAkC,EAAEwR,CAAF,EAAKC,CAAL,EAAlC,EAA4CxM,SAA5C,EAAuD;AACtD,OAAM,EAAEsL,SAAS,CAAX,EAAcI,SAAS,CAAvB,KAA6B1L,UAAU2F,QAAV,EAAnC;AACA,OAAM,EAAE6F,IAAF,EAAQI,GAAR,EAAaL,KAAb,EAAoBI,MAApB,KAA+B5Q,QAAQ8N,qBAAR,EAArC;AACA,KAAI7I,UAAUjE,UAAV,GAAuBgS,SAA3B,EAAsC;AACrCC,EAAA,gDAAejT,QAAQkT,UAAR,CAAmB,CAAnB,CAAf,EAAsCjO,UAAUjE,UAAV,GAAuBgS,SAA7D;AACA;AACD,OAAMG,OAAO1C,OAAQ,CAACD,QAAQC,IAAT,IAAiB,CAAtC;AACA,OAAM2C,OAAOvC,MAAO,CAACD,SAASC,GAAV,IAAiB,CAArC;AACA,OAAMvP,MAAMC,SAASC,aAAT,CAAuB,KAAvB,CAAZ;AACAF,KAAInB,KAAJ,CAAU+F,QAAV,GAAqB,OAArB;AACA5E,KAAInB,KAAJ,CAAUkT,aAAV,GAA0B,MAA1B;AACA/R,KAAInB,KAAJ,CAAUsQ,IAAV,GAAiBA,OAAO,IAAxB;AACAnP,KAAInB,KAAJ,CAAU0Q,GAAV,GAAgBA,MAAM,IAAtB;AACAvP,KAAInB,KAAJ,CAAUmT,KAAV,GAAkB9C,QAAQC,IAAR,GAAe,IAAjC;AACAnP,KAAInB,KAAJ,CAAUoT,MAAV,GAAmB3C,SAASC,GAAT,GAAe,IAAlC;AACAvP,KAAInB,KAAJ,CAAUqT,QAAV,GAAqB,QAArB;AACAlS,KAAIG,SAAJ,GAAgB,qDAAhB;AACA,OAAMgS,QAAQzT,QAAQqO,SAAR,CAAkB,IAAlB,CAAd;AACAoF,OAAMtT,KAAN,CAAYmT,KAAZ,GAAqB,CAAC9C,QAAQC,IAAT,IAAiBF,MAAlB,GAA4B,IAAhD;AACAkD,OAAMtT,KAAN,CAAYoT,MAAZ,GAAsB,CAAC3C,SAASC,GAAV,IAAiBF,MAAlB,GAA4B,IAAjD;AACA8C,OAAMtT,KAAN,CAAYuT,SAAZ,GAAyB,WAAUnD,UAAU,CAAE,KAAII,UAAU,CAAE,MAA/D;AACA8C,OAAMtT,KAAN,CAAYwT,eAAZ,GAA8B,OAA9B;AACAF,OAAMtT,KAAN,CAAYyT,MAAZ,GAAqB,KAArB;AACAtS,KAAIM,WAAJ,CAAgB6R,KAAhB;;AAEA,QAAO;AACNI,SAAOvS,GADD;AAENwS,eAAa,EAAEtC,GAAG2B,OAAO3B,CAAZ,EAAeC,GAAG2B,OAAO3B,CAAzB,EAFP;AAGNsC,iBAAe,EAAEtD,MAAMA,OAAOe,CAAf,EAAkBX,KAAKA,MAAMY,CAA7B,EAHT;AAINuC,eAAaxD,QAAQC,IAJf;AAKNwD,gBAAcrD,SAASC;AALjB,EAAP;AAOA;;AAED,SAASqD,gBAAT,CAA0BC,gBAA1B,EAA4C;AAC3C,OAAMlP,YAAYgN,WAAWmC,MAAX,CAAkB9Q,KAAK6Q,iBAAiBzS,aAAjB,KAAmC4B,EAAEtD,OAA5D,EAAqE,CAArE,CAAlB;AACA,OAAMqU,iBAAiBpP,UAAUnD,UAAV,CAAqBX,OAArB,CAA6BgT,gBAA7B,CAAvB;AACA,QAAO;AACNlP,WADM;AAENjF,WAASmU,gBAFH;AAGNrO,gBAAcuO,cAHR;AAIN9P,WAASU,UAAUrF,eAAV,CAA0ByU,cAA1B,CAJH;AAKNtQ,iBAAe,IALT;AAMNmC,YAAU,EAAEsL,GAAG,CAAL,EAAQC,GAAG,CAAX,EANJ;AAONjS,aAAWyF,UAAUzF;AAPf,EAAP;AASA;;AAED,SAAS8U,mBAAT,CAA6B5C,QAA7B,EAAuC;AACtC,UAAS6C,OAAT,GAAmB;AAClBtB,EAAA,mDAAkBjB,UAAU6B,KAA5B,EAAmC,UAAnC;AACA7B,YAAU6B,KAAV,CAAgB1T,KAAhB,CAAsBC,kBAAtB,GAA2C,IAA3C;AACAmB,WAASiT,IAAT,CAAc9Q,WAAd,CAA0BsO,UAAU6B,KAApC;AACAnC;AACA;;AAED,UAAS+C,sBAAT,CAAgC,EAAE5D,GAAF,EAAOJ,IAAP,EAAhC,EAA+CiE,QAA/C,EAAyD;AACxDzB,EAAA,gDAAejB,UAAU6B,KAAzB,EAAgC,UAAhC;AACA7B,YAAU6B,KAAV,CAAgB1T,KAAhB,CAAsBC,kBAAtB,GAA2CsU,WAAW,IAAtD;AACA1C,YAAU6B,KAAV,CAAgB1T,KAAhB,CAAsBsQ,IAAtB,GAA6BA,OAAO,IAApC;AACAuB,YAAU6B,KAAV,CAAgB1T,KAAhB,CAAsB0Q,GAAtB,GAA4BA,MAAM,IAAlC;AACAlN,aAAW,YAAW;AACrB4Q;AACA,GAFD,EAEGG,WAAW,EAFd;AAGA;;AAED,KAAI7Q,cAAcE,aAAlB,EAAiC;AAChC,QAAMkB,YAAYgN,WAAWmC,MAAX,CAAkB9Q,KAAKA,EAAEtD,OAAF,KAAc6D,cAAcE,aAAnD,EAAkE,CAAlE,CAAlB;AACA,QAAM8B,aAAaZ,UAAU+F,aAAV,EAAnB;AACAyJ,yBAAuB5O,WAAWgB,cAAX,CAA0BuC,IAAjD,EAAuDnG,KAAK0R,GAAL,CAAS,GAAT,EAAc1P,UAAUjE,UAAV,GAAuBlB,iBAAvB,GAA2C,CAAzD,CAAvD;AACA,EAJD,MAIO;AACN,QAAMmF,YAAYgN,WAAWmC,MAAX,CAAkB9Q,KAAKA,MAAMO,cAAcoB,SAA3C,EAAsD,CAAtD,CAAlB;AACA,MAAIA,UAAUjE,UAAV,GAAuBvB,SAAvB,KAAqC,MAAzC,EAAiD;AAChD,SAAM,EAAE2E,YAAF,EAAgBoC,WAAhB,KAAgCvB,UAAU+F,aAAV,EAAtC;AACA,SAAMzI,SAAS0C,UAAU1C,MAAzB;AACA;AACA0C,aAAUgG,sBAAV,CAAiC;AAChCpF,gBAAY;AACXzB,iBADW;AAEXD,iBAAYC,YAFD;AAGXoC;AAHW;AADoB,IAAjC;AAOA,SAAMoO,mBAAmBxQ,eAAe,CAAf,GAAmB7B,OAAOQ,WAAP,CAAmBkC,UAAUnD,UAAV,CAAqBsC,eAAe,CAApC,CAAnB,EAA2DtB,GAA9E,GAAoFP,OAAOsF,sBAAP,GAAgChF,KAA7I;AACA4R,0BAAuBlS,OAAO4G,wBAAP,CAAgCyL,gBAAhC,CAAvB,EAA0E3P,UAAUjE,UAAV,GAAuBlB,iBAAjG;AACA,GAbD,MAaO;AACNmT,GAAA,gDAAejB,UAAU6B,KAAzB,EAAgC,UAAhC;AACA7B,aAAU6B,KAAV,CAAgB1T,KAAhB,CAAsBC,kBAAtB,GAA2C6E,UAAUjE,UAAV,GAAuBlB,iBAAvB,GAA2C,IAAtF;AACAkS,aAAU6B,KAAV,CAAgB1T,KAAhB,CAAsB0U,OAAtB,GAAgC,GAAhC;AACA7C,aAAU6B,KAAV,CAAgB1T,KAAhB,CAAsBuT,SAAtB,GAAkC,aAAlC;AACA/P,cAAW,YAAW;AACrB4Q;AACA,IAFD,EAEGtP,UAAUjE,UAAV,GAAuBlB,iBAF1B;AAGA;AACD;AACD;;AAED,MAAMgV,4BAA6B,SAASA,yBAAT,GAAqC;AACvE,KAAIC,UAAJ;AACA,KAAIC,KAAJ;AACA,KAAIC,GAAJ;AACA,KAAIC,QAAQ,IAAZ;AACA,OAAMC,gBAAgB,CAAtB;AACA,OAAMC,iBAAiB,CAAvB;;AAEA,UAASC,MAAT,CAAgBC,KAAhB,EAAuB;AACtB,QAAM,EAAEC,SAASC,QAAX,EAAqBC,SAASC,QAA9B,KAA2CC,gBAAgBL,KAAhB,CAAjD;AACA,MAAI,CAACN,KAAL,EAAY;AACX,OAAI/R,KAAK2S,GAAL,CAASb,WAAWQ,OAAX,GAAqBC,QAA9B,IAA0CL,aAA1C,IAA2DlS,KAAK2S,GAAL,CAASb,WAAWU,OAAX,GAAqBC,QAA9B,IAA0CP,aAAzG,EAAwH;AACvH,WAAOU,cAAP;AACA;AACD,GAJD,MAIO;AACN,OAAI5S,KAAK2S,GAAL,CAASb,WAAWQ,OAAX,GAAqBC,QAA9B,IAA0CJ,cAA1C,IAA4DnS,KAAK2S,GAAL,CAASb,WAAWU,OAAX,GAAqBC,QAA9B,IAA0CN,cAA1G,EAA0H;AACzHU;AACA;AACD;AACD;;AAED,UAASC,IAAT,GAAgB;AAAED;AAAoB;AACtC,UAASE,UAAT,GAAsB;AAAEF;AAAoB;;AAE5C,UAASG,cAAT,GAA0B;AACzB,MAAIjB,KAAJ,EAAW;AACVE,WAAQvR,WAAWkS,YAAX,EAAyBb,KAAzB,CAAR;AACA;;AAEDpD,aAAWvO,OAAX,CAAmB6H,KAAK8E,OAAOzO,QAAP,CAAgB0O,gBAAhB,CAAiC/E,CAAjC,EAAoCmK,MAApC,CAAxB,EAAqE,EAAE9C,SAAS,KAAX,EAArE;AACAV,gBAAcxO,OAAd,CAAsB6H,KAAK8E,OAAOzO,QAAP,CAAgB0O,gBAAhB,CAAiC/E,CAAjC,EAAoC6K,IAApC,CAA3B,EAAsE,EAAExD,SAAS,KAAX,EAAtE;AACAhR,WAAS0O,gBAAT,CAA0B,MAA1B,EAAkC+F,UAAlC,EAA8C,EAAEzD,SAAS,KAAX,EAA9C;AACA;;AAED,UAASuD,eAAT,GAA2B;AAC1BI,eAAahB,KAAb;AACAtD,aAAWvO,OAAX,CAAmB6H,KAAK8E,OAAOzO,QAAP,CAAgBoR,mBAAhB,CAAoCzH,CAApC,EAAuCmK,MAAvC,CAAxB,EAAwE,EAAE9C,SAAS,KAAX,EAAxE;AACAV,gBAAcxO,OAAd,CAAsB6H,KAAK8E,OAAOzO,QAAP,CAAgBoR,mBAAhB,CAAoCzH,CAApC,EAAuC6K,IAAvC,CAA3B,EAAyE,EAAExD,SAAS,KAAX,EAAzE;AACAhR,WAASoR,mBAAT,CAA6B,MAA7B,EAAqCqD,UAArC,EAAiD,EAAEzD,SAAS,KAAX,EAAjD;AACA;;AAED,UAASsD,YAAT,GAAwB;AACvBK,eAAahB,KAAb;AACAY;AACAb;AACA;;AAED,QAAO,UAASkB,WAAT,EAAsBC,MAAtB,EAA8BC,IAA9B,EAAoC;AAC1CtB,eAAaY,gBAAgBQ,WAAhB,CAAb;AACAnB,UAAQoB,WAAWjE,WAAW,GAAX,GAAiB,CAA5B,CAAR;AACA8C,QAAMoB,IAAN;;AAEAJ;AACA,EAND;AAOA,CAtDiC,EAAlC;;AAwDA,SAAS3D,WAAT,CAAqBgD,KAArB,EAA4B;AAC3B,OAAMpK,IAAIyK,gBAAgBL,KAAhB,CAAV;AACA,KAAI,CAACpD,UAAL,EAAiB;AAChBH,mBAAiB,iDAAgB7G,EAAEoL,MAAlB,EAA0B,MAAM,uDAAhC,CAAjB;AACA,MAAIvE,cAAJ,EAAoB;AACnB,SAAMrC,mBAAmB,iDAAgBqC,cAAhB,EAAgC,MAAM,yDAAtC,CAAzB;AACA,SAAM9M,YAAYgN,WAAWmC,MAAX,CAAkB9Q,KAAKA,EAAEtD,OAAF,KAAc0P,gBAArC,EAAuD,CAAvD,CAAlB;AACA,SAAMnE,qBAAqBtG,UAAUjE,UAAV,GAAuBuK,kBAAlD;AACA,SAAMC,sBAAsBvG,UAAUjE,UAAV,GAAuBwK,mBAAnD;;AAEA,OAAI+K,YAAY,IAAhB;AACA,OAAIhL,sBAAsB,CAAC,iDAAgBL,EAAEoL,MAAlB,EAA0B/K,kBAA1B,CAA3B,EAA0E;AACzEgL,gBAAY,KAAZ;AACA;;AAED,OAAI/K,uBAAuB,iDAAgBN,EAAEoL,MAAlB,EAA0B9K,mBAA1B,CAA3B,EAA2E;AAC1E+K,gBAAY,KAAZ;AACA;;AAED,OAAIA,SAAJ,EAAe;AACdjB,UAAMkB,cAAN;AACA1B,8BAA0B5J,CAA1B,EAA6BjG,UAAUjE,UAAV,GAAuByK,cAApD,EAAoE,MAAM;AACzE9H,gBAAW,MAAM;AAChBqM,aAAOyG,YAAP,GAAsBC,KAAtB;AACA,MAFD,EAEG,CAFH;AAGAlE;AACAI;AACA,KAND;AAOA;AACD;AACD;AACD;;AAED,SAASC,SAAT,GAAqB;AACpBH;AACAI;AACA,KAAIjP,aAAJ,EAAmB;AAClByQ,sBAAoB,MAAM;AACzB/S,YAASiT,IAAT,CAAcrU,KAAd,CAAoBwW,WAApB,GAAkC,IAAlC;AACA,IAAC7E,2BAA2B,EAA5B,EAAgCzO,OAAhC,CAAwCC,KAAK;AAC5C2P,IAAA,mDAAkB3P,EAAEtD,OAApB,EAA6B,4DAA7B;AACAsD,MAAEU,UAAF,CAAaH,aAAb;AACA,IAHD;;AAKAiO,6BAA0B,IAA1B;AACAC,oBAAiB,IAAjB;AACAC,eAAY,IAAZ;AACAnO,mBAAgB,IAAhB;AACAqO,gBAAa,KAAb;AACA,GAZD;AAaA;AACD;;AAED,SAASyD,eAAT,CAAyBzK,CAAzB,EAA4B;AAC3B,QAAOA,EAAE0L,OAAF,GAAY1L,EAAE0L,OAAF,CAAU,CAAV,CAAZ,GAA2B1L,CAAlC;AACA;;AAED,SAASuH,WAAT,CAAqB6C,KAArB,EAA4B;AAC3BA,OAAMkB,cAAN;AACA,OAAMtL,IAAIyK,gBAAgBL,KAAhB,CAAV;AACA,KAAI,CAACzR,aAAL,EAAoB;AACnBqO,eAAa,IAAb;AACA,QAAMjN,YAAYgN,WAAWmC,MAAX,CAAkB9Q,KAAKyO,eAAerQ,aAAf,KAAiC4B,EAAEtD,OAA1D,EAAmE,CAAnE,CAAlB;AACA8R,4BAA0BG,WAAWmC,MAAX,CAAkB9Q,KAAKA,EAAE1C,cAAF,CAAiBqE,SAAjB,CAAvB,CAA1B;AACA6M,0BAAwBzO,OAAxB,CAAgCC,KAAK,gDAAeA,EAAEtD,OAAjB,EAA0B,4DAA1B,CAArC;AACA8R,0BAAwBzO,OAAxB,CAAgCC,KAAKA,EAAEgH,WAAF,CAAchH,CAAd,EAAiBwO,uBAAjB,CAArC;;AAEA;AACAjO,kBAAgBqQ,iBAAiBnC,cAAjB,CAAhB;AACAC,cAAYe,gBAAgBhB,cAAhB,EAAgC,EAAEP,GAAGtG,EAAEqK,OAAP,EAAgB9D,GAAGvG,EAAEuK,OAArB,EAAhC,EAAgE5R,cAAcoB,SAA9E,CAAZ;AACApB,gBAAcqC,QAAd,GAAyB;AACxBsL,MAAGtG,EAAEqK,OAAF,GAAYvD,UAAU8B,WAAV,CAAsBtC,CADb;AAExBC,MAAGvG,EAAEuK,OAAF,GAAYzD,UAAU8B,WAAV,CAAsBrC;AAFb,GAAzB;;AAKAlQ,WAASiT,IAAT,CAAc5S,WAAd,CAA0BoQ,UAAU6B,KAApC;AACA,EAhBD,MAgBO;AACN;AACA7B,YAAU6B,KAAV,CAAgB1T,KAAhB,CAAsBsQ,IAAtB,GAA8B,GAAEvF,EAAEqK,OAAF,GAAYvD,UAAU+B,aAAV,CAAwBtD,IAAK,IAAzE;AACAuB,YAAU6B,KAAV,CAAgB1T,KAAhB,CAAsB0Q,GAAtB,GAA6B,GAAE3F,EAAEuK,OAAF,GAAYzD,UAAU+B,aAAV,CAAwBlD,GAAI,IAAvE;AACAhN,gBAAcqC,QAAd,CAAuBsL,CAAvB,GAA2BtG,EAAEqK,OAAF,GAAYvD,UAAU8B,WAAV,CAAsBtC,CAA7D;AACA3N,gBAAcqC,QAAd,CAAuBuL,CAAvB,GAA2BvG,EAAEuK,OAAF,GAAYzD,UAAU8B,WAAV,CAAsBrC,CAA7D;AACA5N,gBAAcmQ,WAAd,GAA4BhC,UAAUgC,WAAtC;AACAnQ,gBAAcoQ,YAAd,GAA6BjC,UAAUiC,YAAvC;AACA;;AAEDnC,yBAAwBzO,OAAxB,CAAgCC,KAAKA,EAAEwH,UAAF,CAAajH,aAAb,CAArC;AACA;;AAED,SAAS8H,QAAT,GAAoB;AACnByG;AACA,QAAO;AACNxG,YAAU,UAAS3G,SAAT,EAAoB;AAC7BgN,cAAWxM,IAAX,CAAgBR,SAAhB;AACA,GAHK;AAIN6G,cAAY,UAAS7G,SAAT,EAAoB;AAC/BgN,cAAW7D,MAAX,CAAkB6D,WAAW9Q,OAAX,CAAmB8D,SAAnB,CAAlB,EAAiD,CAAjD;AACA;AANK,EAAP;AAQA;;AAED,8DAAA4R;;AAEA,+DAAelL,UAAf,E;;;;;;;;;;;;;;;ACrTA;;AAEA,MAAMmL,MAAM;AACX,EAAE,IAAG,yDAAyB,EAA9B,GAAkC;AACjC,cAAY;AADqB,EADvB;AAIX,EAAE,IAAG,yDAAyB,IAA9B,GAAoC;AACnC,gBAAc;AADqB,EAJzB;AAOX,EAAE,IAAG,yDAAyB,aAA9B,GAA6C;AAC5C,iBAAe;AAD6B,EAPlC;AAUX,EAAE,IAAG,yDAAyB,gBAAe,uDAAuB,EAApE,GAAwE;AACvE,YAAU,MAD6D;AAEvE,aAAW;AAF4D,EAV7D;AAcX,EAAE,IAAG,uDAAuB,EAA5B,GAAgC;AAC/B,cAAY;AADmB,EAdrB;AAiBX,EAAE,IAAG,uDAAuB,WAA5B,GAAyC;AACxC,gBAAc;AAD0B,EAjB9B;AAoBX,EAAE,IAAG,qDAAqB,IAA1B,GAAgC;AAC/B,gBAAc;AADiB,EApBrB;AAuBX,EAAE,IAAG,qDAAqB,WAA1B,GAAuC;AACtC,gBAAc;AADwB,EAvB5B;AA0BX,EAAE,IAAG,8DAA8B,IAAnC,GAAyC;AACxC,mBAAiB,MADuB;AAExC,uBAAqB;AAFmB;AA1B9B,CAAZ;;AAgCA,SAASC,kBAAT,CAA4BD,GAA5B,EAAiC;AAChC,QAAOpW,OAAOsW,OAAP,CAAeF,GAAf,EAAoBnN,MAApB,CAA2B,CAACsN,WAAD,EAAc,CAACC,QAAD,EAAWC,SAAX,CAAd,KAAwC;AACzE,MAAI,OAAQA,SAAR,KAAuB,QAA3B,EAAqC;AACpC,UAAQ,GAAEF,WAAY,GAAEC,QAAS,IAAGH,mBAAmBI,SAAnB,CAA8B,GAAlE;AACA;AACD,SAAQ,GAAEF,WAAY,GAAEC,QAAS,IAAGC,SAAU,GAA9C;AACA,EALM,EAKJ,EALI,CAAP;AAMA;;AAED,SAASN,cAAT,GAA0B;AACzB,OAAMO,OAAO7V,SAAS6V,IAAT,IAAiB7V,SAAS8V,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAA9B;AACA,OAAMlX,QAAQoB,SAASC,aAAT,CAAuB,OAAvB,CAAd;AACA,OAAM8V,YAAYP,mBAAmBD,GAAnB,CAAlB;AACA3W,OAAMoX,IAAN,GAAa,UAAb;AACA,KAAIpX,MAAMqX,UAAV,EAAsB;AACrBrX,QAAMqX,UAAN,CAAiBC,OAAjB,GAA2BH,SAA3B;AACA,EAFD,MAEO;AACNnX,QAAMyB,WAAN,CAAkBL,SAASmW,cAAT,CAAwBJ,SAAxB,CAAlB;AACA;;AAEDF,MAAKxV,WAAL,CAAiBzB,KAAjB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvDM,MAAMwX,kBAAkB,CAACC,KAAD,EAAQC,KAAR,KAAkB;AAC/C,SAAO;AACLpH,UAAMxN,KAAK0R,GAAL,CAASiD,MAAMnH,IAAf,EAAqBoH,MAAMpH,IAA3B,CADD;AAELI,SAAK5N,KAAK0R,GAAL,CAASiD,MAAM/G,GAAf,EAAoBgH,MAAMhH,GAA1B,CAFA;AAGLL,WAAOvN,KAAK6U,GAAL,CAASF,MAAMpH,KAAf,EAAsBqH,MAAMrH,KAA5B,CAHF;AAILI,YAAQ3N,KAAK6U,GAAL,CAASF,MAAMhH,MAAf,EAAuBiH,MAAMjH,MAA7B;AAJH,GAAP;AAMD,CAPM;;AASA,MAAMmH,wBAAwB,CAACH,KAAD,EAAQC,KAAR,EAAe3L,IAAf,KAAwB;AAC3D,MAAIA,SAAS,GAAb,EAAkB;AAChB,WAAO;AACLuE,YAAMxN,KAAK0R,GAAL,CAASiD,MAAMnH,IAAf,EAAqBoH,MAAMpH,IAA3B,CADD;AAELI,WAAK+G,MAAM/G,GAFN;AAGLL,aAAOvN,KAAK6U,GAAL,CAASF,MAAMpH,KAAf,EAAsBqH,MAAMrH,KAA5B,CAHF;AAILI,cAAQgH,MAAMhH;AAJT,KAAP;AAMD,GAPD,MAOO;AACL,WAAO;AACLH,YAAMmH,MAAMnH,IADP;AAELI,WAAK5N,KAAK0R,GAAL,CAASiD,MAAM/G,GAAf,EAAoBgH,MAAMhH,GAA1B,CAFA;AAGLL,aAAOoH,MAAMpH,KAHR;AAILI,cAAQ3N,KAAK6U,GAAL,CAASF,MAAMhH,MAAf,EAAuBiH,MAAMjH,MAA7B;AAJH,KAAP;AAMD;AACF,CAhBM;;AAkBA,MAAMoH,mBAAoBhY,OAAD,IAAa;AAC3C,QAAMiY,QAAQjY,QAAQ8N,qBAAR,EAAd;AACA,QAAM1E,OAAO;AACXqH,UAAMwH,MAAMxH,IADD;AAEXD,WAAOyH,MAAMzH,KAAN,GAAc,EAFV;AAGXK,SAAKoH,MAAMpH,GAHA;AAIXD,YAAQqH,MAAMrH;AAJH,GAAb;;AAOA,MAAIsH,eAAelY,OAAf,EAAwB,GAAxB,KAAgC,CAACmY,oBAAoBnY,OAApB,EAA6B,GAA7B,CAArC,EAAwE;AACtE,UAAMsT,QAAQlK,KAAKoH,KAAL,GAAapH,KAAKqH,IAAhC;AACArH,SAAKoH,KAAL,GAAapH,KAAKoH,KAAL,GAAaxQ,QAAQoY,WAArB,GAAmC9E,KAAhD;AACD;;AAED,MAAI4E,eAAelY,OAAf,EAAwB,GAAxB,KAAgC,CAACmY,oBAAoBnY,OAApB,EAA6B,GAA7B,CAArC,EAAwE;AACtE,UAAMuT,SAASnK,KAAKwH,MAAL,GAAcxH,KAAKyH,GAAlC;AACAzH,SAAKwH,MAAL,GAAcxH,KAAKwH,MAAL,GAAc5Q,QAAQqY,YAAtB,GAAqC9E,MAAnD;AACD;;AAED,SAAOnK,IAAP;AACD,CApBM;;AAsBA,MAAM+C,cAAc,CAACnM,OAAD,EAAUkM,IAAV,KAAmB;AAC5C,QAAM/L,QAAQ6P,OAAOsI,gBAAP,CAAwBtY,OAAxB,CAAd;AACA,QAAMwT,WAAWrT,MAAM,UAAN,CAAjB;AACA,QAAMoY,eAAepY,MAAO,YAAW+L,IAAK,EAAvB,CAArB;AACA,QAAMsM,UAAUhF,aAAa,MAAb,IAAuBA,aAAa,QAApD;AACA,QAAMiF,kBAAkBF,iBAAiB,MAAjB,IAA2BA,iBAAiB,QAApE;AACA,SAAOC,WAAWC,eAAlB;AACD,CAPM;;AASA,MAAMN,sBAAsB,CAACnY,OAAD,EAAUkM,IAAV,KAAmB;AACpD,QAAM/L,QAAQ6P,OAAOsI,gBAAP,CAAwBtY,OAAxB,CAAd;AACA,QAAMwT,WAAWrT,MAAM,UAAN,CAAjB;AACA,QAAMoY,eAAepY,MAAO,YAAW+L,IAAK,EAAvB,CAArB;AACA,QAAMsM,UAAUhF,aAAa,MAAb,IAAuBA,aAAa,QAApC,IAAgDA,aAAa,QAA7E;AACA,QAAMiF,kBAAkBF,iBAAiB,MAAjB,IAA2BA,iBAAiB,QAA5C,IAAwDA,iBAAiB,QAAjG;AACA,SAAOC,WAAWC,eAAlB;AACD,CAPM;;AASA,MAAMP,iBAAiB,CAAClY,OAAD,EAAUkM,IAAV,KAAmB;AAC/C,MAAIA,SAAS,GAAb,EAAkB;AAChB,WAAOlM,QAAQoY,WAAR,GAAsBpY,QAAQgU,WAArC;AACD,GAFD,MAEO;AACL,WAAOhU,QAAQqY,YAAR,GAAuBrY,QAAQiU,YAAtC;AACD;AACF,CANM;;AAQA,MAAMnM,eAAe,CAAC9H,OAAD,EAAUkM,IAAV,KAAmB;AAC7C,SAAOgM,eAAelY,OAAf,EAAwBkM,IAAxB,KAAiCC,YAAYnM,OAAZ,EAAqBkM,IAArB,CAAxC;AACD,CAFM;;AAIA,MAAMwM,iBAAiB,CAAC1Y,OAAD,EAAU2Y,WAAV,KAA0B;AACtD,MAAIC,iBAAiB5Y,OAArB;AACA,MAAIoJ,OAAOuP,eAAeX,iBAAiBhY,OAAjB,CAA1B;AACA4Y,mBAAiB5Y,QAAQ0B,aAAzB;AACA,SAAOkX,cAAP,EAAuB;AACrB,QAAIV,eAAeU,cAAf,EAA+B,GAA/B,KAAuCT,oBAAoBS,cAApB,EAAoC,GAApC,CAA3C,EAAqF;AACnFxP,aAAO2O,sBAAsB3O,IAAtB,EAA4BwP,eAAe9K,qBAAf,EAA5B,EAAoE,GAApE,CAAP;AACD;;AAED,QAAIoK,eAAeU,cAAf,EAA+B,GAA/B,KAAuCT,oBAAoBS,cAApB,EAAoC,GAApC,CAA3C,EAAqF;AACnFxP,aAAO2O,sBAAsB3O,IAAtB,EAA4BwP,eAAe9K,qBAAf,EAA5B,EAAoE,GAApE,CAAP;AACD;;AAED8K,qBAAiBA,eAAelX,aAAhC;AACD;;AAED,SAAO0H,IAAP;AACD,CAjBM;;AAmBA,MAAMyP,qBAAqB,CAAC7Y,OAAD,EAAUiV,GAAV,KAAkB;AAClD,MAAI6D,YAAY,EAAhB;AACA,QAAMnO,UAAU,MAAM;AACpBmO,cAAUzV,OAAV,CAAkBC,KAAK;AACrBA,QAAEqP,mBAAF,CAAsB,QAAtB,EAAgCsC,GAAhC;AACD,KAFD;AAGAjF,WAAO2C,mBAAP,CAA2B,QAA3B,EAAqCsC,GAArC;AACD,GALD;;AAOAtR,aAAW,YAAW;AACpB,QAAIiV,iBAAiB5Y,OAArB;AACA,WAAO4Y,cAAP,EAAuB;AACrB,UAAIzM,YAAYyM,cAAZ,EAA4B,GAA5B,KAAoCzM,YAAYyM,cAAZ,EAA4B,GAA5B,CAAxC,EAA0E;AACxEA,uBAAe3I,gBAAf,CAAgC,QAAhC,EAA0CgF,GAA1C;AACA6D,kBAAUrT,IAAV,CAAemT,cAAf;AACD;AACDA,uBAAiBA,eAAelX,aAAhC;AACD;;AAEDsO,WAAOC,gBAAP,CAAwB,QAAxB,EAAkCgF,GAAlC;AACD,GAXD,EAWG,EAXH;;AAaA,SAAO;AACLtK;AADK,GAAP;AAGD,CAzBM;;AA2BA,MAAMoO,YAAY,CAAC/Y,OAAD,EAAUgZ,MAAV,KAAqB;AAC5C,MAAI7T,UAAUnF,OAAd;AACA,SAAOmF,OAAP,EAAgB;AACd,QAAIA,YAAY6T,MAAhB,EAAwB;AACtB,aAAO,IAAP;AACD;AACD7T,cAAUA,QAAQzD,aAAlB;AACD;AACD,SAAO,KAAP;AACD,CATM;;AAWA,MAAMR,YAAY,CAAClB,OAAD,EAAUiZ,QAAV,KAAuB;AAC9C,MAAI9T,UAAUnF,OAAd;AACA,SAAOmF,OAAP,EAAgB;AACd,QAAIA,QAAQ+T,OAAR,CAAgBD,QAAhB,CAAJ,EAA+B;AAC7B,aAAO9T,OAAP;AACD;AACDA,cAAUA,QAAQzD,aAAlB;AACD;;AAED,SAAO,IAAP;AACD,CAVM;;AAYA,MAAMW,WAAW,CAACrC,OAAD,EAAUmZ,GAAV,KAAkB;AACxC,SAAOnZ,QAAQyB,SAAR,CAAkB2X,KAAlB,CAAwB,GAAxB,EAA6BnX,GAA7B,CAAiCqB,KAAKA,CAAtC,EAAyCnC,OAAzC,CAAiDgY,GAAjD,IAAwD,CAAC,CAAhE;AACD,CAFM;;AAIA,MAAMjZ,WAAW,CAACF,OAAD,EAAUmZ,GAAV,KAAkB;AACxC,QAAME,UAAUrZ,QAAQyB,SAAR,CAAkB2X,KAAlB,CAAwB,GAAxB,EAA6BhF,MAA7B,CAAoC9Q,KAAKA,CAAzC,CAAhB;AACA,MAAI+V,QAAQlY,OAAR,CAAgBgY,GAAhB,MAAyB,CAAC,CAA9B,EAAiC;AAC/BE,YAAQ5T,IAAR,CAAa0T,GAAb;AACAnZ,YAAQyB,SAAR,GAAoB4X,QAAQC,IAAR,CAAa,GAAb,CAApB;AACD;AACF,CANM;;AAQA,MAAMjZ,cAAc,CAACL,OAAD,EAAUmZ,GAAV,KAAkB;AAC3C,QAAME,UAAUrZ,QAAQyB,SAAR,CAAkB2X,KAAlB,CAAwB,GAAxB,EAA6BhF,MAA7B,CAAoC9Q,KAAKA,KAAKA,MAAM6V,GAApD,CAAhB;AACAnZ,UAAQyB,SAAR,GAAoB4X,QAAQC,IAAR,CAAa,GAAb,CAApB;AACD,CAHM;;AAKA,MAAMC,WAAW,CAAC3P,EAAD,EAAKoL,KAAL,EAAYwE,SAAZ,KAA0B;AAChD,MAAItE,QAAQ,IAAZ;AACA,SAAO,CAAC,GAAGjO,MAAJ,KAAe;AACpB,QAAIiO,KAAJ,EAAW;AACTgB,mBAAahB,KAAb;AACD;AACD,QAAIsE,aAAa,CAACtE,KAAlB,EAAyB;AACvBtL,SAAG1H,IAAH,QAAc,GAAG+E,MAAjB;AACD,KAFD,MAEO;AACLiO,cAAQvR,WAAW,MAAM;AACvBuR,gBAAQ,IAAR;AACAtL,WAAG1H,IAAH,QAAc,GAAG+E,MAAjB;AACD,OAHO,EAGL+N,KAHK,CAAR;AAID;AACF,GAZD;AAaD,CAfM;;AAiBA,MAAM7G,gBAAgB,CAAC6K,MAAD,EAASlS,KAAT,KAAmB;AAC9C,SAAOkS,OAAOtV,WAAP,CAAmBsV,OAAO7W,QAAP,CAAgB2E,KAAhB,CAAnB,CAAP;AACD,CAFM;;AAIA,MAAMwH,aAAa,CAAC0K,MAAD,EAAS3X,KAAT,EAAgByF,KAAhB,KAA0B;AAClD,MAAIA,SAASkS,OAAO7W,QAAP,CAAgBsX,MAA7B,EAAqC;AACnCT,WAAOpX,WAAP,CAAmBP,KAAnB;AACD,GAFD,MAEO;AACL2X,WAAOrX,YAAP,CAAoBN,KAApB,EAA2B2X,OAAO7W,QAAP,CAAgB2E,KAAhB,CAA3B;AACD;AACF,CANM;;AAQA,MAAMqL,WAAW,MAAM;AAC5B,MAAIuH,UAAUC,SAAV,CAAoBC,KAApB,CAA0B,UAA1B,KACCF,UAAUC,SAAV,CAAoBC,KAApB,CAA0B,QAA1B,CADD,IAECF,UAAUC,SAAV,CAAoBC,KAApB,CAA0B,SAA1B,CAFD,IAGCF,UAAUC,SAAV,CAAoBC,KAApB,CAA0B,OAA1B,CAHD,IAICF,UAAUC,SAAV,CAAoBC,KAApB,CAA0B,OAA1B,CAJD,IAKCF,UAAUC,SAAV,CAAoBC,KAApB,CAA0B,aAA1B,CALD,IAMCF,UAAUC,SAAV,CAAoBC,KAApB,CAA0B,gBAA1B,CANL,EAOE;AACA,WAAO,IAAP;AACD,GATD,MAUK;AACH,WAAO,KAAP;AACD;AACF,CAdM,C","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SmoothDND\"] = factory();\n\telse\n\t\troot[\"SmoothDND\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","import container from './src/container';\r\nimport * as constants from './src/constants';\r\nimport * as dropHandlers from './src/dropHandlers';\r\nexport default container;\r\nexport {\r\n\tconstants,\r\n\tdropHandlers\r\n};","export const containerInstance = 'smooth-dnd-container-instance';\r\nexport const containersInDraggable = 'smooth-dnd-containers-in-draggable';\r\n\r\nexport const defaultGroupName = '@@smooth-dnd-default-group@@';\r\nexport const wrapperClass = 'smooth-dnd-draggable-wrapper';\r\nexport const defaultGrabHandleClass = 'smooth-dnd-default-grap-handle';\r\nexport const animationClass = 'animated';\r\nexport const translationValue = '__smooth_dnd_draggable_translation_value';\r\nexport const visibilityValue = '__smooth_dnd_draggable_visibility_value';\r\nexport const ghostClass = 'smooth-dnd-ghost';\r\n\r\nexport const containerClass = 'smooth-dnd-container';\r\n\r\nexport const extraSizeForInsertion = 'smooth-dnd-extra-size-for-insertion';\r\nexport const stretcherElementClass = 'smooth-dnd-stretcher-element';\r\nexport const stretcherElementInstance = 'smooth-dnd-stretcher-instance';\r\n\r\nexport const isDraggableDetached = 'smoth-dnd-is-draggable-detached';\r\n\r\nexport const disbaleTouchActions = 'smooth-dnd-disable-touch-action';\r\nexport const noUserSelectClass = 'smooth-dnd-no-user-select';\r\n","import { hasClass, addClass, removeClass, getParent } from './utils';\r\nimport { domDropHandler } from './dropHandlers';\r\nimport dragscroller from './dragscroller';\r\nimport {\r\n\tdefaultGroupName,\r\n\twrapperClass,\r\n\tanimationClass,\r\n\tstretcherElementClass,\r\n\tstretcherElementInstance,\r\n\ttranslationValue,\r\n\tcontainerClass,\r\n\tcontainerInstance,\r\n\tcontainersInDraggable\r\n} from './constants';\r\nimport layoutManager from './layoutManager';\r\nimport Mediator from './mediator';\r\n// import './container.css';\r\n\r\nconst defaultOptions = {\r\n\tgroupName: null,\r\n\tbehaviour: 'move', // move | copy\r\n\tacceptGroups: [defaultGroupName],\r\n\torientation: 'vertical', // vertical | horizontal\r\n\tgetChildPayload: () => { return undefined; },\r\n\tanimationDuration: 180\r\n};\r\n\r\nfunction setAnimation(element, add, animationDuration) {\r\n\tif (add) {\r\n\t\taddClass(element, animationClass);\r\n\t\telement.style.transitionDuration = animationDuration + 'ms';\r\n\t} else {\r\n\t\tremoveClass(element, animationClass);\r\n\t\telement.style.transitionDuration = null;\r\n\t}\r\n}\r\n\r\nfunction getContainer(element) {\r\n\treturn element ? element[containerInstance] : null;\r\n}\r\n\r\nfunction initOptions(props = defaultOptions) {\r\n\tconst result = Object.assign({}, defaultOptions, props);\r\n\tif (result.groupName && !props.acceptGroups) {\r\n\t\tresult.acceptGroups = [props.groupName];\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction isDragRelevant({ element, options }) {\r\n\treturn function(sourceContainer) {\r\n\t\tconst sourceOptions = sourceContainer.getOptions();\r\n\t\tif (options.behaviour === 'copy') return false;\r\n\r\n\t\tconst parentWrapper = getParent(element, '.' + wrapperClass);\r\n\t\tif (parentWrapper === sourceContainer.element) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (sourceContainer.element === element) return true;\r\n\t\tif (sourceOptions.groupName && sourceOptions.groupName === options.groupName) return true;\r\n\t\tif (options.acceptGroups.indexOf(sourceOptions.groupName) > -1) return true;\r\n\r\n\t\treturn false;\r\n\t};\r\n}\r\n\r\nfunction wrapChild(child, orientation) {\r\n\tconst div = document.createElement('div');\r\n\tdiv.className = `${wrapperClass} ${orientation} ${animationClass}`;\r\n\tchild.parentElement.insertBefore(div, child);\r\n\tdiv.appendChild(child);\r\n\treturn div;\r\n}\r\n\r\nfunction wrapChildren(element, orientation, animationDuration) {\r\n\tconst draggables = Array.prototype.map.call(element.children, child => {\r\n\t\tlet wrapper = child;\r\n\t\tif (!hasClass(child, wrapperClass)) {\r\n\t\t\twrapper = wrapChild(child, orientation, animationDuration);\r\n\t\t}\r\n\r\n\t\twrapper.style.transitionDuration = animationDuration + 'ms';\r\n\t\twrapper[containersInDraggable] = [];\r\n\t\twrapper[translationValue] = 0;\r\n\t\treturn wrapper;\r\n\t});\r\n\treturn draggables;\r\n}\r\n\r\nfunction findDraggebleAtPos({ layout }) {\r\n\tconst find = (draggables, pos, startIndex, endIndex, withRespectToMiddlePoints = false) => {\r\n\t\tif (endIndex < startIndex) {\r\n\t\t\treturn startIndex;\r\n\t\t}\r\n\t\t// binary serach draggable\r\n\t\tif (startIndex === endIndex) {\r\n\t\t\tlet { begin, end } = layout.getBeginEnd(draggables[startIndex]);\r\n\t\t\t// mouse pos is inside draggable\r\n\t\t\t// now decide which index to return\r\n\t\t\tif (pos > begin && pos <= end) {\r\n\t\t\t\tif (withRespectToMiddlePoints) {\r\n\t\t\t\t\treturn (pos < ((end + begin) / 2)) ? startIndex : startIndex + 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn startIndex;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst middleIndex = Math.floor((endIndex + startIndex) / 2);\r\n\t\t\tconst { begin, end } = layout.getBeginEnd(draggables[middleIndex]);\r\n\t\t\tif (pos < begin) {\r\n\t\t\t\treturn find(draggables, pos, startIndex, middleIndex - 1, withRespectToMiddlePoints);\r\n\t\t\t} else if (pos > end) {\r\n\t\t\t\treturn find(draggables, pos, middleIndex + 1, endIndex, withRespectToMiddlePoints);\r\n\t\t\t} else {\r\n\t\t\t\tif (withRespectToMiddlePoints) {\r\n\t\t\t\t\treturn (pos < ((end + begin) / 2)) ? middleIndex : middleIndex + 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn middleIndex;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn (draggables, pos, withRespectToMiddlePoints = false) => {\r\n\t\treturn find(draggables, pos, 0, draggables.length - 1, withRespectToMiddlePoints);\r\n\t};\r\n}\r\n\r\nfunction resetDraggables({ element, draggables, layout, options }) {\r\n\treturn function() {\r\n\t\tdraggables.forEach(p => {\r\n\t\t\tsetAnimation(p, false);\r\n\t\t\tlayout.setTranslation(p, 0);\r\n\t\t\tlayout.setVisibility(p, true);\r\n\t\t\tp[containersInDraggable] = [];\r\n\t\t});\r\n\r\n\t\tif (element[stretcherElementInstance]) {\r\n\t\t\telement[stretcherElementInstance].parentNode.removeChild(element[stretcherElementInstance]);\r\n\t\t\telement[stretcherElementInstance] = null;\r\n\t\t}\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tdraggables.forEach(p => {\r\n\t\t\t\tsetAnimation(p, true, options.animationDuration);\r\n\t\t\t});\r\n\t\t}, 50);\r\n\t};\r\n}\r\n\r\nfunction setTargetContainer(draggableInfo, element, set = true) {\r\n\tif (element && set) {\r\n\t\tdraggableInfo.targetElement = element;\r\n\t} else {\r\n\t\tif (draggableInfo.targetElement === element) {\r\n\t\t\tdraggableInfo.targetElement = null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction handleDrop({ element, draggables, layout, options }) {\r\n\tconst draggablesReset = resetDraggables({ element, draggables, layout, options });\r\n\tconst dropHandler = (options.dropHandler || domDropHandler)(({ element, draggables, layout, options }));\r\n\treturn function(draggableInfo, { addedIndex, removedIndex }) {\r\n\t\tdraggablesReset();\r\n\t\t// if drop zone is valid => complete drag else do nothing everything will be reverted by draggablesReset()\r\n\t\tif (draggableInfo.targetElement) {\r\n\t\t\tlet actualAddIndex = addedIndex !== null ? ((removedIndex !== null && removedIndex < addedIndex) ? addedIndex - 1 : addedIndex) : null;\r\n\t\t\tconst dropHandlerParams = {\r\n\t\t\t\tremovedIndex,\r\n\t\t\t\taddedIndex: actualAddIndex,\r\n\t\t\t\tpayload: draggableInfo.payload,\r\n\t\t\t\tdroppedElement: draggableInfo.element.firstChild\r\n\t\t\t};\r\n\t\t\tdropHandler(dropHandlerParams, options.onDrop);\r\n\t\t\tconsole.log(removedIndex, actualAddIndex, draggableInfo.payload, draggableInfo.element.firstChild);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getContainerProps(element, initialOptions) {\r\n\tconst options = initOptions(initialOptions);\r\n\tconst draggables = wrapChildren(element, options.orientation, options.animationDuration);\r\n\t// set flex classes before layout is inited for scroll listener\r\n\taddClass(element, `${containerClass} ${options.orientation}`);\r\n\tconst layout = layoutManager(element, options.orientation, options.animationDuration);\r\n\treturn {\r\n\t\telement,\r\n\t\tdraggables,\r\n\t\toptions,\r\n\t\tlayout\r\n\t};\r\n}\r\n\r\nfunction getRelaventParentContainer(container, relevantContainers) {\r\n\tlet current = container.element;\r\n\twhile (current) {\r\n\t\tconst containerOfParentElement = getContainer(current.parentElement);\r\n\t\tif (containerOfParentElement && relevantContainers.indexOf(containerOfParentElement) > -1) {\r\n\t\t\treturn {\r\n\t\t\t\tcontainer: containerOfParentElement,\r\n\t\t\t\tdraggable: current\r\n\t\t\t};\r\n\t\t}\r\n\t\tcurrent = current.parentElement;\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\nfunction registerToParentContainer(container, relevantContainers) {\r\n\tconst parentInfo = getRelaventParentContainer(container, relevantContainers);\r\n\tif (parentInfo) {\r\n\t\tparentInfo.container.getChildContainers().push(container);\r\n\t\tcontainer.setParentContainer(parentInfo.container);\r\n\t\t//current should be draggable\r\n\t\tparentInfo.draggable[containersInDraggable].push(container);\r\n\t}\r\n}\r\n\r\nfunction getRemovedItem({ draggables, element, options }) {\r\n\tlet prevRemovedIndex = null;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tlet removedIndex = prevRemovedIndex;\r\n\t\tif (prevRemovedIndex == null && draggableInfo.container.element === element && options.behaviour === 'move') {\r\n\t\t\tremovedIndex = prevRemovedIndex = draggableInfo.elementIndex;\r\n\t\t}\r\n\r\n\t\treturn { removedIndex };\r\n\t};\r\n}\r\n\r\nfunction setRemovedItemVisibilty({ draggables, layout }) {\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (dragResult.removedIndex !== null) {\r\n\t\t\tlayout.setVisibility(draggables[dragResult.removedIndex], false);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getPosition({ element, layout }) {\r\n\treturn ({ draggableInfo }) => {\r\n\t\treturn {\r\n\t\t\tpos: !getContainer(element).isPosInChildContainer() ? layout.getPosition(draggableInfo.position) : null\r\n\t\t};\r\n\t};\r\n}\r\n\r\nfunction notifyParentOnPositionCapture({ element }) {\r\n\tlet isCaptured = false;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (getContainer(element).getParentContainer() && isCaptured !== (dragResult.pos !== null)) {\r\n\t\t\tisCaptured = dragResult.pos !== null;\r\n\t\t\tgetContainer(element).getParentContainer().onChildPositionCaptured(isCaptured);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getElementSize({ layout }) {\r\n\tlet elementSize = null;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (dragResult.pos === null) {\r\n\t\t\treturn elementSize = null;\r\n\t\t} else {\r\n\t\t\telementSize = elementSize || layout.getSize(draggableInfo.element);\r\n\t\t}\r\n\t\treturn { elementSize };\r\n\t};\r\n}\r\n\r\nfunction handleTargetContainer({ element }) {\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tsetTargetContainer(draggableInfo, element, !!dragResult.pos);\r\n\t};\r\n}\r\n\r\nfunction getDragInsertionIndex({ draggables, layout }) {\r\n\tconst findDraggable = findDraggebleAtPos({ layout });\r\n\treturn ({ dragResult: { shadowBeginEnd, pos } }) => {\r\n\t\tif (!shadowBeginEnd) {\r\n\t\t\tconst index = findDraggable(draggables, pos, true);\r\n\t\t\treturn index !== null ? index : draggables.length;\r\n\t\t} else {\r\n\t\t\tif (shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment <= pos && shadowBeginEnd.end >= pos) {\r\n\t\t\t\t// position inside ghost\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (pos < shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment) {\r\n\t\t\treturn findDraggable(draggables, pos);\r\n\t\t} else if (pos > shadowBeginEnd.end) {\r\n\t\t\treturn findDraggable(draggables, pos) + 1;\r\n\t\t} else {\r\n\t\t\treturn draggables.length;\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction invalidateShadowBeginEndIfNeeded(params) {\r\n\tconst shadowBoundsGetter = getShadowBeginEnd(params);\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tif (draggableInfo.invalidateShadow) {\r\n\t\t\treturn shadowBoundsGetter({ draggableInfo, dragResult });\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n}\r\n\r\nfunction getNextAddedIndex(params) {\r\n\tconst getIndexForPos = getDragInsertionIndex(params);\r\n\treturn ({ dragResult }) => {\r\n\t\tlet index = null;\r\n\t\tif (dragResult.pos !== null) {\r\n\t\t\tindex = getIndexForPos({ dragResult });\r\n\t\t\tif (index === null) {\r\n\t\t\t\tindex = dragResult.addedIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {\r\n\t\t\taddedIndex: index\r\n\t\t};\r\n\t};\r\n}\r\n\r\nfunction resetShadowAdjustment() {\r\n\tlet lastAddedIndex = null;\r\n\treturn ({ dragResult: { addedIndex, shadowBeginEnd } }) => {\r\n\t\tif (addedIndex !== lastAddedIndex && lastAddedIndex !== null && shadowBeginEnd) {\r\n\t\t\tshadowBeginEnd.beginAdjustment = 0;\r\n\t\t}\r\n\t\tlastAddedIndex = addedIndex;\r\n\t};\r\n}\r\n\r\nfunction handleInsertionSizeChange({ element, draggables, layout, options }) {\r\n\tlet strectherElement = null;\r\n\tlet stretcherElementAdded = false;\r\n\r\n\treturn function({ dragResult: { addedIndex, removedIndex, elementSize } }) {\r\n\t\tif (removedIndex === null) {\r\n\t\t\tif (addedIndex !== null) {\r\n\t\t\t\tif (!stretcherElementAdded) {\r\n\t\t\t\t\tconst containerBeginEnd = layout.getBeginEndOfContainer();\r\n\t\t\t\t\tconst hasScrollBar = layout.getScrollSize(element) > layout.getSize(element);\r\n\t\t\t\t\tconst containerEnd = hasScrollBar ? (containerBeginEnd.begin + layout.getScrollSize(element) - layout.getScrollValue(element)) : containerBeginEnd.end;\r\n\t\t\t\t\tconst lastDraggableEnd = layout.getBeginEnd(draggables[draggables.length - 1]).end - draggables[draggables.length - 1][translationValue];\r\n\t\t\t\t\tif (lastDraggableEnd + elementSize > containerEnd) {\r\n\t\t\t\t\t\tstrectherElement = document.createElement('div');\r\n\t\t\t\t\t\tstrectherElement.className = stretcherElementClass + ' ' + options.orientation;\r\n\t\t\t\t\t\tconst stretcherSize = (elementSize + lastDraggableEnd) - containerEnd;\r\n\t\t\t\t\t\tlayout.setSize(strectherElement.style, `${stretcherSize}px`);\r\n\t\t\t\t\t\telement.appendChild(strectherElement);\r\n\t\t\t\t\t\telement[stretcherElementInstance] = strectherElement;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstretcherElementAdded = true;\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tlayout.invalidateRects();\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (strectherElement) {\r\n\t\t\t\t\tlayout.setTranslation(strectherElement, 0);\r\n\t\t\t\t\tlet toRemove = strectherElement;\r\n\t\t\t\t\tstrectherElement = null;\r\n\t\t\t\t\telement.removeChild(toRemove);\r\n\t\t\t\t\telement[stretcherElementInstance] = null;\r\n\t\t\t\t}\r\n\t\t\t\tstretcherElementAdded = false;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tlayout.invalidateRects();\r\n\t\t\t\t}, 100);\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction calculateTranslations({ element, draggables, layout }) {\r\n\tlet prevAddedIndex = null;\r\n\tlet prevRemovedIndex = null;\r\n\treturn function({ dragResult: { addedIndex, removedIndex, elementSize } }) {\r\n\t\tif (addedIndex !== prevAddedIndex || removedIndex !== prevRemovedIndex) {\r\n\t\t\tfor (let index = 0; index < draggables.length; index++) {\r\n\t\t\t\tif (index !== removedIndex) {\r\n\t\t\t\t\tconst draggable = draggables[index];\r\n\t\t\t\t\tlet translate = 0;\r\n\t\t\t\t\tif (removedIndex !== null && removedIndex < index) {\r\n\t\t\t\t\t\ttranslate -= layout.getSize(draggables[removedIndex]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (addedIndex !== null && addedIndex <= index) {\r\n\t\t\t\t\t\ttranslate += elementSize;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlayout.setTranslation(draggable, translate);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tprevAddedIndex = addedIndex;\r\n\t\t\tprevRemovedIndex = removedIndex;\r\n\r\n\t\t\treturn { addedIndex, removedIndex };\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getShadowBeginEnd({ draggables, layout }) {\r\n\tlet prevAddedIndex = null;\r\n\treturn ({ draggableInfo, dragResult }) => {\r\n\t\tconst { addedIndex, removedIndex, elementSize, pos, shadowBeginEnd } = dragResult;\r\n\t\tif (pos !== null) {\r\n\t\t\tif (addedIndex !== null && (draggableInfo.invalidateShadow || addedIndex !== prevAddedIndex)) {\r\n\t\t\t\tif (prevAddedIndex)\r\n\t\t\t\t\tprevAddedIndex = addedIndex;\r\n\t\t\t\tlet beforeIndex = addedIndex - 1;\r\n\t\t\t\tlet begin = 0;\r\n\t\t\t\tlet afterBounds = null;\r\n\t\t\t\tlet beforeBounds = null;\r\n\t\t\t\tif (beforeIndex === removedIndex) {\r\n\t\t\t\t\tbeforeIndex--;\r\n\t\t\t\t}\r\n\t\t\t\tif (beforeIndex > -1) {\r\n\t\t\t\t\tconst beforeSize = layout.getSize(draggables[beforeIndex]);\r\n\t\t\t\t\tbeforeBounds = layout.getBeginEnd(draggables[beforeIndex]);\r\n\t\t\t\t\tif (elementSize < beforeSize) {\r\n\t\t\t\t\t\tconst threshold = (beforeSize - elementSize) / 2;\r\n\t\t\t\t\t\tbegin = beforeBounds.end - threshold;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbegin = beforeBounds.end;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbeforeBounds = { end: layout.getBeginEndOfContainer().begin };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet end = 10000;\r\n\t\t\t\tlet afterIndex = addedIndex;\r\n\t\t\t\tif (afterIndex === removedIndex) {\r\n\t\t\t\t\tafterIndex++;\r\n\t\t\t\t}\r\n\t\t\t\tif (afterIndex < draggables.length) {\r\n\t\t\t\t\tconst afterSize = layout.getSize(draggables[afterIndex]);\r\n\t\t\t\t\tafterBounds = layout.getBeginEnd(draggables[afterIndex]);\r\n\r\n\t\t\t\t\tif (elementSize < afterSize) {\r\n\t\t\t\t\t\tconst threshold = (afterSize - elementSize) / 2;\r\n\t\t\t\t\t\tend = afterBounds.begin + threshold;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tend = afterBounds.begin;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tafterBounds = { begin: layout.getContainerRectangles().end };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst shadowRectTopLeft = beforeBounds && afterBounds ? layout.getTopLeftOfElementBegin(beforeBounds.end, afterBounds.begin) : null;\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tshadowBeginEnd: {\r\n\t\t\t\t\t\tbegin,\r\n\t\t\t\t\t\tend,\r\n\t\t\t\t\t\trect: shadowRectTopLeft,\r\n\t\t\t\t\t\tbeginAdjustment: shadowBeginEnd ? shadowBeginEnd.beginAdjustment : 0,\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tprevAddedIndex = null;\r\n\t\t\treturn {\r\n\t\t\t\tshadowBeginEnd: null\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction handleFirstInsertShadowAdjustment() {\r\n\tlet lastAddedIndex = null;\r\n\treturn ({ dragResult: { pos, addedIndex, shadowBeginEnd }, draggableInfo: { invalidateShadow } }) => {\r\n\t\tif (pos !== null) {\r\n\t\t\tif (addedIndex != null && lastAddedIndex === null) {\r\n\t\t\t\tif (pos < shadowBeginEnd.begin) {\r\n\t\t\t\t\tconst beginAdjustment = pos - shadowBeginEnd.begin - 5;\r\n\t\t\t\t\tshadowBeginEnd.beginAdjustment = beginAdjustment;\r\n\t\t\t\t}\r\n\t\t\t\tlastAddedIndex = addedIndex;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlastAddedIndex = null;\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction getDragHandler(params) {\r\n\treturn compose(params)(\r\n\t\tgetRemovedItem,\r\n\t\tsetRemovedItemVisibilty,\r\n\t\tgetPosition,\r\n\t\tnotifyParentOnPositionCapture,\r\n\t\tgetElementSize,\r\n\t\thandleTargetContainer,\r\n\t\tinvalidateShadowBeginEndIfNeeded,\r\n\t\tgetNextAddedIndex,\r\n\t\tresetShadowAdjustment,\r\n\t\thandleInsertionSizeChange,\r\n\t\tcalculateTranslations,\r\n\t\tgetShadowBeginEnd,\r\n\t\thandleFirstInsertShadowAdjustment\r\n\t);\r\n}\r\n\r\nfunction getDefaultDragResult() {\r\n\treturn {\r\n\t\taddedIndex: null,\r\n\t\tremovedIndex: null,\r\n\t\telementSize: null,\r\n\t\tpos: null,\r\n\t\tshadowBeginEnd: null\r\n\t};\r\n}\r\n\r\nfunction compose(params) {\r\n\treturn (...functions) => {\r\n\t\tconst hydratedFunctions = functions.map(p => p(params));\r\n\t\tlet result = null;\r\n\t\treturn (draggableInfo) => {\r\n\t\t\tresult = hydratedFunctions.reduce((dragResult, fn) => {\r\n\t\t\t\treturn Object.assign(dragResult, fn({ draggableInfo, dragResult }));\r\n\t\t\t}, result || getDefaultDragResult());\r\n\t\t\treturn result;\r\n\t\t};\r\n\t};\r\n}\r\n\r\n// Container definition begin\r\nfunction Container(element) {\r\n\treturn function(options) {\r\n\t\tlet dragResult = null;\r\n\t\tlet lastDraggableInfo = null;\r\n\t\tconst props = getContainerProps(element, options);\r\n\t\tlet dragHandler = getDragHandler(props);\r\n\t\tlet dropHandler = handleDrop(props);\r\n\t\tlet handleScrollOnDrag = dragscroller(props);\r\n\t\tlet parentContainer = null;\r\n\t\tlet posIsInChildContainer = false;\r\n\t\tlet childContainers = [];\r\n\r\n\t\tfunction processLastDraggableInfo() {\r\n\t\t\tif (lastDraggableInfo !== null) {\r\n\t\t\t\tlastDraggableInfo.invalidateShadow = true;\r\n\t\t\t\tdragResult = dragHandler(lastDraggableInfo);\r\n\t\t\t\tlastDraggableInfo.invalidateShadow = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction onChildPositionCaptured(isCaptured) {\r\n\t\t\tposIsInChildContainer = isCaptured;\r\n\t\t\tif (parentContainer) {\r\n\t\t\t\tparentContainer.onChildPositionCaptured(isCaptured);\r\n\t\t\t\tif (lastDraggableInfo) {\r\n\t\t\t\t\tdragResult = dragHandler(lastDraggableInfo);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction prepareDrag(container, relevantContainers) {\r\n\t\t\tconst element = container.element;\r\n\t\t\tconst draggables = props.draggables;\r\n\t\t\tconst options = container.getOptions();\r\n\t\t\tconst newDraggables = wrapChildren(element, options.orientation, options.animationDuration);\r\n\t\t\tfor (let i = 0; i < newDraggables.length; i++) {\r\n\t\t\t\tdraggables[i] = newDraggables[i];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (let i = 0; i < draggables.length - newDraggables.length; i++) {\r\n\t\t\t\tdraggables.pop();\r\n\t\t\t}\r\n\r\n\t\t\tcontainer.layout.invalidateRects();\r\n\t\t\tregisterToParentContainer(container, relevantContainers);\r\n\t\t}\r\n\r\n\t\tprops.layout.setScrollListener(function() {\r\n\t\t\tprocessLastDraggableInfo();\r\n\t\t});\r\n\r\n\t\tfunction dispose(container) {\r\n\t\t\t// additional dispose actions\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\telement,\r\n\t\t\tdraggables: props.draggables,\r\n\t\t\tisDragRelevant: isDragRelevant(props),\r\n\t\t\tgetScale: props.layout.getContainerScale,\r\n\t\t\tgetChildPayload: props.options.getChildPayload,\r\n\t\t\tgroupName: props.options.groupName,\r\n\t\t\tlayout: props.layout,\r\n\t\t\tgetChildContainers: () => childContainers,\r\n\t\t\tonChildPositionCaptured,\r\n\t\t\tdispose,\r\n\t\t\tprepareDrag,\r\n\t\t\tisPosInChildContainer: () => posIsInChildContainer,\r\n\t\t\thandleDrag: function(draggableInfo) {\r\n\t\t\t\tlastDraggableInfo = draggableInfo;\r\n\t\t\t\tdragResult = dragHandler(draggableInfo);\r\n\t\t\t\t// console.log(dragResult);\r\n\t\t\t\thandleScrollOnDrag({ draggableInfo, dragResult });\r\n\t\t\t},\r\n\t\t\thandleDrop: function(draggableInfo) {\r\n\t\t\t\tlastDraggableInfo = null;\r\n\t\t\t\tonChildPositionCaptured(false);\r\n\t\t\t\tdragHandler = getDragHandler(props);\r\n\t\t\t\tdropHandler(draggableInfo, dragResult);\r\n\t\t\t\thandleScrollOnDrag({ reset: true });\r\n\t\t\t\thandleScrollOnDrag = dragscroller(props);\r\n\t\t\t\tparentContainer = null;\r\n\t\t\t\tchildContainers = [];\r\n\t\t\t},\r\n\t\t\tgetDragResult: function() {\r\n\t\t\t\treturn dragResult;\r\n\t\t\t},\r\n\t\t\tgetTranslateCalculator: function(...params) {\r\n\t\t\t\treturn calculateTranslations(props)(...params);\r\n\t\t\t},\r\n\t\t\tsetParentContainer: (e) => { parentContainer = e; },\r\n\t\t\tgetParentContainer: () => parentContainer,\r\n\t\t\tonTranslated: () => {\r\n\t\t\t\tprocessLastDraggableInfo();\r\n\t\t\t},\r\n\t\t\tgetOptions: () => props.options,\r\n\t\t};\r\n\t};\r\n}\r\n\r\nconst options = {\r\n\tonDragStart: (itemIndex) => { },\r\n\tonDragMove: () => { },\r\n\tonDrop: () => { },\r\n\tbehaviour: 'move',\r\n\tgroupName: 'bla bla', // if not defined => container will not interfere with other containers\r\n\tacceptGroups: [],\r\n\torientation: 'vertical',\r\n\tdragHandleSelector: null,\r\n\tnonDragAreaSelector: 'some selector',\r\n\tdragBeginDelay: 0,\r\n\tanimationDuration: 180,\r\n\tgetChildPayload: (index) => null,\r\n};\r\n\r\n// exported part of container\r\nexport default function(element, options) {\r\n\tconst containerIniter = Container(element);\r\n\tconst container = containerIniter(options);\r\n\telement[containerInstance] = container;\r\n\tMediator.register(container);\r\n\treturn {\r\n\t\tsetOptions: containerIniter,\r\n\t\tdispose: function() {\r\n\t\t\tMediator.unregister(container);\r\n\t\t\tcontainer.layout.dispose();\r\n\t\t\tcontainer.dispose(container);\r\n\t\t}\r\n\t};\r\n}\r\n","import { isScrolling } from './utils';\r\n\r\nconst maxSpeed = 1500; // px/s\r\nconst minSpeed = 20; // px/s\r\n\r\nfunction getScrollableParent(element, axis) {\r\n\tlet current = element;\r\n\twhile (current) {\r\n\t\tif (isScrolling(current)) {\r\n\t\t\treturn current;\r\n\t\t}\r\n\t\tcurrent = current.parentElement;\r\n\t}\r\n}\r\n\r\nfunction requestFrame(element, layout) {\r\n\tlet isAnimating = false;\r\n\tlet request = null;\r\n\tlet startTime = null;\r\n\tlet direction = null;\r\n\tlet speed = null;\r\n\r\n\tfunction animate(_direction, _speed) {\r\n\t\tdirection = _direction;\r\n\t\tspeed = _speed;\r\n\t\tisAnimating = true;\r\n\t\tif (isAnimating) {\r\n\t\t\tstart();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction start() {\r\n\t\tif (request === null) {\r\n\t\t\trequest = requestAnimationFrame((timestamp) => {\r\n\t\t\t\tif (startTime === null) { startTime = timestamp; }\r\n\t\t\t\tconst timeDiff = timestamp - startTime;\r\n\t\t\t\tstartTime = timestamp;\r\n\t\t\t\tlet distanceDiff = (timeDiff / 1000) * speed;\r\n\t\t\t\tdistanceDiff = direction === 'begin' ? (0 - distanceDiff) : distanceDiff;\r\n\t\t\t\tconst scrollTo = layout.getScrollValue(element) + distanceDiff;\r\n\t\t\t\tlayout.setScrollValue(element, scrollTo);\r\n\t\t\t\t// console.log(scrollTo);\r\n\t\t\t\trequest = null;\r\n\t\t\t\tstart();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction stop() {\r\n\t\tif (isAnimating) {\r\n\t\t\tcancelAnimationFrame(request);\r\n\t\t\tisAnimating = false;\r\n\t\t\tstartTime = null;\r\n\t\t\trequest = null;\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tanimate,\r\n\t\tstop\r\n\t};\r\n}\r\n\r\n\r\nfunction getAutoScrollInfo(pos, elementSize, scrollableBeginEnd) {\r\n\tconst { begin, end } = scrollableBeginEnd;\r\n\tconst moveDistance = 100;\r\n\tif (end - pos < moveDistance) {\r\n\t\treturn {\r\n\t\t\tdirection: 'end',\r\n\t\t\tspeedFactor: (moveDistance - (end - pos)) / moveDistance\r\n\t\t};\r\n\t} else if (pos - begin < moveDistance) {\r\n\t\t// console.log(pos - begin);\r\n\t\treturn {\r\n\t\t\tdirection: 'begin',\r\n\t\t\tspeedFactor: (moveDistance - (pos - begin)) / moveDistance\r\n\t\t};\r\n\t}\r\n}\r\n\r\n\r\nexport default ({ element, layout, options }) => {\r\n\tlet lastPos = null;\r\n\tconst axis = options.orientation === 'vertical' ? 'Y' : 'X';\r\n\tlet scrollableParent = getScrollableParent(element, axis);\r\n\tconst scrollParentBeginEnd = layout.getBeginEndOfDOMRect(scrollableParent.getBoundingClientRect());\r\n\tlet animator = requestFrame(element, layout);\r\n\treturn ({ draggableInfo, dragResult, reset }) => {\r\n\t\tif (scrollableParent) {\r\n\t\t\tif (reset) {\r\n\t\t\t\tanimator.stop();\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (dragResult.pos !== null) {\r\n\t\t\t\tif (lastPos === null) {\r\n\t\t\t\t\tscrollableParent = getScrollableParent(element, axis);\r\n\t\t\t\t\tanimator.stop();\r\n\t\t\t\t\tanimator = requestFrame(scrollableParent, layout);\r\n\t\t\t\t}\r\n\t\t\t\tconst autoScrollInfo = getAutoScrollInfo(dragResult.pos, dragResult.elementSize, scrollParentBeginEnd);\r\n\t\t\t\tif (autoScrollInfo) {\r\n\t\t\t\t\tanimator.animate(autoScrollInfo.direction, autoScrollInfo.speedFactor * maxSpeed);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tanimator.stop();\r\n\t\t\t\t}\r\n\t\t\t\tlastPos = dragResult.pos;\r\n\t\t\t} else {\r\n\t\t\t\tanimator.stop();\r\n\t\t\t}\r\n\r\n\t\t\tlastPos = dragResult.pos;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n};","import { addChildAt, removeChildAt } from './utils';\r\nimport {\r\n\twrapperClass,\r\n\tanimationClass,\r\n\tcontainersInDraggable\r\n} from './constants';\r\n\r\n\r\nexport function domDropHandler({ element, draggables, layout, options }) {\r\n\treturn (dropResult, onDrop) => {\r\n\t\tconst { removedIndex, addedIndex, droppedElement } = dropResult;\r\n\t\tif (removedIndex !== null) {\r\n\t\t\tremoveChildAt(element, removedIndex);\r\n\t\t\tdraggables.splice(removedIndex, 1);\r\n\t\t}\r\n\r\n\t\tif (addedIndex !== null) {\r\n\t\t\tconst wrapper = document.createElement('div');\r\n\t\t\twrapper.className = `${wrapperClass} ${options.orientation} ${animationClass} `;\r\n\t\t\twrapper.appendChild(droppedElement.cloneNode(true));\r\n\t\t\twrapper[containersInDraggable] = [];\r\n\t\t\taddChildAt(element, wrapper, addedIndex);\r\n\t\t\tif (addedIndex >= draggables.length) {\r\n\t\t\t\tdraggables.push(wrapper);\r\n\t\t\t} else {\r\n\t\t\t\tdraggables.splice(addedIndex, 0, wrapper);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (onDrop) {\r\n\t\t\tonDrop(dropResult);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function reactDropHandler() {\r\n\tconst handler = ({ element, draggables, layout, options }) => {\r\n\t\treturn (dropResult, onDrop) => {\r\n\t\t\tif (onDrop) {\r\n\t\t\t\tonDrop(dropResult);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\treturn {\r\n\t\thandler\r\n\t};\r\n}","import * as Utils from './utils';\r\nimport { translationValue, visibilityValue, extraSizeForInsertion, containersInDraggable } from './constants';\r\n\r\n\r\n\r\nconst horizontalMap = {\r\n\tsize: 'offsetWidth',\r\n\tdistanceToParent: 'offsetLeft',\r\n\ttranslate: 'transform',\r\n\tbegin: 'left',\r\n\tend: 'right',\r\n\tdragPosition: 'x',\r\n\tscrollSize: 'scrollWidth',\r\n\toffsetSize: 'offsetWidth',\r\n\tscrollValue: 'scrollLeft',\r\n\tscale: 'scaleX',\r\n\tsetSize: 'width',\r\n\tsetters: {\r\n\t\t'translate': (val) => `translate3d(${val}px, 0, 0)`\r\n\t}\r\n};\r\n\r\nconst verticalMap = {\r\n\tsize: 'offsetHeight',\r\n\tdistanceToParent: 'offsetTop',\r\n\ttranslate: 'transform',\r\n\tbegin: 'top',\r\n\tend: 'bottom',\r\n\tdragPosition: 'y',\r\n\tscrollSize: 'scrollHeight',\r\n\toffsetSize: 'offsetHeight',\r\n\tscrollValue: 'scrollTop',\r\n\tscale: 'scaleY',\r\n\tsetSize: 'height',\r\n\tsetters: {\r\n\t\t'translate': (val) => `translate3d(0,${val}px, 0)`\r\n\t}\r\n};\r\n\r\nfunction orientationDependentProps(map) {\r\n\tfunction get(obj, prop) {\r\n\t\tconst mappedProp = map[prop];\r\n\t\treturn obj[mappedProp || prop];\r\n\t}\r\n\r\n\tfunction set(obj, prop, value) {\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tobj[map[prop]] = map.setters[prop] ? map.setters[prop](value) : value;\r\n\t\t});\r\n\t}\r\n\r\n\treturn { get, set };\r\n}\r\n\r\nexport default function layoutManager(containerElement, orientation, _animationDuration) {\r\n\tcontainerElement[extraSizeForInsertion] = 0;\r\n\tconst animationDuration = _animationDuration;\r\n\tconst map = orientation === 'horizontal' ? horizontalMap : verticalMap;\r\n\tconst propMapper = orientationDependentProps(map);\r\n\tconst values = {\r\n\t\ttranslation: 0\r\n\t};\r\n\tlet registeredScrollListener = null;\r\n\r\n\twindow.addEventListener('resize', function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\t// invalidateContainerScale(containerElement);\r\n\t});\r\n\r\n\tsetTimeout(() => {\r\n\t\tinvalidate();\r\n\t}, 10);\r\n\t// invalidate();\r\n\r\n\tconst scrollListener = Utils.listenScrollParent(containerElement, function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tregisteredScrollListener && registeredScrollListener();\r\n\t});\r\n\tfunction invalidate() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tinvalidateContainerScale(containerElement);\r\n\t}\r\n\r\n\tlet visibleRect;\r\n\tfunction invalidateContainerRectangles(containerElement) {\r\n\t\tvalues.rect = Utils.getContainerRect(containerElement);\r\n\t\tvalues.visibleRect = Utils.getVisibleRect(containerElement, values.rect);\r\n\r\n\t\t// if (visibleRect) {\r\n\t\t//   visibleRect.parentNode.removeChild(visibleRect);\r\n\t\t// }\r\n\t\t// visibleRect = document.createElement('div');\r\n\t\t// visibleRect.style.position = 'fixed';\r\n\t\t// visibleRect.style.border = '1px solid red';\r\n\t\t// visibleRect.style.top = values.visibleRect.top + 'px';\r\n\t\t// visibleRect.style.left = values.visibleRect.left + 'px';\r\n\t\t// visibleRect.style.width = values.visibleRect.right - values.visibleRect.left + 'px';\r\n\t\t// visibleRect.style.height = values.visibleRect.bottom - values.visibleRect.top + 'px';\r\n\t\t// document.body.appendChild(visibleRect);\r\n\r\n\t}\r\n\r\n\tfunction invalidateContainerScale(containerElement) {\r\n\t\tconst rect = containerElement.getBoundingClientRect();\r\n\t\tvalues.scaleX = (rect.right - rect.left) / containerElement.offsetWidth;\r\n\t\tvalues.scaleY = (rect.bottom - rect.top) / containerElement.offsetHeight;\r\n\t}\r\n\r\n\tfunction getContainerRectangles() {\r\n\t\treturn {\r\n\t\t\trect: values.rect,\r\n\t\t\tvisibleRect: values.visibleRect\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfDOMRect(rect) {\r\n\t\treturn {\r\n\t\t\tbegin: propMapper.get(rect, 'begin'),\r\n\t\t\tend: propMapper.get(rect, 'end')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainer() {\r\n\t\tconst begin = propMapper.get(values.rect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.rect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainerVisibleRect() {\r\n\t\tconst begin = propMapper.get(values.visibleRect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.visibleRect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getContainerScale() {\r\n\t\treturn { scaleX: values.scaleX, scaleY: values.scaleY };\r\n\t}\r\n\r\n\tfunction getSize(element) {\r\n\t\treturn propMapper.get(element, 'size') * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getDistanceToOffsetParent(element) {\r\n\t\tconst distance = propMapper.get(element, 'distanceToParent') + (element[translationValue] || 0);\r\n\t\treturn distance * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getBeginEnd(element) {\r\n\t\tconst begin = getDistanceToOffsetParent(element) + (propMapper.get(values.rect, 'begin') + values.translation) - propMapper.get(containerElement, 'scrollValue');\r\n\t\treturn {\r\n\t\t\tbegin,\r\n\t\t\tend: begin + getSize(element) * propMapper.get(values, 'scale')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction setSize(element, size) {\r\n\t\tpropMapper.set(element, 'setSize', size);\r\n\t}\r\n\r\n\tfunction getAxisValue(position) {\r\n\t\treturn propMapper.get(position, 'dragPosition');\r\n\t}\r\n\r\n\tfunction updateDescendantContainerRects(container) {\r\n\t\tcontainer.layout.invalidateRects();\r\n\t\tcontainer.onTranslated();\r\n\t\tif (container.getChildContainers()) {\r\n\t\t\tcontainer.getChildContainers().forEach(p => updateDescendantContainerRects(p));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setTranslation(element, translation) {\r\n\t\tif (getTranslation(element) !== translation) {\r\n\t\t\tpropMapper.set(element.style, 'translate', translation);\r\n\t\t\telement[translationValue] = translation;\r\n\r\n\t\t\tif (element[containersInDraggable]) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\telement[containersInDraggable].forEach(p => {\r\n\t\t\t\t\t\tupdateDescendantContainerRects(p);\r\n\t\t\t\t\t});\r\n\t\t\t\t}, animationDuration + 20);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getTranslation(element) {\r\n\t\treturn element[translationValue];\r\n\t}\r\n\r\n\tfunction setVisibility(element, isVisible) {\r\n\t\tif (element[visibilityValue] === undefined || element[visibilityValue] !== isVisible) {\r\n\t\t\telement.style.visibility = isVisible ? 'inherit' : 'hidden';\r\n\t\t\telement[visibilityValue] = isVisible;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isVisible(element) {\r\n\t\treturn element[visibilityValue] === undefined || element[visibilityValue];\r\n\t}\r\n\r\n\tfunction isInVisibleRect(x, y) {\r\n\t\tconst { left, top, right, bottom } = values.visibleRect;\r\n\t\tif (orientation === 'vertical') {\r\n\t\t\treturn x > left && x < right && y > top && y < bottom;\r\n\t\t} else {\r\n\t\t\treturn x > left && x < right  && y > top && y < bottom;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setScrollListener(callback) {\r\n\t\tregisteredScrollListener = callback;\r\n\t}\r\n\r\n\tfunction getTopLeftOfElementBegin(begin) {\r\n\t\tlet top = 0;\r\n\t\tlet left = 0;\r\n\t\tif (orientation === 'horizontal') {\r\n\t\t\tleft = begin;\r\n\t\t\ttop = values.rect.top;\r\n\t\t} else {\r\n\t\t\tleft = values.rect.left;\r\n\t\t\ttop = begin;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttop, left\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getScrollSize(element) {\r\n\t\treturn propMapper.get(element, 'scrollSize');\r\n\t}\r\n\r\n\tfunction getScrollValue(element) {\r\n\t\treturn propMapper.get(element, 'scrollValue');\r\n\t}\r\n\r\n\tfunction setScrollValue(element, val) {\r\n\t\treturn propMapper.set(element, 'scrollValue', val);\r\n\t}\r\n\r\n\tfunction dispose() {\r\n\t\tif (scrollListener) {\r\n\t\t\tscrollListener.dispose();\r\n\t\t}\r\n\r\n\t\tif (visibleRect) {\r\n\t\t\tvisibleRect.parentNode.removeChild(visibleRect);\r\n\t\t\tvisibleRect = null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getPosition(position) {\r\n\t\treturn isInVisibleRect(position.x, position.y) ? getAxisValue(position) : null;\r\n\t}\r\n\r\n\tfunction invalidateRects() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetSize,\r\n\t\t//getDistanceToContainerBegining,\r\n\t\tgetContainerRectangles,\r\n\t\tgetBeginEndOfDOMRect,\r\n\t\tgetBeginEndOfContainer,\r\n\t\tgetBeginEndOfContainerVisibleRect,\r\n\t\tgetBeginEnd,\r\n\t\tgetAxisValue,\r\n\t\tsetTranslation,\r\n\t\tgetTranslation,\r\n\t\tsetVisibility,\r\n\t\tisVisible,\r\n\t\tisInVisibleRect,\r\n\t\tdispose,\r\n\t\tgetContainerScale,\r\n\t\tsetScrollListener,\r\n\t\tsetSize,\r\n\t\tgetTopLeftOfElementBegin,\r\n\t\tgetScrollSize,\r\n\t\tgetScrollValue,\r\n\t\tsetScrollValue,\r\n\t\tinvalidate,\r\n\t\tinvalidateRects,\r\n\t\tgetPosition,\r\n\t};\r\n}","import * as Utils from './utils';\r\nimport * as constants from './constants';\r\nimport { addStyleToHead } from './styles';\r\n\r\nconst grabEvents = ['mousedown', 'touchstart'];\r\nconst moveEvents = ['mousemove', 'touchmove'];\r\nconst releaseEvents = ['mouseup', 'touchend'];\r\n\r\nlet dragListeningContainers = null;\r\nlet grabbedElement = null;\r\nlet ghostInfo = null;\r\nlet draggableInfo = null;\r\nlet containers = [];\r\nlet isDragging = false;\r\n\r\n// Utils.addClass(document.body, 'clearfix');\r\n\r\nconst isMobile = Utils.isMobile();\r\n\r\nfunction listenEvents() {\r\n\taddGrabListeners();\r\n}\r\n\r\nfunction addGrabListeners() {\r\n\tgrabEvents.forEach(e => {\r\n\t\twindow.document.addEventListener(e, onMouseDown, {passive: false});\r\n\t});\r\n}\r\n\r\nfunction addMoveListeners() {\r\n\tmoveEvents.forEach(e => {\r\n\t\twindow.document.addEventListener(e, onMouseMove, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction removeMoveListeners() {\r\n\tmoveEvents.forEach(e => {\r\n\t\twindow.document.removeEventListener(e, onMouseMove, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction addReleaseListeners() {\r\n\treleaseEvents.forEach(e => {\r\n\t\twindow.document.addEventListener(e, onMouseUp, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction removeReleaseListeners() {\r\n\treleaseEvents.forEach(e => {\r\n\t\twindow.document.removeEventListener(e, onMouseUp, { passive: false });\r\n\t});\r\n}\r\n\r\nfunction getGhostElement(element, { x, y }, container) {\r\n\tconst { scaleX = 1, scaleY = 1 } = container.getScale();\r\n\tconst { left, top, right, bottom } = element.getBoundingClientRect();\r\n\tif (container.getOptions().dragClass) {\r\n\t\tUtils.addClass(element.childNodes[0], container.getOptions().dragClass);\r\n\t}\r\n\tconst midX = left + ((right - left) / 2);\r\n\tconst midY = top + ((bottom - top) / 2);\r\n\tconst div = document.createElement('div');\r\n\tdiv.style.position = 'fixed';\r\n\tdiv.style.pointerEvents = 'none';\r\n\tdiv.style.left = left + 'px';\r\n\tdiv.style.top = top + 'px';\r\n\tdiv.style.width = right - left + 'px';\r\n\tdiv.style.height = bottom - top + 'px';\r\n\tdiv.style.overflow = 'hidden';\r\n\tdiv.className = constants.ghostClass;\r\n\tconst clone = element.cloneNode(true);\r\n\tclone.style.width = ((right - left) / scaleX) + 'px';\r\n\tclone.style.height = ((bottom - top) / scaleY) + 'px';\r\n\tclone.style.transform = `scale3d(${scaleX || 1}, ${scaleY || 1}, 1)`;\r\n\tclone.style.transformOrigin = '0 0 0';\r\n\tclone.style.margin = '0px';\r\n\tdiv.appendChild(clone);\r\n\r\n\treturn {\r\n\t\tghost: div,\r\n\t\tcenterDelta: { x: midX - x, y: midY - y },\r\n\t\tpositionDelta: { left: left - x, top: top - y },\r\n\t\tclientWidth: right - left,\r\n\t\tclientHeight: bottom - top\r\n\t};\r\n}\r\n\r\nfunction getDraggableInfo(draggableElement) {\r\n\tconst container = containers.filter(p => draggableElement.parentElement === p.element)[0];\r\n\tconst draggableIndex = container.draggables.indexOf(draggableElement);\r\n\treturn {\r\n\t\tcontainer,\r\n\t\telement: draggableElement,\r\n\t\telementIndex: draggableIndex,\r\n\t\tpayload: container.getChildPayload(draggableIndex),\r\n\t\ttargetElement: null,\r\n\t\tposition: { x: 0, y: 0 },\r\n\t\tgroupName: container.groupName\r\n\t};\r\n}\r\n\r\nfunction handleDropAnimation(callback) {\r\n\tfunction endDrop() {\r\n\t\tUtils.removeClass(ghostInfo.ghost, 'animated');\r\n\t\tghostInfo.ghost.style.transitionDuration = null;\r\n\t\tdocument.body.removeChild(ghostInfo.ghost);\r\n\t\tcallback();\r\n\t}\r\n\r\n\tfunction animateGhostToPosition({ top, left }, duration) {\r\n\t\tUtils.addClass(ghostInfo.ghost, 'animated');\r\n\t\tghostInfo.ghost.style.transitionDuration = duration + 'ms';\r\n\t\tghostInfo.ghost.style.left = left + 'px';\r\n\t\tghostInfo.ghost.style.top = top + 'px';\r\n\t\tsetTimeout(function() {\r\n\t\t\tendDrop();\r\n\t\t}, duration + 10);\r\n\t}\r\n\r\n\tif (draggableInfo.targetElement) {\r\n\t\tconst container = containers.filter(p => p.element === draggableInfo.targetElement)[0];\r\n\t\tconst dragResult = container.getDragResult();\r\n\t\tanimateGhostToPosition(dragResult.shadowBeginEnd.rect, Math.max(150, container.getOptions().animationDuration / 2));\r\n\t} else {\r\n\t\tconst container = containers.filter(p => p === draggableInfo.container)[0];\r\n\t\tif (container.getOptions().behaviour === 'move') {\r\n\t\t\tconst { removedIndex, elementSize } = container.getDragResult();\r\n\t\t\tconst layout = container.layout;\r\n\t\t\t// drag ghost to back\r\n\t\t\tcontainer.getTranslateCalculator({\r\n\t\t\t\tdragResult: {\r\n\t\t\t\t\tremovedIndex,\r\n\t\t\t\t\taddedIndex: removedIndex,\r\n\t\t\t\t\telementSize\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst prevDraggableEnd = removedIndex > 0 ? layout.getBeginEnd(container.draggables[removedIndex - 1]).end : layout.getBeginEndOfContainer().begin;\r\n\t\t\tanimateGhostToPosition(layout.getTopLeftOfElementBegin(prevDraggableEnd), container.getOptions().animationDuration);\r\n\t\t} else {\r\n\t\t\tUtils.addClass(ghostInfo.ghost, 'animated');\r\n\t\t\tghostInfo.ghost.style.transitionDuration = container.getOptions().animationDuration + 'ms';\r\n\t\t\tghostInfo.ghost.style.opacity = '0';\r\n\t\t\tghostInfo.ghost.style.transform = 'scale(0.90)';\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tendDrop();\r\n\t\t\t}, container.getOptions().animationDuration);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst handleDragStartConditions = (function handleDragStartConditions() {\r\n\tlet startEvent;\r\n\tlet delay;\r\n\tlet clb;\r\n\tlet timer = null;\r\n\tconst moveThreshold = 1;\r\n\tconst maxMoveInDelay = 8;\r\n\r\n\tfunction onMove(event) {\r\n\t\tconst { clientX: currentX, clientY: currentY } = getPointerEvent(event);\r\n\t\tif (!delay) {\r\n\t\t\tif (Math.abs(startEvent.clientX - currentX) > moveThreshold || Math.abs(startEvent.clientY - currentY) > moveThreshold) {\r\n\t\t\t\treturn callCallback();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (Math.abs(startEvent.clientX - currentX) > maxMoveInDelay || Math.abs(startEvent.clientY - currentY) > maxMoveInDelay) {\r\n\t\t\t\tderegisterEvent();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onUp() { deregisterEvent(); }\r\n\tfunction onHTMLDrag() { deregisterEvent(); }\r\n\r\n\tfunction registerEvents() {\r\n\t\tif (delay) {\r\n\t\t\ttimer = setTimeout(callCallback, delay);\r\n\t\t}\r\n\r\n\t\tmoveEvents.forEach(e => window.document.addEventListener(e, onMove), { passive: false });\r\n\t\treleaseEvents.forEach(e => window.document.addEventListener(e, onUp), { passive: false });\r\n\t\tdocument.addEventListener('drag', onHTMLDrag, { passive: false });\r\n\t}\r\n\r\n\tfunction deregisterEvent() {\r\n\t\tclearTimeout(timer);\r\n\t\tmoveEvents.forEach(e => window.document.removeEventListener(e, onMove), { passive: false });\r\n\t\treleaseEvents.forEach(e => window.document.removeEventListener(e, onUp), { passive: false });\r\n\t\tdocument.removeEventListener('drag', onHTMLDrag, { passive: false });\r\n\t}\r\n\r\n\tfunction callCallback() {\r\n\t\tclearTimeout(timer);\r\n\t\tderegisterEvent();\r\n\t\tclb();\r\n\t}\r\n\r\n\treturn function(_startEvent, _delay, _clb) {\r\n\t\tstartEvent = getPointerEvent(_startEvent);\r\n\t\tdelay = _delay || (isMobile ? 200 : 0);\r\n\t\tclb = _clb;\r\n\r\n\t\tregisterEvents();\r\n\t};\r\n})();\r\n\r\nfunction onMouseDown(event) {\r\n\tconst e = getPointerEvent(event);\r\n\tif (!isDragging) {\r\n\t\tgrabbedElement = Utils.getParent(e.target, '.' + constants.wrapperClass);\r\n\t\tif (grabbedElement) {\r\n\t\t\tconst containerElement = Utils.getParent(grabbedElement, '.' + constants.containerClass);\r\n\t\t\tconst container = containers.filter(p => p.element === containerElement)[0];\r\n\t\t\tconst dragHandleSelector = container.getOptions().dragHandleSelector;\r\n\t\t\tconst nonDragAreaSelector = container.getOptions().nonDragAreaSelector;\r\n\r\n\t\t\tlet startDrag = true;\r\n\t\t\tif (dragHandleSelector && !Utils.getParent(e.target, dragHandleSelector)) {\r\n\t\t\t\tstartDrag = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (nonDragAreaSelector && Utils.getParent(e.target, nonDragAreaSelector)) {\r\n\t\t\t\tstartDrag = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (startDrag) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\thandleDragStartConditions(e, container.getOptions().dragBeginDelay, () => {\t\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\twindow.getSelection().empty();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t\taddMoveListeners();\r\n\t\t\t\t\taddReleaseListeners();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction onMouseUp() {\r\n\tremoveMoveListeners();\r\n\tremoveReleaseListeners();\r\n\tif (draggableInfo) {\r\n\t\thandleDropAnimation(() => {\r\n\t\t\tdocument.body.style.touchAction = null;\r\n\t\t\t(dragListeningContainers || []).forEach(p => {\r\n\t\t\t\tUtils.removeClass(p.element, constants.noUserSelectClass);\r\n\t\t\t\tp.handleDrop(draggableInfo);\r\n\t\t\t});\r\n\r\n\t\t\tdragListeningContainers = null;\r\n\t\t\tgrabbedElement = null;\r\n\t\t\tghostInfo = null;\r\n\t\t\tdraggableInfo = null;\r\n\t\t\tisDragging = false;\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction getPointerEvent(e) {\r\n\treturn e.touches ? e.touches[0] : e;\t\r\n}\r\n\r\nfunction onMouseMove(event) {\r\n\tevent.preventDefault();\r\n\tconst e = getPointerEvent(event);\r\n\tif (!draggableInfo) {\r\n\t\tisDragging = true;\r\n\t\tconst container = containers.filter(p => grabbedElement.parentElement === p.element)[0];\r\n\t\tdragListeningContainers = containers.filter(p => p.isDragRelevant(container));\r\n\t\tdragListeningContainers.forEach(p => Utils.addClass(p.element, constants.noUserSelectClass));\r\n\t\tdragListeningContainers.forEach(p => p.prepareDrag(p, dragListeningContainers));\r\n\r\n\t\t// first move after grabbing  draggable\r\n\t\tdraggableInfo = getDraggableInfo(grabbedElement);\r\n\t\tghostInfo = getGhostElement(grabbedElement, { x: e.clientX, y: e.clientY }, draggableInfo.container);\r\n\t\tdraggableInfo.position = {\r\n\t\t\tx: e.clientX + ghostInfo.centerDelta.x,\r\n\t\t\ty: e.clientY + ghostInfo.centerDelta.y\r\n\t\t};\r\n\r\n\t\tdocument.body.appendChild(ghostInfo.ghost);\r\n\t} else {\r\n\t\t// just update ghost position && draggableInfo position\r\n\t\tghostInfo.ghost.style.left = `${e.clientX + ghostInfo.positionDelta.left}px`;\r\n\t\tghostInfo.ghost.style.top = `${e.clientY + ghostInfo.positionDelta.top}px`;\r\n\t\tdraggableInfo.position.x = e.clientX + ghostInfo.centerDelta.x;\r\n\t\tdraggableInfo.position.y = e.clientY + ghostInfo.centerDelta.y;\r\n\t\tdraggableInfo.clientWidth = ghostInfo.clientWidth;\r\n\t\tdraggableInfo.clientHeight = ghostInfo.clientHeight;\r\n\t}\r\n\r\n\tdragListeningContainers.forEach(p => p.handleDrag(draggableInfo));\r\n}\r\n\r\nfunction Mediator() {\r\n\tlistenEvents();\r\n\treturn {\r\n\t\tregister: function(container) {\r\n\t\t\tcontainers.push(container);\r\n\t\t},\r\n\t\tunregister: function(container) {\r\n\t\t\tcontainers.splice(containers.indexOf(container), 1);\r\n\t\t}\r\n\t};\r\n}\r\n\r\naddStyleToHead();\r\n\r\nexport default Mediator();\r\n\r\n\r\n\r\n","import * as constants from './constants';\r\n\r\nconst css = {\r\n\t[`.${constants.containerClass}`]: {\r\n\t\t'position': 'relative',\r\n\t},\r\n\t[`.${constants.containerClass} *`]: {\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal`]: {\r\n\t\t'white-space': 'nowrap',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal .${constants.wrapperClass}`]: {\r\n\t\t'height': '100%',\r\n\t\t'display': 'inline-block'\r\n\t},\r\n\t[`.${constants.wrapperClass}`]: {\r\n\t\t'overflow': 'hidden'\r\n\t},\r\n\t[`.${constants.wrapperClass}.animated`]: {\r\n\t\t'transition': 'transform ease'\r\n\t},\r\n\t[`.${constants.ghostClass} *`]: {\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.ghostClass}.animated`]: {\r\n\t\t'transition': 'all ease-out'\r\n\t},\r\n\t[`.${constants.disbaleTouchActions} *`]: {\r\n\t\t'touch-actions': 'none',\r\n\t\t'-ms-touch-actions': 'none'\r\n\t}\r\n};\r\n\r\nfunction convertToCssString(css) {\r\n\treturn Object.entries(css).reduce((styleString, [propName, propValue]) => {\r\n\t\tif (typeof (propValue) === 'object') {\r\n\t\t\treturn `${styleString}${propName}{${convertToCssString(propValue)}}`;\r\n\t\t}\r\n\t\treturn `${styleString}${propName}:${propValue};`;\r\n\t}, '');\r\n}\r\n\r\nfunction addStyleToHead() {\t\r\n\tconst head = document.head || document.getElementsByTagName('head')[0];\r\n\tconst style = document.createElement('style');\r\n\tconst cssString = convertToCssString(css);\r\n\tstyle.type = 'text/css';\r\n\tif (style.styleSheet) {\r\n\t\tstyle.styleSheet.cssText = cssString;\r\n\t} else {\r\n\t\tstyle.appendChild(document.createTextNode(cssString));\r\n\t}\r\n\r\n\thead.appendChild(style);\r\n}\r\n\r\nexport {\r\n\taddStyleToHead\r\n};","export const getIntersection = (rect1, rect2) => {\r\n  return {\r\n    left: Math.max(rect1.left, rect2.left),\r\n    top: Math.max(rect1.top, rect2.top),\r\n    right: Math.min(rect1.right, rect2.right),\r\n    bottom: Math.min(rect1.bottom, rect2.bottom),\r\n  }\r\n}\r\n\r\nexport const getIntersectionOnAxis = (rect1, rect2, axis) => {\r\n  if (axis === 'x') {\r\n    return {\r\n      left: Math.max(rect1.left, rect2.left),\r\n      top: rect1.top,\r\n      right: Math.min(rect1.right, rect2.right),\r\n      bottom: rect1.bottom\r\n    }\r\n  } else {\r\n    return {\r\n      left: rect1.left,\r\n      top: Math.max(rect1.top, rect2.top),\r\n      right: rect1.right,\r\n      bottom: Math.min(rect1.bottom, rect2.bottom),\r\n    }\r\n  }\r\n}\r\n\r\nexport const getContainerRect = (element) => {\r\n  const _rect = element.getBoundingClientRect();\r\n  const rect = { \r\n    left: _rect.left,\r\n    right: _rect.right + 10,\r\n    top: _rect.top,\r\n    bottom: _rect.bottom\r\n  }\r\n  \r\n  if (hasBiggerChild(element, 'x') && !isScrollingOrHidden(element, 'x')) {\r\n    const width = rect.right - rect.left;\r\n    rect.right = rect.right + element.scrollWidth - width;\r\n  }\r\n\r\n  if (hasBiggerChild(element, 'y') && !isScrollingOrHidden(element, 'y')) {\r\n    const height = rect.bottom - rect.top;\r\n    rect.bottom = rect.bottom + element.scrollHeight - height;\r\n  }\r\n\r\n  return rect;\r\n}\r\n\r\nexport const isScrolling = (element, axis) => {\r\n  const style = window.getComputedStyle(element);\r\n  const overflow = style['overflow'];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general = overflow === 'auto' || overflow === 'scroll';\r\n  const dimensionScroll = overFlowAxis === 'auto' || overFlowAxis === 'scroll';\r\n  return general || dimensionScroll;\r\n}\r\n\r\nexport const isScrollingOrHidden = (element, axis) => {\r\n  const style = window.getComputedStyle(element);\r\n  const overflow = style['overflow'];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general = overflow === 'auto' || overflow === 'scroll' || overflow === 'hidden';\r\n  const dimensionScroll = overFlowAxis === 'auto' || overFlowAxis === 'scroll' || overFlowAxis === 'hidden';\r\n  return general || dimensionScroll;\r\n}\r\n\r\nexport const hasBiggerChild = (element, axis) => {\r\n  if (axis === 'x') {\r\n    return element.scrollWidth > element.clientWidth\r\n  } else {\r\n    return element.scrollHeight > element.clientHeight;\r\n  }\r\n}\r\n\r\nexport const hasScrollBar = (element, axis) => {\r\n  return hasBiggerChild(element, axis) && isScrolling(element, axis);\r\n}\r\n\r\nexport const getVisibleRect = (element, elementRect) => {\r\n  let currentElement = element;\r\n  let rect = elementRect || getContainerRect(element);\r\n  currentElement = element.parentElement;\r\n  while (currentElement) {\r\n    if (hasBiggerChild(currentElement, 'x') && isScrollingOrHidden(currentElement, 'x')) {\r\n      rect = getIntersectionOnAxis(rect, currentElement.getBoundingClientRect(), 'x');\r\n    }\r\n\r\n    if (hasBiggerChild(currentElement, 'y') && isScrollingOrHidden(currentElement, 'y')) {\r\n      rect = getIntersectionOnAxis(rect, currentElement.getBoundingClientRect(), 'y');\r\n    }\r\n\r\n    currentElement = currentElement.parentElement;\r\n  }\r\n\r\n  return rect;\r\n}\r\n\r\nexport const listenScrollParent = (element, clb) => {\r\n  let scrollers = [];\r\n  const dispose = () => {\r\n    scrollers.forEach(p => {\r\n      p.removeEventListener('scroll', clb);\r\n    });\r\n    window.removeEventListener('scroll', clb);\r\n  }\r\n\r\n  setTimeout(function() {\r\n    let currentElement = element;\r\n    while (currentElement) {\r\n      if (isScrolling(currentElement, 'x') || isScrolling(currentElement, 'y')) {\r\n        currentElement.addEventListener('scroll', clb);\r\n        scrollers.push(currentElement);\r\n      }\r\n      currentElement = currentElement.parentElement;\r\n    }\r\n\r\n    window.addEventListener('scroll', clb);\r\n  }, 10);\r\n\r\n  return {\r\n    dispose\r\n  }\r\n}\r\n\r\nexport const hasParent = (element, parent) => {\r\n  let current = element;\r\n  while (current) {\r\n    if (current === parent) {\r\n      return true;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport const getParent = (element, selector) => {\r\n  let current = element;\r\n  while (current) {\r\n    if (current.matches(selector)) {\r\n      return current;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport const hasClass = (element, cls) => {\r\n  return element.className.split(' ').map(p => p).indexOf(cls) > -1;\r\n}\r\n\r\nexport const addClass = (element, cls) => {\r\n  const classes = element.className.split(' ').filter(p => p);\r\n  if (classes.indexOf(cls) === -1) {\r\n    classes.push(cls);\r\n    element.className = classes.join(' ');\r\n  }\r\n}\r\n\r\nexport const removeClass = (element, cls) => {\r\n  const classes = element.className.split(' ').filter(p => p && p !== cls);\r\n  element.className = classes.join(' ');\r\n}\r\n\r\nexport const debounce = (fn, delay, immediate) => {\r\n  let timer = null;\r\n  return (...params) => {\r\n    if (timer) {\r\n      clearTimeout(timer);\r\n    }\r\n    if (immediate && !timer) {\r\n      fn.call(this, ...params);\r\n    } else {\r\n      timer = setTimeout(() => {\r\n        timer = null;\r\n        fn.call(this, ...params);\r\n      }, delay);\r\n    }\r\n  }\r\n}\r\n\r\nexport const removeChildAt = (parent, index) => {\r\n  return parent.removeChild(parent.children[index]);\r\n}\r\n\r\nexport const addChildAt = (parent, child, index) => {\r\n  if (index >= parent.children.lenght) {\r\n    parent.appendChild(child);\r\n  } else {\r\n    parent.insertBefore(child, parent.children[index]);\r\n  }\r\n}\r\n\r\nexport const isMobile = () => {\r\n  if (navigator.userAgent.match(/Android/i)\r\n    || navigator.userAgent.match(/webOS/i)\r\n    || navigator.userAgent.match(/iPhone/i)\r\n    || navigator.userAgent.match(/iPad/i)\r\n    || navigator.userAgent.match(/iPod/i)\r\n    || navigator.userAgent.match(/BlackBerry/i)\r\n    || navigator.userAgent.match(/Windows Phone/i)\r\n  ) {\r\n    return true;\r\n  }\r\n  else {\r\n    return false;\r\n  }\r\n}"],"sourceRoot":""}